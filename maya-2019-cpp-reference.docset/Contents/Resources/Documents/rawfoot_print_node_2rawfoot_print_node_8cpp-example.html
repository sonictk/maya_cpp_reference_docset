<!-- saved from url=(0024)http://docs.autodesk.com -->
<html>
<head><script src="../scripts/yepnope.1.5.4-min.js" type="text/javascript"></script><script src="../scripts/lib/jquery-1.11.1.min.js" type="text/javascript"></script><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><script src="../scripts/utils/adsk.redirect.js" type="text/javascript"></script>
<title>rawfootPrintNode/rawfootPrintNode.cpp</title>
<meta content="C++" name="topic-subtype"/></head>
<body height="100%"><div class="body_content" id="body-content"><link href="cpp_ref/navtree.css" rel="stylesheet" type="text/css"/><link href="cpp_ref/doxygen.css" rel="stylesheet" type="text/css"/><link href="cpp_ref/tabs.css" rel="stylesheet" type="text/css"/><link href="style/adsk.cpm.css" rel="stylesheet" type="text/css"/><script type="text/javascript">
var tocSystemNeedsToBeLoaded = typeof(cpp_ref_adsk_ref_toc) == 'undefined';
var weAreIn21 = $('div#main.view-active').length;
var tocPrefix = '';
if (weAreIn21)
{ tocPrefix = 'cpp_ref/'; }
function cpp_ref_initializeToc(forceTrigger) {
    cpp_ref_adsk_ref_toc.initResizable();
    cpp_ref_adsk_ref_toc.initNavTree('rawfoot_print_node_2rawfoot_print_node_8cpp-example.html', tocPrefix);
    dQuery(document).trigger('toc_initialized');
}
if (tocSystemNeedsToBeLoaded)
{
	yepnope([{
	load:[tocPrefix + 'json3.min.js', tocPrefix + 'jquery.js', tocPrefix + 'ref-toc-controller.js', tocPrefix + 'dynsections.js'],
	complete: function() {
	  if (typeof(dQuery) == 'undefined')
	  {
	    dQuery = jQuery.noConflict(true);
	  }
	  else { jQuery.noConflict(true); }
	  $(document).ready(cpp_ref_initializeToc);
	}
 	}])
}
if (!weAreIn21) { // if in AKN...
$(window).load( function() {
    setTimeout( function() {
        var content = $('body > div').not('#body-content');     // take any divs under body that are not id=body-content
        content.each( function() { 
            $(this).css( { 'padding-left': $(this).css('margin-left') } );       // and if they have any padding-left already, move it to margin-left.
        } );
        var width = cpp_ref_adsk_ref_toc.readFromStorage('width');
        content.css({marginLeft:parseInt(width)+6+"px"});
    }, 100);
} ); 
}
</script><script>$("div#WidgetFloaterPanels,link[href*='microsofttranslator.com'],script[src*='microsofttranslator.com'],script[src*='bing.com']").remove();</script><script type="text/javascript">$("div#navigation,div#breadcrumbs,div#banner").attr("translate","no"); var mtLocation = ((location && location.href && location.href.indexOf('https') == 0)?'https://ssl.microsofttranslator.com':'http://www.microsofttranslator.com')+'/ajax/v3/WidgetV3.ashx?ctf=True&ui=true&settings=Manual&from=en&hidelanguages='; yepnope.injectJs(mtLocation, function() {}, { charset:'utf-8', type:'text/javascript' } );</script><script>
 if (!tocSystemNeedsToBeLoaded) { cpp_ref_initializeToc(); }
 </script><!-- begin MT -->
<div class="Dark" id="MicrosoftTranslatorWidget" style="float:right;z-index:100;color:white;background-color:#bbbbbb;height:58px;overflow:hidden"></div>
<div>
<div class="head">
<h1>rawfootPrintNode/rawfootPrintNode.cpp</h1>
</div>
<div id="top"><!-- Generated by Doxygen 1.8.10 -->
<div class="tabs" id="navrow1">
<ul class="tablist">
<li><a href="./index.html"><span>MainÂ Page</span></a></li>
<li><a href="./pages.html"><span>Topics</span></a></li>
<li><a href="./modules.html"><span>Modules</span></a></li>
<li><a href="./namespaces.html"><span>Namespaces</span></a></li>
<li><a href="./annotated.html"><span>Classes</span></a></li>
<li><a href="./files.html"><span>Files</span></a></li>
<li><a href="./examples.html"><span>Examples</span></a></li>
</ul>
</div>
</div><!-- top -->
<div class="ui-resizable side-nav-resizable" id="side-nav">
<div id="nav-tree">
<div id="nav-tree-contents">
<div class="sync" id="nav-sync"></div>
</div>
</div>
<div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;">
</div>
</div>
<div id="doc-content">
<div class="header">
<div class="headertitle">
<div class="title">rawfootPrintNode/rawfootPrintNode.cpp</div> </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">//-</span></div>
<div class="line"><span class="comment">// ==========================================================================</span></div>
<div class="line"><span class="comment">// Copyright 2018 Autodesk, Inc.  All rights reserved.</span></div>
<div class="line"><span class="comment">// Use of this software is subject to the terms of the Autodesk license agreement</span></div>
<div class="line"><span class="comment">// provided at the time of installation or download, or which otherwise</span></div>
<div class="line"><span class="comment">// accompanies this software in either electronic or hard copy form.</span></div>
<div class="line"><span class="comment">// ==========================================================================</span></div>
<div class="line"><span class="comment">//+</span></div>
<div class="line"><span class="preprocessor">#if _MSC_VER &gt;= 1700</span></div>
<div class="line"><span class="preprocessor">#pragma warning( disable: 4005 )</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MPxLocatorNode.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MString.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MDagPath.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MTypeId.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MPlug.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MVector.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MDataBlock.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MDataHandle.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MColor.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/M3dView.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MFnPlugin.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MDistance.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MMatrix.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MFnUnitAttribute.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MFnNumericAttribute.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MFileObject.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MHWGeometry.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MEventMessage.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MEvaluationNode.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MPointArray.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Viewport 2.0 includes</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MDrawRegistry.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MPxDrawOverride.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MUserData.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MDrawContext.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MSelectionContext.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MGlobal.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MSelectionList.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MViewport2Renderer.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MHWGeometryUtilities.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MStateManager.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MShaderManager.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MRenderTargetManager.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MAnimControl.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MFnCamera.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// DX stuff</span></div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define WIN32_LEAN_AND_MEAN</span></div>
<div class="line"><span class="preprocessor">#include &lt;d3d11.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if _MSC_VER &lt; 1700</span></div>
<div class="line"><span class="preprocessor">    #include &lt;d3dx11.h&gt;</span></div>
<div class="line"><span class="preprocessor">    #include &lt;xnamath.h&gt;</span></div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor">    #include &lt;dxgi.h&gt;</span></div>
<div class="line"><span class="preprocessor">    #include &lt;DirectXMath.h&gt;</span></div>
<div class="line"> </div>
<div class="line"> <span class="keyword">using namespace </span>DirectX;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;d3dcompiler.h&gt;</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef D3DCOMPILE_ENABLE_STRICTNESS</span></div>
<div class="line"><span class="preprocessor">    #define D3DCOMPILE_ENABLE_STRICTNESS D3D10_SHADER_ENABLE_STRICTNESS</span></div>
<div class="line"><span class="preprocessor">    #define D3DCOMPILE_DEBUG D3D10_SHADER_DEBUG</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#endif //_WIN32</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if defined (OSMac_)</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define GL_DO_NOT_WARN_IF_MULTI_GL_VERSION_HEADERS_INCLUDED</span></div>
<div class="line"><span class="preprocessor">#include &lt;OpenGL/gl3.h&gt;</span> <span class="comment">// For gl*VertexArray(s) and APIENTRY</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#endif // OSMac_</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Foot Data</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">float</span> sole[][3] = { {  0.00f, 0.0f, -0.70f },</div>
<div class="line">                           {  0.04f, 0.0f, -0.69f },</div>
<div class="line">                           {  0.09f, 0.0f, -0.65f },</div>
<div class="line">                           {  0.13f, 0.0f, -0.61f },</div>
<div class="line">                           {  0.16f, 0.0f, -0.54f },</div>
<div class="line">                           {  0.17f, 0.0f, -0.46f },</div>
<div class="line">                           {  0.17f, 0.0f, -0.35f },</div>
<div class="line">                           {  0.16f, 0.0f, -0.25f },</div>
<div class="line">                           {  0.15f, 0.0f, -0.14f },</div>
<div class="line">                           {  0.13f, 0.0f,  0.00f },</div>
<div class="line">                           {  0.00f, 0.0f,  0.00f },</div>
<div class="line">                           { -0.13f, 0.0f,  0.00f },</div>
<div class="line">                           { -0.15f, 0.0f, -0.14f },</div>
<div class="line">                           { -0.16f, 0.0f, -0.25f },</div>
<div class="line">                           { -0.17f, 0.0f, -0.35f },</div>
<div class="line">                           { -0.17f, 0.0f, -0.46f },</div>
<div class="line">                           { -0.16f, 0.0f, -0.54f },</div>
<div class="line">                           { -0.13f, 0.0f, -0.61f },</div>
<div class="line">                           { -0.09f, 0.0f, -0.65f },</div>
<div class="line">                           { -0.04f, 0.0f, -0.69f },</div>
<div class="line">                           { -0.00f, 0.0f, -0.70f } };</div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">float</span> soleNorm[][3] = { {  0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f },</div>
<div class="line">                           { 0.00f, 1.0f, 0.00f } };</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">float</span> heel[][3] = { {  0.00f, 0.0f,  0.06f },</div>
<div class="line">                           {  0.13f, 0.0f,  0.06f },</div>
<div class="line">                           {  0.14f, 0.0f,  0.15f },</div>
<div class="line">                           {  0.14f, 0.0f,  0.21f },</div>
<div class="line">                           {  0.13f, 0.0f,  0.25f },</div>
<div class="line">                           {  0.11f, 0.0f,  0.28f },</div>
<div class="line">                           {  0.09f, 0.0f,  0.29f },</div>
<div class="line">                           {  0.04f, 0.0f,  0.30f },</div>
<div class="line">                           {  0.00f, 0.0f,  0.30f },</div>
<div class="line">                           { -0.04f, 0.0f,  0.30f },</div>
<div class="line">                           { -0.09f, 0.0f,  0.29f },</div>
<div class="line">                           { -0.11f, 0.0f,  0.28f },</div>
<div class="line">                           { -0.13f, 0.0f,  0.25f },</div>
<div class="line">                           { -0.14f, 0.0f,  0.21f },</div>
<div class="line">                           { -0.14f, 0.0f,  0.15f },</div>
<div class="line">                           { -0.13f, 0.0f,  0.06f },</div>
<div class="line">                           { -0.00f, 0.0f,  0.06f } };</div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">float</span> heelNorm[][3] = { {  0.00f, 1.0f,  0.00f },</div>
<div class="line">                           {  0.00f, 1.0f,  0.00f },</div>
<div class="line">                           {  0.00f, 1.0f,  0.00f },</div>
<div class="line">                           {  0.00f, 1.0f,  0.00f },</div>
<div class="line">                           {  0.00f, 1.0f,  0.00f },</div>
<div class="line">                           {  0.00f, 1.0f,  0.00f },</div>
<div class="line">                           {  0.00f, 1.0f,  0.00f },</div>
<div class="line">                           {  0.00f, 1.0f,  0.00f },</div>
<div class="line">                           {  0.00f, 1.0f,  0.00f },</div>
<div class="line">                           {  0.00f, 1.0f,  0.00f },</div>
<div class="line">                           {  0.00f, 1.0f,  0.00f },</div>
<div class="line">                           {  0.00f, 1.0f,  0.00f },</div>
<div class="line">                           {  0.00f, 1.0f,  0.00f },</div>
<div class="line">                           {  0.00f, 1.0f,  0.00f },</div>
<div class="line">                           {  0.00f, 1.0f,  0.00f },</div>
<div class="line">                           {  0.00f, 1.0f,  0.00f },</div>
<div class="line">                           {  0.00f, 1.0f,  0.00f } };</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> soleCount = 21;</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> heelCount = 17;</div>
<div class="line"></div>
<div class="line"><span class="comment">// Index buffer data for drawing in Dx and Core Profile modes:</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> soleWireIndices[] =</div>
<div class="line">        {</div>
<div class="line">            0, 1,</div>
<div class="line">            1, 2,</div>
<div class="line">            2, 3,</div>
<div class="line">            3, 4,</div>
<div class="line">            4, 5,</div>
<div class="line">            5, 6,</div>
<div class="line">            6, 7,</div>
<div class="line">            7, 8,</div>
<div class="line">            8, 9,</div>
<div class="line">            9, 10,</div>
<div class="line">            10, 11,</div>
<div class="line">            11, 12,</div>
<div class="line">            12, 13,</div>
<div class="line">            13, 14,</div>
<div class="line">            14, 15,</div>
<div class="line">            15, 16,</div>
<div class="line">            16, 17,</div>
<div class="line">            17, 18,</div>
<div class="line">            18, 19,</div>
<div class="line">            19, 20</div>
<div class="line">        };</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> heelWireIndices[] =</div>
<div class="line">        {</div>
<div class="line">            0, 1,</div>
<div class="line">            1, 2,</div>
<div class="line">            2, 3,</div>
<div class="line">            3, 4,</div>
<div class="line">            4, 5,</div>
<div class="line">            5, 6,</div>
<div class="line">            6, 7,</div>
<div class="line">            7, 8,</div>
<div class="line">            8, 9,</div>
<div class="line">            9, 10,</div>
<div class="line">            10, 11,</div>
<div class="line">            11, 12,</div>
<div class="line">            12, 13,</div>
<div class="line">            13, 14,</div>
<div class="line">            14, 15,</div>
<div class="line">            15, 16</div>
<div class="line">        };</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> soleShadedIndices[] =</div>
<div class="line">        {</div>
<div class="line">            0, 1, 2,</div>
<div class="line">            0, 2, 3,</div>
<div class="line">            0, 3, 4,</div>
<div class="line">            0, 4, 5,</div>
<div class="line">            0, 5, 6,</div>
<div class="line">            0, 6, 7,</div>
<div class="line">            0, 7, 8,</div>
<div class="line">            0, 8, 9,</div>
<div class="line">            0, 9, 10,</div>
<div class="line">            0, 10, 11,</div>
<div class="line">            0, 11, 12,</div>
<div class="line">            0, 12, 13,</div>
<div class="line">            0, 13, 14,</div>
<div class="line">            0, 14, 15,</div>
<div class="line">            0, 15, 16,</div>
<div class="line">            0, 16, 17,</div>
<div class="line">            0, 17, 18,</div>
<div class="line">            0, 18, 19,</div>
<div class="line">            0, 19, 20</div>
<div class="line">        };</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> heelShadedIndices[] =</div>
<div class="line">        {</div>
<div class="line">            0, 1, 2,</div>
<div class="line">            0, 2, 3,</div>
<div class="line">            0, 3, 4,</div>
<div class="line">            0, 4, 5,</div>
<div class="line">            0, 5, 6,</div>
<div class="line">            0, 6, 7,</div>
<div class="line">            0, 7, 8,</div>
<div class="line">            0, 8, 9,</div>
<div class="line">            0, 9, 10,</div>
<div class="line">            0, 10, 11,</div>
<div class="line">            0, 11, 12,</div>
<div class="line">            0, 12, 13,</div>
<div class="line">            0, 13, 14,</div>
<div class="line">            0, 14, 15,</div>
<div class="line">            0, 15, 16</div>
<div class="line">        };</div>
<div class="line"></div>
<div class="line"><span class="comment">// 8 Vertices for drawing the bounding box in DX and Core Profile mode</span></div>
<div class="line"><span class="comment">// lower and upper values of the sole and heel vertices +/- 0.1</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">float</span> bbData[][3] = {</div>
<div class="line">        { -0.18f, 0.f, -0.71f},</div>
<div class="line">        {  0.18f, 0.f, -0.71f},</div>
<div class="line">        {  0.18f, 0.f,  0.31f},</div>
<div class="line">        { -0.18f, 0.f,  0.31f},</div>
<div class="line">        { -0.18f, 0.f, -0.71f},</div>
<div class="line">        {  0.18f, 0.f, -0.71f},</div>
<div class="line">        {  0.18f, 0.f,  0.31f},</div>
<div class="line">        { -0.18f, 0.f,  0.31f}};</div>
<div class="line"></div>
<div class="line"><span class="comment">// Index buffer for Wireframe drawing in Dx and Core Profile</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> bbWireIndices[] =</div>
<div class="line">        {</div>
<div class="line">            0,1,</div>
<div class="line">            1,2,</div>
<div class="line">            2,3,</div>
<div class="line">            3,0,</div>
<div class="line">            4,5,</div>
<div class="line">            5,6,</div>
<div class="line">            6,7,</div>
<div class="line">            7,4,</div>
<div class="line">            0,4,</div>
<div class="line">            1,5,</div>
<div class="line">            2,6,</div>
<div class="line">            3,7</div>
<div class="line">        };</div>
<div class="line"></div>
<div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Node implementation with standard viewport draw</span></div>
<div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span>rawfootPrint : <span class="keyword">public</span> <a name="_a0"></a><a class="code" href="./class_m_px_locator_node.html">MPxLocatorNode</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    rawfootPrint();</div>
<div class="line">    ~rawfootPrint() <span class="keyword">override</span>;</div>
<div class="line"></div>
<div class="line"> <a name="_a1"></a><a class="code" href="./class_m_status.html">MStatus</a>         compute( <span class="keyword">const</span> <a name="_a2"></a><a class="code" href="./class_m_plug.html">MPlug</a>&amp; plug, <a name="_a3"></a><a class="code" href="./class_m_data_block.html">MDataBlock</a>&amp; data ) <span class="keyword">override</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">bool</span>            isBounded() <span class="keyword">const override</span>;</div>
<div class="line"> <a name="_a4"></a><a class="code" href="./class_m_bounding_box.html">MBoundingBox</a>    boundingBox() <span class="keyword">const override</span>;</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> preEvaluation(<span class="keyword">const</span> <a name="_a5"></a><a class="code" href="./class_m_d_g_context.html">MDGContext</a>&amp; context, <span class="keyword">const</span> <a name="_a6"></a><a class="code" href="./class_m_evaluation_node.html">MEvaluationNode</a>&amp; evaluationNode) <span class="keyword">override</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">static</span> <span class="keywordtype">void</span> *          creator();</div>
<div class="line"> <span class="keyword">static</span> <a class="code" href="./class_m_status.html">MStatus</a>         initialize();</div>
<div class="line"></div>
<div class="line"> <span class="keyword">static</span> <a name="_a7"></a><a class="code" href="./class_m_object.html">MObject</a>         size;               <span class="comment">// The size of the foot</span></div>
<div class="line"> <span class="keyword">static</span> <a class="code" href="./class_m_object.html">MObject</a>         transparencySort;   <span class="comment">// The transparent status of the foot</span></div>
<div class="line"> <span class="keyword">static</span> <a class="code" href="./class_m_object.html">MObject</a>         transparency;       <span class="comment">// The transparent value of the foot</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"> <span class="keyword">static</span> <a name="_a8"></a><a class="code" href="./class_m_type_id.html">MTypeId</a>     id;</div>
<div class="line"> <span class="keyword">static</span> <a name="_a9"></a><a class="code" href="./class_m_string.html">MString</a>     drawDbClassification;</div>
<div class="line"> <span class="keyword">static</span> <a class="code" href="./class_m_string.html">MString</a>     drawRegistrantId;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><a class="code" href="./class_m_object.html">MObject</a> rawfootPrint::size;</div>
<div class="line"><a class="code" href="./class_m_object.html">MObject</a> rawfootPrint::transparencySort;</div>
<div class="line"><a class="code" href="./class_m_object.html">MObject</a> rawfootPrint::transparency;</div>
<div class="line"><a class="code" href="./class_m_type_id.html">MTypeId</a> rawfootPrint::id( 0x0008002D );</div>
<div class="line"><a class="code" href="./class_m_string.html">MString</a> rawfootPrint::drawDbClassification(<span class="stringliteral">"drawdb/geometry/rawfootPrint"</span>);</div>
<div class="line"><a class="code" href="./class_m_string.html">MString</a> rawfootPrint::drawRegistrantId(<span class="stringliteral">"RawFootprintNodePlugin"</span>);</div>
<div class="line"></div>
<div class="line">rawfootPrint::rawfootPrint() {}</div>
<div class="line">rawfootPrint::~rawfootPrint() {}</div>
<div class="line"></div>
<div class="line"><a class="code" href="./class_m_status.html">MStatus</a> rawfootPrint::compute( <span class="keyword">const</span> <a class="code" href="./class_m_plug.html">MPlug</a>&amp; <span class="comment">/*plug*/</span>, <a class="code" href="./class_m_data_block.html">MDataBlock</a>&amp; <span class="comment">/*data*/</span> )</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">return</span> MS::kUnknownParameter;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> rawfootPrint::isBounded()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="./class_m_bounding_box.html">MBoundingBox</a> rawfootPrint::boundingBox()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line"> <span class="comment">// Get the size</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <a class="code" href="./class_m_object.html">MObject</a> thisNode = thisMObject();</div>
<div class="line"> <a class="code" href="./class_m_plug.html">MPlug</a> plug( thisNode, size );</div>
<div class="line"> <a name="_a10"></a><a class="code" href="./class_m_distance.html">MDistance</a> sizeVal;</div>
<div class="line">    plug.getValue( sizeVal );</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">double</span> multiplier = sizeVal.<a name="a11"></a><a class="code" href="./class_m_distance.html#ace39ab92685b0f5ab1a2925e748efb1f">asCentimeters</a>();</div>
<div class="line"></div>
<div class="line"> <a name="_a12"></a><a class="code" href="./class_m_point.html">MPoint</a> corner1( -0.17, 0.0, -0.7 );</div>
<div class="line"> <a class="code" href="./class_m_point.html">MPoint</a> corner2( 0.17, 0.0, 0.3 );</div>
<div class="line"></div>
<div class="line">    corner1 = corner1 * multiplier;</div>
<div class="line">    corner2 = corner2 * multiplier;</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> <a class="code" href="./class_m_bounding_box.html">MBoundingBox</a>( corner1, corner2 );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Called before this node is evaluated by Evaluation Manager</span></div>
<div class="line"><a class="code" href="./class_m_status.html">MStatus</a> rawfootPrint::preEvaluation(</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_d_g_context.html">MDGContext</a>&amp; context,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_evaluation_node.html">MEvaluationNode</a>&amp; evaluationNode)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">if</span> (context.<a name="a13"></a><a class="code" href="./class_m_d_g_context.html#a761a03ae58bbf2942f90578a0e61ada7">isNormal</a>())</div>
<div class="line">    {</div>
<div class="line"> <span class="comment">// The size attribute is set to affect the localScale attribute during</span></div>
<div class="line"> <span class="comment">// initialization, thus no need to be checked here to trigger geometry</span></div>
<div class="line"> <span class="comment">// change.</span></div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> status;</div>
<div class="line"> <span class="keywordflow">if</span> ((evaluationNode.<a name="a14"></a><a class="code" href="./class_m_evaluation_node.html#abc632b073f3b3abeb4ca052f20573dd6">dirtyPlugExists</a>(transparencySort, &amp;status) &amp;&amp; status) ||</div>
<div class="line">            (evaluationNode.<a class="code" href="./class_m_evaluation_node.html#abc632b073f3b3abeb4ca052f20573dd6">dirtyPlugExists</a>(transparency, &amp;status) &amp;&amp; status))</div>
<div class="line">        {</div>
<div class="line"> <a name="a15"></a><a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#ab2843a350b76cdcbf16dd70d884f9766">MHWRender::MRenderer::setGeometryDrawDirty</a>(thisMObject());</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> <a name="a16"></a><a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MStatus::kSuccess</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span>* rawfootPrint::creator()</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">new</span> rawfootPrint();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Viewport 2.0 override implementation</span></div>
<div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span>RawFootPrintData : <span class="keyword">public</span> <a name="_a17"></a><a class="code" href="./class_m_user_data.html">MUserData</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    RawFootPrintData() : <a class="code" href="./class_m_user_data.html">MUserData</a>(false) </div>
<div class="line">    , mBlendState(NULL)</div>
<div class="line">    {</div>
<div class="line">        mLastFrameStamp = 0;</div>
<div class="line">    } <span class="comment">// don't delete after draw</span></div>
<div class="line">    ~RawFootPrintData()<span class="keyword"> override </span>{ mBlendState = NULL; }</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">float</span> fMultiplier;</div>
<div class="line"> <span class="keywordtype">float</span> fColor[4];</div>
<div class="line"> <span class="keywordtype">bool</span>  fCustomBoxDraw;</div>
<div class="line"> <a class="code" href="./class_m_bounding_box.html">MBoundingBox</a> fCurrentBoundingBox;</div>
<div class="line"> <a name="_a18"></a><a class="code" href="./class_m_d_a_g_draw_override_info.html">MDAGDrawOverrideInfo</a> fDrawOV;</div>
<div class="line"> <span class="keyword">const</span> <a name="_a19"></a><a class="code" href="./class_m_h_w_render_1_1_m_blend_state.html">MHWRender::MBlendState</a>* mBlendState;</div>
<div class="line">    MUint64 mLastFrameStamp;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">// Helper class declaration for the object drawing</span></div>
<div class="line"><span class="keyword">class </span>RawFootPrintDrawAgent</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    RawFootPrintDrawAgent() : mDrawContext(NULL), mShaderOverride(NULL) {}</div>
<div class="line"> <span class="keyword">virtual</span> ~RawFootPrintDrawAgent(){}</div>
<div class="line"></div>
<div class="line"> <span class="keyword">virtual</span> <span class="keywordtype">void</span> drawShaded() = 0;</div>
<div class="line"> <span class="keyword">virtual</span> <span class="keywordtype">void</span> drawBoundingBox() = 0;</div>
<div class="line"> <span class="keyword">virtual</span> <span class="keywordtype">void</span> drawWireframe() = 0;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">virtual</span> <span class="keywordtype">void</span> setMatrix(</div>
<div class="line"> <span class="keyword">const</span> <a name="_a20"></a><a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context,</div>
<div class="line"> <span class="keyword">const</span> <a name="_a21"></a><a class="code" href="./class_m_h_w_render_1_1_m_selection_info.html">MHWRender::MSelectionInfo</a>* selectInfo) = 0;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">virtual</span> <span class="keywordtype">void</span> beginDraw( <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context, <a name="_a22"></a><a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html">MHWRender::MShaderInstance</a>* passShaderOverride ) {</div>
<div class="line">        mDrawContext = &amp;context;</div>
<div class="line">        mShaderOverride = passShaderOverride;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Sample code to debug geometry streams required for the override</span></div>
<div class="line"> <span class="comment">// shader.</span></div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">bool</span> debugShader = <span class="keyword">false</span>;</div>
<div class="line"> <a name="_a23"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer_descriptor_list.html">MHWRender::MVertexBufferDescriptorList</a> bufferList;</div>
<div class="line"> <span class="keywordflow">if</span> (mShaderOverride) </div>
<div class="line">        {</div>
<div class="line"> <span class="keywordflow">if</span> (debugShader)</div>
<div class="line">            {</div>
<div class="line">                mShaderOverride-&gt;requiredVertexBuffers(bufferList);</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;bufferList.<a name="a24"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer_descriptor_list.html#a57b988236ee6a3a5e572d126d3fbccc1">length</a>(); i++)</div>
<div class="line">                {</div>
<div class="line"> <a name="_a25"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer_descriptor.html">MHWRender::MVertexBufferDescriptor</a> desc;</div>
<div class="line">                    bufferList.<a name="a26"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer_descriptor_list.html#ab5970217cd80acac6aa900cc1daec6b8">getDescriptor</a>( i, desc );</div>
<div class="line">                    printf(<span class="stringliteral">"Buffer[%d][name=%s]\n"</span>, i,</div>
<div class="line">                        desc.<a name="a27"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer_descriptor.html#aca2cba4630391c78dcf1a828986160da">name</a>().<a name="a28"></a><a class="code" href="./class_m_string.html#aa9ab612f356c53479afc4c648c9ef94d">asChar</a>());</div>
<div class="line">                    printf(<span class="stringliteral">"[semantic = %s\n"</span>, desc.<a name="a29"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer_descriptor.html#aec39ee3496166457d1ccdf73c8d1a3b2">semanticName</a>().<a class="code" href="./class_m_string.html#aa9ab612f356c53479afc4c648c9ef94d">asChar</a>());</div>
<div class="line">                    printf(<span class="stringliteral">"[dataType = %d\n"</span>, desc.<a name="a30"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer_descriptor.html#abc7588a483f61d3d4a1e8204ca14d6f6">dataType</a>());</div>
<div class="line">                    printf(<span class="stringliteral">"[dataTyleSize = %d\n"</span>, desc.<a name="a31"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer_descriptor.html#a064b0aed53f7aa48d27145b41f9590aa">dataTypeSize</a>());</div>
<div class="line">                    printf(<span class="stringliteral">"[dimension = %d\n"</span>, desc.<a name="a32"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer_descriptor.html#ae5acbe47d704ceb866e3717e2ac9422f">dimension</a>());</div>
<div class="line">                    printf(<span class="stringliteral">"[offset = %d\n"</span>, desc.<a name="a33"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer_descriptor.html#aaa02ea556dee3025f49406b9d3fb662c">offset</a>());</div>
<div class="line">                    printf(<span class="stringliteral">"[stride = %d\n"</span>, desc.<a name="a34"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer_descriptor.html#a2f0529f7f5ff03b8a26e3a3d1925bb2b">stride</a>());</div>
<div class="line">                }</div>
<div class="line">            }           </div>
<div class="line"></div>
<div class="line">            mShaderOverride-&gt;bind( *mDrawContext );</div>
<div class="line">            mShaderOverride-&gt;updateParameters( *mDrawContext );</div>
<div class="line">            mShaderOverride-&gt;activatePass( *mDrawContext, 0 );</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keyword">virtual</span> <span class="keywordtype">void</span> endDraw() {</div>
<div class="line"> <span class="keywordflow">if</span> (mShaderOverride) {</div>
<div class="line">            mShaderOverride-&gt;unbind( *mDrawContext );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        mDrawContext = NULL;</div>
<div class="line">        mShaderOverride = NULL;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">void</span> setColor( <span class="keyword">const</span> <a name="_a35"></a><a class="code" href="./class_m_color.html">MColor</a>&amp; color){</div>
<div class="line">        mColor = color;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>* mDrawContext;</div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html">MHWRender::MShaderInstance</a>* mShaderOverride;</div>
<div class="line"> <a class="code" href="./class_m_color.html">MColor</a>  mColor;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">// GL draw agent declaration</span></div>
<div class="line"><span class="keyword">class </span>RawFootPrintDrawAgentGL : <span class="keyword">public</span> RawFootPrintDrawAgent</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"> <span class="keyword">static</span> RawFootPrintDrawAgentGL&amp; getDrawAgent(){</div>
<div class="line"> <span class="keyword">static</span> RawFootPrintDrawAgentGL obj;</div>
<div class="line"> <span class="keywordflow">return</span> obj;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">void</span> drawShaded() <span class="keyword">override</span>;</div>
<div class="line"> <span class="keywordtype">void</span> drawBoundingBox() <span class="keyword">override</span>;</div>
<div class="line"> <span class="keywordtype">void</span> drawWireframe() <span class="keyword">override</span>;</div>
<div class="line"> <span class="keywordtype">void</span> beginDraw( <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context, <a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html">MHWRender::MShaderInstance</a>* passShaderOverride ) <span class="keyword">override</span>;</div>
<div class="line"> <span class="keywordtype">void</span> endDraw() <span class="keyword">override</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">void</span> setMatrix(</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_selection_info.html">MHWRender::MSelectionInfo</a>* selectInfo)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line"> <span class="comment">// Get  world view matrix</span></div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> status;</div>
<div class="line">        mWorldViewMatrix =</div>
<div class="line">            context.<a name="a36"></a><a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#a71cbe2a3f2dfa967ebc43b5e97456ccb">getMatrix</a>(<a name="a37"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#acc6ad8472c2abfd2f63e100474b977f9aada60cca33133e088ad8ee1bce291878">MHWRender::MFrameContext::kWorldViewMtx</a>, &amp;status);</div>
<div class="line"> <span class="keywordflow">if</span> (status != <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MStatus::kSuccess</a>) <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Get projection matrix</span></div>
<div class="line">        mProjectionMatrix = context.<a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#a71cbe2a3f2dfa967ebc43b5e97456ccb">getMatrix</a>(<a name="a38"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#acc6ad8472c2abfd2f63e100474b977f9a9bfe03d742b94b682ba896a1597df9f7">MHWRender::MFrameContext::kProjectionMtx</a>, &amp;status);</div>
<div class="line"> <span class="keywordflow">if</span> (status != <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MStatus::kSuccess</a>) <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Compute a pick matrix that, when it is post-multiplied with the</span></div>
<div class="line"> <span class="comment">// projection matrix, will cause the picking region to fill the entire</span></div>
<div class="line"> <span class="comment">// viewport for OpenGL selection mode.</span></div>
<div class="line"> <span class="keywordflow">if</span> (selectInfo)</div>
<div class="line">        {</div>
<div class="line"> <span class="keywordtype">int</span> view_x, view_y, view_w, view_h;</div>
<div class="line">            context.<a name="a39"></a><a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#a7cd3b2dca6e4f8f4641b587bc642b08e">getViewportDimensions</a>(view_x, view_y, view_w, view_h);</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sel_x, sel_y, sel_w, sel_h;</div>
<div class="line">            selectInfo-&gt;<a name="a40"></a><a class="code" href="./class_m_h_w_render_1_1_m_selection_info.html#a2e00d4919c72b22e16478dfd986684b2">selectRect</a>(sel_x, sel_y, sel_w, sel_h);</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">double</span> center_x = sel_x + sel_w * 0.5;</div>
<div class="line"> <span class="keywordtype">double</span> center_y = sel_y + sel_h * 0.5;</div>
<div class="line"></div>
<div class="line"> <a name="_a41"></a><a class="code" href="./class_m_matrix.html">MMatrix</a> pickMatrix;</div>
<div class="line">            pickMatrix[0][0] = view_w / double(sel_w);</div>
<div class="line">            pickMatrix[1][1] = view_h / double(sel_h);</div>
<div class="line">            pickMatrix[3][0] = (view_w - 2.0 * (center_x - view_x)) / double(sel_w);</div>
<div class="line">            pickMatrix[3][1] = (view_h - 2.0 * (center_y - view_y)) / double(sel_h);</div>
<div class="line"></div>
<div class="line">            mProjectionMatrix *= pickMatrix;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    RawFootPrintDrawAgentGL(){}</div>
<div class="line">    ~RawFootPrintDrawAgentGL()<span class="keyword"> override</span>{}</div>
<div class="line">    RawFootPrintDrawAgentGL( <span class="keyword">const</span> RawFootPrintDrawAgentGL&amp; v ){}</div>
<div class="line">    RawFootPrintDrawAgentGL operator = (<span class="keyword">const</span> RawFootPrintDrawAgentGL&amp; v){ <span class="keywordflow">return</span> *<span class="keyword">this</span>; }</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_matrix.html">MMatrix</a> mWorldViewMatrix;</div>
<div class="line"> <a class="code" href="./class_m_matrix.html">MMatrix</a> mProjectionMatrix;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">// GL Core Profile functions:</span></div>
<div class="line"><span class="keyword">class </span>GLCP</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"> <span class="comment">// For more extensive OpenGL coding you will definitively want to</span></div>
<div class="line"> <span class="comment">// use a good extension loader framework. I recommend looking at:</span></div>
<div class="line"> <span class="comment">// https://www.opengl.org/wiki/OpenGL_Loading_Library </span></div>
<div class="line"> <span class="comment">// to find the one that will fit your needs the best.</span></div>
<div class="line"> <span class="comment">// Also note that MGLFunctionTable stops at GL 2.1, so a lot</span></div>
<div class="line"> <span class="comment">// of functions will be missing.</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if !defined (OSMac_)</span></div>
<div class="line"> <span class="keyword">typedef</span> <span class="keywordtype">char</span> GLchar;</div>
<div class="line"> <span class="keyword">typedef</span> ptrdiff_t GLsizeiptr;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glBindVertexArray) (GLuint array);</div>
<div class="line"> <span class="keyword">static</span> Tp_glBindVertexArray BindVertexArray;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glGenVertexArrays) (GLsizei n, GLuint *arrays);</div>
<div class="line"> <span class="keyword">static</span> Tp_glGenVertexArrays GenVertexArrays;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glDeleteVertexArrays ) (GLsizei n, <span class="keyword">const</span> GLuint *arrays);</div>
<div class="line"> <span class="keyword">static</span> Tp_glDeleteVertexArrays DeleteVertexArrays;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glUniform4f) (GLint location, GLfloat v0, GLfloat v1, GLfloat v2, GLfloat v3);</div>
<div class="line"> <span class="keyword">static</span> Tp_glUniform4f Uniform4f;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glUniformMatrix4fv) (GLint location, GLsizei count, GLboolean transpose, <span class="keyword">const</span> GLfloat *value);</div>
<div class="line"> <span class="keyword">static</span> Tp_glUniformMatrix4fv UniformMatrix4fv;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> GLint (APIENTRY *Tp_glGetUniformLocation) (GLuint program, <span class="keyword">const</span> GLchar *name);</div>
<div class="line"> <span class="keyword">static</span> Tp_glGetUniformLocation GetUniformLocation;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> GLint (APIENTRY *Tp_glGetAttribLocation) (GLuint program, <span class="keyword">const</span> GLchar *name);</div>
<div class="line"> <span class="keyword">static</span> Tp_glGetAttribLocation GetAttribLocation;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> GLuint (APIENTRY *Tp_glCreateShader ) (GLenum type);</div>
<div class="line"> <span class="keyword">static</span> Tp_glCreateShader CreateShader;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glShaderSource ) (GLuint shader, GLsizei count, <span class="keyword">const</span> GLchar *<span class="keyword">const</span>*string, <span class="keyword">const</span> GLint *length);</div>
<div class="line"> <span class="keyword">static</span> Tp_glShaderSource ShaderSource;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glCompileShader ) (GLuint shader);</div>
<div class="line"> <span class="keyword">static</span> Tp_glCompileShader CompileShader;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glGetShaderiv ) (GLuint shader, GLenum pname, GLint *params);</div>
<div class="line"> <span class="keyword">static</span> Tp_glGetShaderiv GetShaderiv;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glGetShaderInfoLog ) (GLuint shader, GLsizei bufSize, GLsizei *length, GLchar *infoLog);</div>
<div class="line"> <span class="keyword">static</span> Tp_glGetShaderInfoLog GetShaderInfoLog;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> GLuint (APIENTRY *Tp_glCreateProgram ) ();</div>
<div class="line"> <span class="keyword">static</span> Tp_glCreateProgram CreateProgram;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glAttachShader ) (GLuint program, GLuint shader);</div>
<div class="line"> <span class="keyword">static</span> Tp_glAttachShader AttachShader;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glDeleteShader ) (GLuint shader);</div>
<div class="line"> <span class="keyword">static</span> Tp_glDeleteShader DeleteShader;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glLinkProgram ) (GLuint program);</div>
<div class="line"> <span class="keyword">static</span> Tp_glLinkProgram LinkProgram;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glGetProgramiv ) (GLuint program, GLenum pname, GLint *params);</div>
<div class="line"> <span class="keyword">static</span> Tp_glGetProgramiv GetProgramiv;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glUseProgram ) (GLuint program);</div>
<div class="line"> <span class="keyword">static</span> Tp_glUseProgram UseProgram;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glDeleteProgram ) (GLuint program);</div>
<div class="line"> <span class="keyword">static</span> Tp_glDeleteProgram DeleteProgram;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glGetProgramInfoLog ) (GLuint program, GLsizei bufSize, GLsizei *length, GLchar *infoLog);</div>
<div class="line"> <span class="keyword">static</span> Tp_glGetProgramInfoLog GetProgramInfoLog;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glGenBuffers ) (GLsizei n, GLuint *buffers);</div>
<div class="line"> <span class="keyword">static</span> Tp_glGenBuffers GenBuffers;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glDeleteBuffers ) (GLsizei n, <span class="keyword">const</span> GLuint *buffers);</div>
<div class="line"> <span class="keyword">static</span> Tp_glDeleteBuffers DeleteBuffers;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glBindBuffer ) (GLenum target, GLuint buffer);</div>
<div class="line"> <span class="keyword">static</span> Tp_glBindBuffer BindBuffer;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glBufferData ) (GLenum target, GLsizeiptr size, <span class="keyword">const</span> <span class="keywordtype">void</span> *data, GLenum usage);</div>
<div class="line"> <span class="keyword">static</span> Tp_glBufferData BufferData;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glEnableVertexAttribArray ) (GLuint index);</div>
<div class="line"> <span class="keyword">static</span> Tp_glEnableVertexAttribArray EnableVertexAttribArray;</div>
<div class="line"> </div>
<div class="line"> <span class="keyword">typedef</span> void (APIENTRY *Tp_glVertexAttribPointer ) (GLuint index, GLint size, GLenum type, GLboolean normalized, GLsizei stride, <span class="keyword">const</span> <span class="keywordtype">void</span> *pointer);</div>
<div class="line"> <span class="keyword">static</span> Tp_glVertexAttribPointer VertexAttribPointer;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">static</span> <span class="keywordtype">void</span> initGLFunctionsCoreProfile();</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line">GLCP::Tp_glBindVertexArray GLCP::BindVertexArray = 0;</div>
<div class="line">GLCP::Tp_glGenVertexArrays GLCP::GenVertexArrays = 0;</div>
<div class="line">GLCP::Tp_glDeleteVertexArrays GLCP::DeleteVertexArrays = 0;</div>
<div class="line">GLCP::Tp_glUniform4f GLCP::Uniform4f = 0;</div>
<div class="line">GLCP::Tp_glUniformMatrix4fv GLCP::UniformMatrix4fv = 0;</div>
<div class="line">GLCP::Tp_glGetUniformLocation GLCP::GetUniformLocation = 0;</div>
<div class="line">GLCP::Tp_glGetAttribLocation GLCP::GetAttribLocation = 0;</div>
<div class="line">GLCP::Tp_glCreateShader GLCP::CreateShader = 0;</div>
<div class="line">GLCP::Tp_glShaderSource GLCP::ShaderSource = 0;</div>
<div class="line">GLCP::Tp_glCompileShader GLCP::CompileShader = 0;</div>
<div class="line">GLCP::Tp_glGetShaderiv GLCP::GetShaderiv = 0;</div>
<div class="line">GLCP::Tp_glGetShaderInfoLog GLCP::GetShaderInfoLog = 0;</div>
<div class="line">GLCP::Tp_glCreateProgram GLCP::CreateProgram = 0;</div>
<div class="line">GLCP::Tp_glAttachShader GLCP::AttachShader = 0;</div>
<div class="line">GLCP::Tp_glDeleteShader GLCP::DeleteShader = 0;</div>
<div class="line">GLCP::Tp_glLinkProgram GLCP::LinkProgram = 0;</div>
<div class="line">GLCP::Tp_glGetProgramiv GLCP::GetProgramiv = 0;</div>
<div class="line">GLCP::Tp_glUseProgram GLCP::UseProgram = 0;</div>
<div class="line">GLCP::Tp_glDeleteProgram GLCP::DeleteProgram = 0;</div>
<div class="line">GLCP::Tp_glGetProgramInfoLog GLCP::GetProgramInfoLog = 0;</div>
<div class="line">GLCP::Tp_glGenBuffers GLCP::GenBuffers = 0;</div>
<div class="line">GLCP::Tp_glDeleteBuffers GLCP::DeleteBuffers = 0;</div>
<div class="line">GLCP::Tp_glBindBuffer GLCP::BindBuffer = 0;</div>
<div class="line">GLCP::Tp_glBufferData GLCP::BufferData = 0;</div>
<div class="line">GLCP::Tp_glEnableVertexAttribArray GLCP::EnableVertexAttribArray = 0;</div>
<div class="line">GLCP::Tp_glVertexAttribPointer GLCP::VertexAttribPointer = 0;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> GLCP::initGLFunctionsCoreProfile()</div>
<div class="line">{</div>
<div class="line"><span class="preprocessor">#if defined (OSMac_)</span></div>
<div class="line"><span class="preprocessor">    #define INIT_GLPOINTER(funcName) funcName = gl##funcName</span></div>
<div class="line"><span class="preprocessor">#elif defined (_WIN32)</span></div>
<div class="line"><span class="preprocessor">    #define INIT_GLPOINTER(funcName) if (!funcName) funcName = (Tp_gl##funcName)wglGetProcAddress("gl" #funcName)</span></div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor">    #define INIT_GLPOINTER(funcName) if (!funcName) funcName = (Tp_gl##funcName)::glXGetProcAddressARB((const GLubyte*)"gl" #funcName)</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line">    INIT_GLPOINTER(BindVertexArray);</div>
<div class="line">    INIT_GLPOINTER(GenVertexArrays);</div>
<div class="line">    INIT_GLPOINTER(DeleteVertexArrays);</div>
<div class="line">    INIT_GLPOINTER(Uniform4f);</div>
<div class="line">    INIT_GLPOINTER(UniformMatrix4fv);</div>
<div class="line">    INIT_GLPOINTER(GetUniformLocation);</div>
<div class="line">    INIT_GLPOINTER(GetAttribLocation);</div>
<div class="line">    INIT_GLPOINTER(CreateShader);</div>
<div class="line">    INIT_GLPOINTER(ShaderSource);</div>
<div class="line">    INIT_GLPOINTER(CompileShader);</div>
<div class="line">    INIT_GLPOINTER(GetShaderiv);</div>
<div class="line">    INIT_GLPOINTER(GetShaderInfoLog);</div>
<div class="line">    INIT_GLPOINTER(CreateProgram);</div>
<div class="line">    INIT_GLPOINTER(AttachShader);</div>
<div class="line">    INIT_GLPOINTER(DeleteShader);</div>
<div class="line">    INIT_GLPOINTER(LinkProgram);</div>
<div class="line">    INIT_GLPOINTER(GetProgramiv);</div>
<div class="line">    INIT_GLPOINTER(UseProgram);</div>
<div class="line">    INIT_GLPOINTER(DeleteProgram);</div>
<div class="line">    INIT_GLPOINTER(GetProgramInfoLog);</div>
<div class="line">    INIT_GLPOINTER(GenBuffers);</div>
<div class="line">    INIT_GLPOINTER(DeleteBuffers);</div>
<div class="line">    INIT_GLPOINTER(BindBuffer);</div>
<div class="line">    INIT_GLPOINTER(BufferData);</div>
<div class="line">    INIT_GLPOINTER(EnableVertexAttribArray);</div>
<div class="line">    INIT_GLPOINTER(VertexAttribPointer);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#undef INIT_GLPOINTER</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if !defined (OSMac_)</span></div>
<div class="line"><span class="preprocessor">#define GL_FRAGMENT_SHADER                0x8B30</span></div>
<div class="line"><span class="preprocessor">#define GL_VERTEX_SHADER                  0x8B31</span></div>
<div class="line"><span class="preprocessor">#define GL_ARRAY_BUFFER                   0x8892</span></div>
<div class="line"><span class="preprocessor">#define GL_ELEMENT_ARRAY_BUFFER           0x8893</span></div>
<div class="line"><span class="preprocessor">#define GL_STATIC_DRAW                    0x88E4</span></div>
<div class="line"><span class="preprocessor">#define GL_COMPILE_STATUS                 0x8B81</span></div>
<div class="line"><span class="preprocessor">#define GL_LINK_STATUS                    0x8B82</span></div>
<div class="line"><span class="preprocessor">#define GL_INFO_LOG_LENGTH                0x8B84</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Core Profile draw agent declaration</span></div>
<div class="line"><span class="keyword">class </span>RawFootPrintDrawAgentCoreProfile : <span class="keyword">public</span> RawFootPrintDrawAgent</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"> <span class="keyword">static</span> RawFootPrintDrawAgentCoreProfile&amp; getDrawAgent(){</div>
<div class="line"> <span class="keyword">static</span> RawFootPrintDrawAgentCoreProfile obj;</div>
<div class="line"> <span class="keywordflow">return</span> obj;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">void</span> drawShaded() <span class="keyword">override</span>;</div>
<div class="line"> <span class="keywordtype">void</span> drawBoundingBox() <span class="keyword">override</span>;</div>
<div class="line"> <span class="keywordtype">void</span> drawWireframe() <span class="keyword">override</span>;</div>
<div class="line"> <span class="keywordtype">void</span> beginDraw( <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context, <a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html">MHWRender::MShaderInstance</a>* passShaderOverride ) <span class="keyword">override</span>;</div>
<div class="line"> <span class="keywordtype">void</span> endDraw() <span class="keyword">override</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">void</span> setMatrix(</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_selection_info.html">MHWRender::MSelectionInfo</a>* selectInfo)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line"> <span class="comment">// Get world view projection matrix</span></div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> status;</div>
<div class="line">        mWorldViewProjMatrix =</div>
<div class="line">            context.<a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#a71cbe2a3f2dfa967ebc43b5e97456ccb">getMatrix</a>(<a name="a42"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#acc6ad8472c2abfd2f63e100474b977f9aef68016d080e72df2f823fb80e1f0473">MHWRender::MFrameContext::kWorldViewProjMtx</a>, &amp;status);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">bool</span> releaseCoreProfileResources();</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    GLuint mShaderProgram;</div>
<div class="line">    GLint mWVPIndex;</div>
<div class="line">    GLint mColorIndex;</div>
<div class="line">    GLint mVtxAttrib;</div>
<div class="line"></div>
<div class="line">    GLuint mBBoxVAO;</div>
<div class="line">    GLuint mSoleWireframeVAO;</div>
<div class="line">    GLuint mHeelWireframeVAO;</div>
<div class="line">    GLuint mSoleShadedVAO;</div>
<div class="line">    GLuint mHeelShadedVAO;</div>
<div class="line"></div>
<div class="line">    GLuint mBoundingboxVertexBuffer;</div>
<div class="line">    GLuint mBoundingboxIndexBuffer;</div>
<div class="line">    GLuint mSoleVertexBuffer;</div>
<div class="line">    GLuint mSoleNormalBuffer;</div>
<div class="line">    GLuint mHeelVertexBuffer;</div>
<div class="line">    GLuint mHeelNormalBuffer;</div>
<div class="line">    GLuint mSoleWireIndexBuffer;</div>
<div class="line">    GLuint mSoleShadedIndexBuffer;</div>
<div class="line">    GLuint mHeelWireIndexBuffer;</div>
<div class="line">    GLuint mHeelShadedIndexBuffer;</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_matrix.html">MMatrix</a> mWorldViewProjMatrix;</div>
<div class="line"> <span class="keywordtype">bool</span> mInitialized;</div>
<div class="line"> <span class="keywordtype">bool</span> mValid;</div>
<div class="line"> <span class="keywordtype">bool</span> initShadersCoreProfile();</div>
<div class="line"> <span class="keywordtype">bool</span> initBuffersCoreProfile();</div>
<div class="line"> <span class="keywordtype">void</span> setupUniforms();</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    RawFootPrintDrawAgentCoreProfile()</div>
<div class="line"> <span class="comment">// Shader program data</span></div>
<div class="line">        : mShaderProgram(0)</div>
<div class="line">        , mWVPIndex(0)</div>
<div class="line">        , mColorIndex(0)</div>
<div class="line">        , mVtxAttrib(0)</div>
<div class="line"> <span class="comment">// VAOs</span></div>
<div class="line">        , mBBoxVAO(0)</div>
<div class="line">        , mSoleWireframeVAO(0)</div>
<div class="line">        , mHeelWireframeVAO(0)</div>
<div class="line">        , mSoleShadedVAO(0)</div>
<div class="line">        , mHeelShadedVAO(0)</div>
<div class="line"> <span class="comment">// Draw buffers</span></div>
<div class="line">        , mBoundingboxVertexBuffer(0)</div>
<div class="line">        , mBoundingboxIndexBuffer(0)</div>
<div class="line">        , mSoleVertexBuffer(0)</div>
<div class="line">        , mSoleNormalBuffer(0)</div>
<div class="line">        , mHeelVertexBuffer(0)</div>
<div class="line">        , mHeelNormalBuffer(0)</div>
<div class="line">        , mSoleWireIndexBuffer(0)</div>
<div class="line">        , mSoleShadedIndexBuffer(0)</div>
<div class="line">        , mHeelWireIndexBuffer(0)</div>
<div class="line">        , mHeelShadedIndexBuffer(0)</div>
<div class="line">        , mInitialized(false)</div>
<div class="line">        , mValid(false)</div>
<div class="line">        {}</div>
<div class="line">    ~RawFootPrintDrawAgentCoreProfile()<span class="keyword"> override</span>{}</div>
<div class="line">    RawFootPrintDrawAgentCoreProfile( <span class="keyword">const</span> RawFootPrintDrawAgentCoreProfile&amp; v ){}</div>
<div class="line">    RawFootPrintDrawAgentCoreProfile operator = (<span class="keyword">const</span> RawFootPrintDrawAgentCoreProfile&amp; v){ <span class="keywordflow">return</span> *<span class="keyword">this</span>; }</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">// DX stuff</span></div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// DX draw agent declaration</span></div>
<div class="line"><span class="keyword">class </span>RawFootPrintDrawAgentDX : <span class="keyword">public</span> RawFootPrintDrawAgent</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"> <span class="keyword">static</span> RawFootPrintDrawAgentDX&amp; getDrawAgent(){</div>
<div class="line"> <span class="keyword">static</span> RawFootPrintDrawAgentDX obj;</div>
<div class="line"> <span class="keywordflow">return</span> obj;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keyword">virtual</span> <span class="keywordtype">void</span> drawShaded();</div>
<div class="line"> <span class="keyword">virtual</span> <span class="keywordtype">void</span> drawBoundingBox();</div>
<div class="line"> <span class="keyword">virtual</span> <span class="keywordtype">void</span> drawWireframe();</div>
<div class="line"> <span class="keyword">virtual</span> <span class="keywordtype">void</span> beginDraw( <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context, <a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html">MHWRender::MShaderInstance</a>* passShaderOverride );</div>
<div class="line"> <span class="keyword">virtual</span> <span class="keywordtype">void</span> endDraw();</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">void</span> setMatrix(</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_selection_info.html">MHWRender::MSelectionInfo</a>* selectInfo)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line"> <span class="comment">// Get world view projection matrix</span></div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> status;</div>
<div class="line">        mWorldViewProjMatrix =</div>
<div class="line">            context.<a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#a71cbe2a3f2dfa967ebc43b5e97456ccb">getMatrix</a>(<a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#acc6ad8472c2abfd2f63e100474b977f9aef68016d080e72df2f823fb80e1f0473">MHWRender::MFrameContext::kWorldViewProjMtx</a>, &amp;status);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">bool</span> releaseDXResources();</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    ID3D11Device* mDevicePtr;</div>
<div class="line">    ID3D11DeviceContext* mDeviceContextPtr;</div>
<div class="line"></div>
<div class="line">    ID3D11Buffer* mBoundingboxVertexBufferPtr;</div>
<div class="line">    ID3D11Buffer* mBoundingboxIndexBufferPtr;</div>
<div class="line">    ID3D11Buffer* mSoleVertexBufferPtr[2];</div>
<div class="line">    ID3D11Buffer* mHeelVertexBufferPtr[2];</div>
<div class="line">    ID3D11Buffer* mSoleWireIndexBufferPtr;</div>
<div class="line">    ID3D11Buffer* mSoleShadedIndexBufferPtr;</div>
<div class="line">    ID3D11Buffer* mHeelWireIndexBufferPtr;</div>
<div class="line">    ID3D11Buffer* mHeelShadedIndexBufferPtr;</div>
<div class="line">    ID3D11Buffer* mConstantBufferPtr;</div>
<div class="line">    ID3D11VertexShader* mVertexShaderPtr;</div>
<div class="line">    ID3D11PixelShader* mPixelShaderPtr;</div>
<div class="line">    ID3D11InputLayout* mVertexLayoutPtr;</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> mEffectLocation;</div>
<div class="line"> <span class="keywordtype">bool</span> mEffectLoad;</div>
<div class="line"> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mStride[2];</div>
<div class="line"> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mOffset[2];</div>
<div class="line"> <a class="code" href="./class_m_matrix.html">MMatrix</a> mWorldViewProjMatrix;</div>
<div class="line"> <span class="keyword">struct </span>ConstantBufferDef</div>
<div class="line">    {</div>
<div class="line">        XMMATRIX fWVP;</div>
<div class="line">        XMFLOAT4 fMatColor;</div>
<div class="line">    };</div>
<div class="line"> <span class="keywordtype">bool</span> initShadersDX();</div>
<div class="line"> <span class="keywordtype">bool</span> initBuffersDX();</div>
<div class="line"> <span class="keywordtype">void</span> setupConstantBuffer();</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    RawFootPrintDrawAgentDX():</div>
<div class="line">        mDevicePtr(NULL), mDeviceContextPtr(NULL), mEffectLocation(<span class="stringliteral">""</span>),</div>
<div class="line">        mEffectLoad(false),</div>
<div class="line">        mBoundingboxVertexBufferPtr(NULL),</div>
<div class="line">        mBoundingboxIndexBufferPtr(NULL),</div>
<div class="line">        mSoleWireIndexBufferPtr(NULL),</div>
<div class="line">        mSoleShadedIndexBufferPtr(NULL),</div>
<div class="line">        mHeelWireIndexBufferPtr(NULL),</div>
<div class="line">        mHeelShadedIndexBufferPtr(NULL),</div>
<div class="line">        mConstantBufferPtr(NULL),</div>
<div class="line">        mVertexShaderPtr(NULL),</div>
<div class="line">        mPixelShaderPtr(NULL),</div>
<div class="line">        mVertexLayoutPtr(NULL)</div>
<div class="line">    {</div>
<div class="line">        mSoleVertexBufferPtr[0] = NULL;</div>
<div class="line">        mSoleVertexBufferPtr[1] = NULL;</div>
<div class="line">        mHeelVertexBufferPtr[0] = NULL;</div>
<div class="line">        mHeelVertexBufferPtr[1] = NULL;</div>
<div class="line"></div>
<div class="line">        mStride[0] = <span class="keyword">sizeof</span>(float) * 3;</div>
<div class="line">        mStride[1] = <span class="keyword">sizeof</span>(float) * 3;</div>
<div class="line"></div>
<div class="line">        mOffset[0] = 0;</div>
<div class="line">        mOffset[1] = 0;</div>
<div class="line">    }</div>
<div class="line">    ~RawFootPrintDrawAgentDX(){}</div>
<div class="line">    RawFootPrintDrawAgentDX( <span class="keyword">const</span> RawFootPrintDrawAgentDX&amp; v ){}</div>
<div class="line">    RawFootPrintDrawAgentDX operator = (<span class="keyword">const</span> RawFootPrintDrawAgentDX&amp; v){ <span class="keywordflow">return</span> *<span class="keyword">this</span>; }</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#endif // _WIN32</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// GL draw agent definition</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawAgentGL::beginDraw( <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context, <a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html">MHWRender::MShaderInstance</a>* passShaderOverride )</div>
<div class="line">{</div>
<div class="line">    RawFootPrintDrawAgent::beginDraw(context, passShaderOverride);</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (!mShaderOverride)</div>
<div class="line">    {</div>
<div class="line"> <span class="comment">// set world view matrix</span></div>
<div class="line">        glMatrixMode(GL_MODELVIEW);</div>
<div class="line">        glPushMatrix();</div>
<div class="line">        glLoadMatrixd(mWorldViewMatrix.matrix[0]);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// set projection matrix</span></div>
<div class="line">        glMatrixMode(GL_PROJECTION);</div>
<div class="line">        glPushMatrix();</div>
<div class="line">        glLoadMatrixd(mProjectionMatrix.matrix[0]);</div>
<div class="line"></div>
<div class="line">        glPushAttrib( GL_CURRENT_BIT );</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawAgentGL::endDraw()</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">if</span> (!mShaderOverride)</div>
<div class="line">    {</div>
<div class="line">        glPopAttrib();</div>
<div class="line">        glPopMatrix();</div>
<div class="line">        glMatrixMode(GL_MODELVIEW);</div>
<div class="line">        glPopMatrix();</div>
<div class="line">    }</div>
<div class="line">    RawFootPrintDrawAgent::endDraw();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawAgentGL::drawShaded()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// set color</span></div>
<div class="line">    glColor4fv( &amp;(mColor.r) );</div>
<div class="line"></div>
<div class="line">    glBegin( GL_TRIANGLE_FAN );</div>
<div class="line"> <span class="keywordtype">int</span> i;</div>
<div class="line"> <span class="keywordtype">int</span> last = soleCount - 1;</div>
<div class="line"> <span class="keywordflow">for</span> ( i = 0; i &lt; last; ++i ) {</div>
<div class="line">        glNormal3f( 0.0f, 1.0f, 0.0f );</div>
<div class="line">        glVertex3f( sole[i][0],</div>
<div class="line">            sole[i][1],</div>
<div class="line">            sole[i][2]);</div>
<div class="line">    }</div>
<div class="line">    glEnd();</div>
<div class="line">    glBegin( GL_TRIANGLE_FAN );</div>
<div class="line">    last = heelCount - 1;</div>
<div class="line"> <span class="keywordflow">for</span> ( i = 0; i &lt; last; ++i ) {</div>
<div class="line">        glNormal3f( 0.0f, 1.0f, 0.0f );</div>
<div class="line">        glVertex3f( heel[i][0],</div>
<div class="line">            heel[i][1],</div>
<div class="line">            heel[i][2]);</div>
<div class="line">    }</div>
<div class="line">    glEnd();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawAgentGL::drawBoundingBox()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// set color</span></div>
<div class="line">    glColor4fv( &amp;(mColor.r) );</div>
<div class="line"></div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">float</span>* bottomLeftFront = bbData[0];</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">float</span>* topLeftFront = bbData[4];</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">float</span>* bottomRightFront = bbData[1];</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">float</span>* topRightFront = bbData[5];</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">float</span>* bottomLeftBack = bbData[3];</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">float</span>* topLeftBack = bbData[7];</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">float</span>* bottomRightBack = bbData[2];</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">float</span>* topRightBack = bbData[6];</div>
<div class="line"></div>
<div class="line">    glBegin( GL_LINES );</div>
<div class="line"></div>
<div class="line"> <span class="comment">// 4 Bottom lines</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line">    glVertex3fv( bottomLeftFront );</div>
<div class="line">    glVertex3fv( bottomRightFront );</div>
<div class="line">    glVertex3fv( bottomRightFront );</div>
<div class="line">    glVertex3fv( bottomRightBack );</div>
<div class="line">    glVertex3fv( bottomRightBack );</div>
<div class="line">    glVertex3fv( bottomLeftBack );</div>
<div class="line">    glVertex3fv( bottomLeftBack );</div>
<div class="line">    glVertex3fv( bottomLeftFront );</div>
<div class="line"></div>
<div class="line"> <span class="comment">// 4 Top lines</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line">    glVertex3fv( topLeftFront );</div>
<div class="line">    glVertex3fv( topRightFront );</div>
<div class="line">    glVertex3fv( topRightFront );</div>
<div class="line">    glVertex3fv( topRightBack );</div>
<div class="line">    glVertex3fv( topRightBack );</div>
<div class="line">    glVertex3fv( topLeftBack );</div>
<div class="line">    glVertex3fv( topLeftBack );</div>
<div class="line">    glVertex3fv( topLeftFront );</div>
<div class="line"></div>
<div class="line"> <span class="comment">// 4 Side lines</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line">    glVertex3fv( bottomLeftFront );</div>
<div class="line">    glVertex3fv( topLeftFront );</div>
<div class="line">    glVertex3fv( bottomRightFront );</div>
<div class="line">    glVertex3fv( topRightFront );</div>
<div class="line">    glVertex3fv( bottomRightBack );</div>
<div class="line">    glVertex3fv( topRightBack );</div>
<div class="line">    glVertex3fv( bottomLeftBack );</div>
<div class="line">    glVertex3fv( topLeftBack );</div>
<div class="line"></div>
<div class="line">    glEnd();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawAgentGL::drawWireframe()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// set color</span></div>
<div class="line">    glColor4fv( &amp;(mColor.r) );</div>
<div class="line"></div>
<div class="line"> <span class="comment">// draw wire</span></div>
<div class="line">    glBegin( GL_LINES );</div>
<div class="line"> <span class="keywordtype">int</span> i;</div>
<div class="line"> <span class="keywordtype">int</span> last = soleCount - 1;</div>
<div class="line"> <span class="keywordflow">for</span> ( i = 0; i &lt; last; ++i ) {</div>
<div class="line">        glVertex3f( sole[i][0],</div>
<div class="line">            sole[i][1],</div>
<div class="line">            sole[i][2]);</div>
<div class="line">        glVertex3f( sole[i+1][0],</div>
<div class="line">            sole[i+1][1],</div>
<div class="line">            sole[i+1][2]);</div>
<div class="line">    }</div>
<div class="line">    last = heelCount - 1;</div>
<div class="line"> <span class="keywordflow">for</span> ( i = 0; i &lt; last; ++i ) {</div>
<div class="line">        glVertex3f( heel[i][0],</div>
<div class="line">            heel[i][1],</div>
<div class="line">            heel[i][2]);</div>
<div class="line">        glVertex3f( heel[i+1][0],</div>
<div class="line">            heel[i+1][1],</div>
<div class="line">            heel[i+1][2]);</div>
<div class="line">    }</div>
<div class="line">    glEnd();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Core Profile draw agent definition</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawAgentCoreProfile::beginDraw( <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context, <a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html">MHWRender::MShaderInstance</a>* passShaderOverride )</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Init common data:</span></div>
<div class="line"> <span class="keywordflow">if</span> ( !mInitialized ){</div>
<div class="line"> <span class="comment">// Set up all the one-time data:</span></div>
<div class="line">        GLCP::initGLFunctionsCoreProfile();</div>
<div class="line">        mValid = initShadersCoreProfile() &amp;&amp; initBuffersCoreProfile();</div>
<div class="line">        mInitialized = <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (!mValid)</div>
<div class="line"> <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line">    RawFootPrintDrawAgent::beginDraw(context, passShaderOverride);</div>
<div class="line"> <span class="keywordflow">if</span> (!mShaderOverride) {</div>
<div class="line">        GLCP::UseProgram(mShaderProgram);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawAgentCoreProfile::endDraw()</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">if</span> (!mValid)</div>
<div class="line"> <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (!mShaderOverride) {</div>
<div class="line">        GLCP::UseProgram(0);</div>
<div class="line">    }</div>
<div class="line">    GLCP::BindVertexArray(0);</div>
<div class="line"></div>
<div class="line">    RawFootPrintDrawAgent::endDraw();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawAgentCoreProfile::setupUniforms()</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">if</span>( mShaderOverride == NULL )</div>
<div class="line">    {</div>
<div class="line"> <span class="keywordtype">float</span> fMatrix[4][4];</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; 4; ++i)</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; 4; ++j)</div>
<div class="line">                fMatrix[i][j] = (<span class="keywordtype">float</span>)mWorldViewProjMatrix.matrix[i][j];</div>
<div class="line"></div>
<div class="line">        GLCP::UniformMatrix4fv(mWVPIndex, 1, GL_FALSE, (<span class="keywordtype">float</span>*)fMatrix);</div>
<div class="line"></div>
<div class="line">        GLCP::Uniform4f(mColorIndex, mColor.r, mColor.g, mColor.b, mColor.a);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawAgentCoreProfile::drawShaded()</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">if</span> (!mValid)</div>
<div class="line"> <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Set uniforms</span></div>
<div class="line">    setupUniforms();</div>
<div class="line"></div>
<div class="line">    GLCP::BindVertexArray(mSoleShadedVAO);</div>
<div class="line">    glDrawElements(GL_TRIANGLES, 3 * (soleCount-2), GL_UNSIGNED_SHORT, 0);</div>
<div class="line">    GLCP::BindVertexArray(mHeelShadedVAO);</div>
<div class="line">    glDrawElements(GL_TRIANGLES, 3 * (heelCount-2), GL_UNSIGNED_SHORT, 0);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawAgentCoreProfile::drawBoundingBox()</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">if</span> (!mValid)</div>
<div class="line"> <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Set uniforms</span></div>
<div class="line">    setupUniforms();</div>
<div class="line"></div>
<div class="line">    GLCP::BindVertexArray(mBBoxVAO);</div>
<div class="line">    glDrawElements(GL_LINES, 2 * 12, GL_UNSIGNED_SHORT, 0);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawAgentCoreProfile::drawWireframe()</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">if</span> (!mValid)</div>
<div class="line"> <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Set uniforms</span></div>
<div class="line">    setupUniforms();</div>
<div class="line"></div>
<div class="line">    GLCP::BindVertexArray(mSoleWireframeVAO);</div>
<div class="line">    glDrawElements(GL_LINES, 2 * (soleCount-1), GL_UNSIGNED_SHORT, 0);</div>
<div class="line">    GLCP::BindVertexArray(mHeelWireframeVAO);</div>
<div class="line">    glDrawElements(GL_LINES, 2 * (heelCount-1), GL_UNSIGNED_SHORT, 0);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// DX stuff</span></div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="comment">// DX draw agent definition</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawAgentDX::beginDraw( <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context, <a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html">MHWRender::MShaderInstance</a>* passShaderOverride )</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">if</span> (!mEffectLoad)</div>
<div class="line">    {</div>
<div class="line"> <span class="comment">// Please move file "rawfootprint.hlsl" to following location, or </span></div>
<div class="line"> <span class="comment">// change following location as your local path.</span></div>
<div class="line">        mEffectLocation = <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"$MAYA_PLUG_IN_PATH/rawfootprint.hlsl"</span>);</div>
<div class="line"></div>
<div class="line"> <a name="_a43"></a><a class="code" href="./class_m_file_object.html">MFileObject</a> fileObj;</div>
<div class="line">        fileObj.<a name="a44"></a><a class="code" href="./class_m_file_object.html#ac14aefbfe38c2711256eb8c14a3194ee">setRawFullName</a>(mEffectLocation);</div>
<div class="line">        fileObj.<a name="a45"></a><a class="code" href="./class_m_file_object.html#a4b3d5deec3dc9475f712c8e0f2f4d9a2">setResolveMethod</a>(<a name="a46"></a><a class="code" href="./class_m_file_object.html#af71e719034e8e9a4c69adcc174ca9049ac1ce1604eaae6e61df873510a9254fb3">MFileObject::kInputFile</a>);</div>
<div class="line">        assert(fileObj.<a name="a47"></a><a class="code" href="./class_m_file_object.html#aa9100e4c626877b706ca9fc67a35c562">exists</a>());</div>
<div class="line"> <span class="keywordflow">if</span> (!fileObj.<a class="code" href="./class_m_file_object.html#aa9100e4c626877b706ca9fc67a35c562">exists</a>())</div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> msg = <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"Can not find file:"</span>) + mEffectLocation;</div>
<div class="line"> <a name="a48"></a><a class="code" href="./class_m_global.html#acb043e7fc4eb7fc0f39833d31364b8a4">MGlobal::displayWarning</a>(msg);</div>
<div class="line">            mEffectLoad = <span class="keyword">false</span>;</div>
<div class="line"> <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        mEffectLocation = fileObj.<a name="a49"></a><a class="code" href="./class_m_file_object.html#a9484f49594e6f95729f1be1608a6ae8f">resolvedFullName</a>();</div>
<div class="line">        mEffectLoad = <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Initial device</span></div>
<div class="line"> <span class="keywordflow">if</span>( !mDevicePtr || !mDeviceContextPtr ){</div>
<div class="line"> <span class="comment">// get renderer</span></div>
<div class="line"> <a name="_a50"></a><a class="code" href="./class_m_h_w_render_1_1_m_renderer.html">MHWRender::MRenderer</a>* theRenderer = <a name="a51"></a><a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#a4678a72ac6959ed21d422d27928d0343">MHWRender::MRenderer::theRenderer</a>();</div>
<div class="line"> <span class="keywordflow">if</span> ( theRenderer ){</div>
<div class="line">            mDevicePtr = (ID3D11Device*)theRenderer-&gt;<a name="a52"></a><a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#a637ec8cc3cc0e631f1d134f6891f89f0">GPUDeviceHandle</a>();</div>
<div class="line"> <span class="keywordflow">if</span> ( mDevicePtr ){</div>
<div class="line">                mDevicePtr-&gt;GetImmediateContext( &amp;mDeviceContextPtr );</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    assert( mDevicePtr );</div>
<div class="line">    assert( mDeviceContextPtr );</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> ( mDevicePtr &amp;&amp; mDeviceContextPtr ){</div>
<div class="line"></div>
<div class="line">        RawFootPrintDrawAgent::beginDraw(context, passShaderOverride);</div>
<div class="line"> <span class="comment">// Init shaders</span></div>
<div class="line"> <span class="keywordflow">if</span> ( initShadersDX() &amp;&amp; passShaderOverride == NULL ){</div>
<div class="line"> <span class="comment">// Set up shader</span></div>
<div class="line">            mDeviceContextPtr-&gt;VSSetShader(mVertexShaderPtr, NULL, 0);</div>
<div class="line">            mDeviceContextPtr-&gt;PSSetShader(mPixelShaderPtr, NULL, 0);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Init buffers</span></div>
<div class="line">        initBuffersDX();</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawAgentDX::endDraw()</div>
<div class="line">{</div>
<div class="line">    RawFootPrintDrawAgent::endDraw();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawAgentDX::setupConstantBuffer()</div>
<div class="line">{</div>
<div class="line">    assert( mDeviceContextPtr );</div>
<div class="line"> <span class="keywordflow">if</span> ( !mDeviceContextPtr )</div>
<div class="line"> <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span>( mShaderOverride == NULL )</div>
<div class="line">    {</div>
<div class="line"> <span class="comment">// Compute matrix</span></div>
<div class="line">        XMMATRIX dxTransform = XMMATRIX(</div>
<div class="line">            (<span class="keywordtype">float</span>)mWorldViewProjMatrix.matrix[0][0], (<span class="keywordtype">float</span>)mWorldViewProjMatrix.matrix[0][1], (<span class="keywordtype">float</span>)mWorldViewProjMatrix.matrix[0][2], (<span class="keywordtype">float</span>)mWorldViewProjMatrix.matrix[0][3],</div>
<div class="line">            (<span class="keywordtype">float</span>)mWorldViewProjMatrix.matrix[1][0], (<span class="keywordtype">float</span>)mWorldViewProjMatrix.matrix[1][1], (<span class="keywordtype">float</span>)mWorldViewProjMatrix.matrix[1][2], (<span class="keywordtype">float</span>)mWorldViewProjMatrix.matrix[1][3],</div>
<div class="line">            (<span class="keywordtype">float</span>)mWorldViewProjMatrix.matrix[2][0], (<span class="keywordtype">float</span>)mWorldViewProjMatrix.matrix[2][1], (<span class="keywordtype">float</span>)mWorldViewProjMatrix.matrix[2][2], (<span class="keywordtype">float</span>)mWorldViewProjMatrix.matrix[2][3],</div>
<div class="line">            (<span class="keywordtype">float</span>)mWorldViewProjMatrix.matrix[3][0], (<span class="keywordtype">float</span>)mWorldViewProjMatrix.matrix[3][1], (<span class="keywordtype">float</span>)mWorldViewProjMatrix.matrix[3][2], (<span class="keywordtype">float</span>)mWorldViewProjMatrix.matrix[3][3]);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Set constant buffer</span></div>
<div class="line">        ConstantBufferDef cb;</div>
<div class="line">        cb.fWVP = XMMatrixTranspose(dxTransform);</div>
<div class="line">        cb.fMatColor = XMFLOAT4( mColor.r, mColor.g, mColor.b, mColor.a);</div>
<div class="line"></div>
<div class="line">        mDeviceContextPtr-&gt;UpdateSubresource(mConstantBufferPtr, 0, NULL, &amp;cb, 0, 0);</div>
<div class="line">        mDeviceContextPtr-&gt;VSSetConstantBuffers(0, 1, &amp;mConstantBufferPtr);</div>
<div class="line">        mDeviceContextPtr-&gt;PSSetConstantBuffers(0, 1, &amp;mConstantBufferPtr);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawAgentDX::drawShaded()</div>
<div class="line">{</div>
<div class="line">    assert( mDeviceContextPtr );</div>
<div class="line"> <span class="keywordflow">if</span> ( !(mDeviceContextPtr &amp;&amp; mEffectLoad) )</div>
<div class="line"> <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Set constant buffer</span></div>
<div class="line">    setupConstantBuffer();</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Draw the sole. Position + normals</span></div>
<div class="line">    mDeviceContextPtr-&gt;IASetVertexBuffers(0, 2, &amp;mSoleVertexBufferPtr[0], &amp;mStride[0], &amp;mOffset[0]);</div>
<div class="line">    mDeviceContextPtr-&gt;IASetIndexBuffer(mSoleShadedIndexBufferPtr, DXGI_FORMAT_R16_UINT, 0);</div>
<div class="line">    mDeviceContextPtr-&gt;IASetInputLayout(mVertexLayoutPtr);</div>
<div class="line">    mDeviceContextPtr-&gt;IASetPrimitiveTopology(D3D11_PRIMITIVE_TOPOLOGY_TRIANGLELIST);</div>
<div class="line">    mDeviceContextPtr-&gt;DrawIndexed(3 * (soleCount-2), 0, 0);</div>
<div class="line"> <span class="comment">// Draw the heel. Position + normals</span></div>
<div class="line">    mDeviceContextPtr-&gt;IASetVertexBuffers(0, 2, &amp;mHeelVertexBufferPtr[0], &amp;mStride[0], &amp;mOffset[0]);</div>
<div class="line">    mDeviceContextPtr-&gt;IASetIndexBuffer(mHeelShadedIndexBufferPtr, DXGI_FORMAT_R16_UINT, 0);</div>
<div class="line">    mDeviceContextPtr-&gt;IASetInputLayout(mVertexLayoutPtr);</div>
<div class="line">    mDeviceContextPtr-&gt;IASetPrimitiveTopology(D3D11_PRIMITIVE_TOPOLOGY_TRIANGLELIST);</div>
<div class="line">    mDeviceContextPtr-&gt;DrawIndexed(3 * (heelCount-2), 0, 0);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawAgentDX::drawBoundingBox()</div>
<div class="line">{</div>
<div class="line">    assert( mDeviceContextPtr );</div>
<div class="line"> <span class="keywordflow">if</span> ( !(mDeviceContextPtr &amp;&amp; mEffectLoad) )</div>
<div class="line"> <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Set constant buffer</span></div>
<div class="line">    setupConstantBuffer();</div>
<div class="line"></div>
<div class="line">    mDeviceContextPtr-&gt;IASetVertexBuffers(0, 1, &amp;mBoundingboxVertexBufferPtr, &amp;mStride[0], &amp;mOffset[0]);</div>
<div class="line">    mDeviceContextPtr-&gt;IASetIndexBuffer(mBoundingboxIndexBufferPtr, DXGI_FORMAT_R16_UINT, 0);</div>
<div class="line">    mDeviceContextPtr-&gt;IASetInputLayout(mVertexLayoutPtr);</div>
<div class="line">    mDeviceContextPtr-&gt;IASetPrimitiveTopology(D3D11_PRIMITIVE_TOPOLOGY_LINELIST);</div>
<div class="line">    mDeviceContextPtr-&gt;DrawIndexed(2 * 12, 0, 0);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawAgentDX::drawWireframe()</div>
<div class="line">{</div>
<div class="line">    assert( mDeviceContextPtr );</div>
<div class="line"> <span class="keywordflow">if</span> ( !(mDeviceContextPtr &amp;&amp; mEffectLoad) )</div>
<div class="line"> <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Set constant buffer</span></div>
<div class="line">    setupConstantBuffer();</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Draw the sole. Only use position buffer</span></div>
<div class="line">    mDeviceContextPtr-&gt;IASetVertexBuffers(0, 1, &amp;mSoleVertexBufferPtr[0], &amp;mStride[0], &amp;mOffset[0]);</div>
<div class="line">    mDeviceContextPtr-&gt;IASetIndexBuffer(mSoleWireIndexBufferPtr, DXGI_FORMAT_R16_UINT, 0);</div>
<div class="line">    mDeviceContextPtr-&gt;IASetInputLayout(mVertexLayoutPtr);</div>
<div class="line">    mDeviceContextPtr-&gt;IASetPrimitiveTopology(D3D11_PRIMITIVE_TOPOLOGY_LINELIST);</div>
<div class="line">    mDeviceContextPtr-&gt;DrawIndexed(2 * (soleCount-1), 0, 0);</div>
<div class="line"> <span class="comment">// Draw the heel. Only use position buffer</span></div>
<div class="line">    mDeviceContextPtr-&gt;IASetVertexBuffers(0, 1, &amp;mHeelVertexBufferPtr[0], &amp;mStride[0], &amp;mOffset[0]);</div>
<div class="line">    mDeviceContextPtr-&gt;IASetIndexBuffer(mHeelWireIndexBufferPtr, DXGI_FORMAT_R16_UINT, 0);</div>
<div class="line">    mDeviceContextPtr-&gt;IASetInputLayout(mVertexLayoutPtr);</div>
<div class="line">    mDeviceContextPtr-&gt;IASetPrimitiveTopology(D3D11_PRIMITIVE_TOPOLOGY_LINELIST);</div>
<div class="line">    mDeviceContextPtr-&gt;DrawIndexed(2 * (heelCount-1), 0, 0);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#endif // _WIN32</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span>RawFootPrintDrawOverride : <span class="keyword">public</span> <a name="_a53"></a><a class="code" href="./class_m_h_w_render_1_1_m_px_draw_override.html">MHWRender::MPxDrawOverride</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"> <span class="keyword">static</span> <a class="code" href="./class_m_h_w_render_1_1_m_px_draw_override.html">MHWRender::MPxDrawOverride</a>* Creator(<span class="keyword">const</span> <a class="code" href="./class_m_object.html">MObject</a>&amp; obj)</div>
<div class="line">    {</div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">new</span> RawFootPrintDrawOverride(obj);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    ~RawFootPrintDrawOverride() <span class="keyword">override</span>;</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./namespace_m_h_w_render.html#ad970d5c990d4803d0e9d73c1ff4fda49">MHWRender::DrawAPI</a> supportedDrawAPIs() <span class="keyword">const override</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">bool</span> isBounded(</div>
<div class="line"> <span class="keyword">const</span> <a name="_a54"></a><a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; objPath,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; cameraPath) <span class="keyword">const override</span>;</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_matrix.html">MMatrix</a> transform(</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; objPath,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; cameraPath) <span class="keyword">const override</span>;</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_bounding_box.html">MBoundingBox</a> boundingBox(</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; objPath,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; cameraPath) <span class="keyword">const override</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">bool</span> disableInternalBoundingBoxDraw() <span class="keyword">const override</span>;</div>
<div class="line"> <span class="keywordtype">bool</span> excludedFromPostEffects() <span class="keyword">const override</span>;</div>
<div class="line"> <span class="keywordtype">bool</span> isTransparent() <span class="keyword">const override</span>;</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_user_data.html">MUserData</a>* prepareForDraw(</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; objPath,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; cameraPath,</div>
<div class="line"> <span class="keyword">const</span> <a name="_a55"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html">MHWRender::MFrameContext</a>&amp; frameContext,</div>
<div class="line"> <a class="code" href="./class_m_user_data.html">MUserData</a>* oldData) <span class="keyword">override</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">bool</span> hasUIDrawables()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">void</span> addUIDrawables(</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; objPath,</div>
<div class="line"> <a name="_a56"></a><a class="code" href="./class_m_h_w_render_1_1_m_u_i_draw_manager.html">MHWRender::MUIDrawManager</a>&amp; drawManager,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html">MHWRender::MFrameContext</a>&amp; frameContext,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_user_data.html">MUserData</a>* data) <span class="keyword">override</span>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// The general trace sequence we will get is:</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="comment">// At creation and during geometry chagnes (size attribute)</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="comment">// rawFootPrintNode: Start draw override DG bounding box update for object:: |transform1|rawfootPrint1</span></div>
<div class="line"> <span class="comment">// rawFootPrintNode: End draw override DG bounding box update for object:: |transform1|rawfootPrint1</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"></div>
<div class="line"> <span class="comment">// At creation and during attribute or transform modification:</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="comment">// rawFootPrintNode: Start draw override DG node transform update for object: |transform1|rawfootPrint1</span></div>
<div class="line"> <span class="comment">// rawFootPrintNode: End draw override DG node transform update for object: |transform1|rawfootPrint1</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"></div>
<div class="line"> <span class="comment">// Every refresh:</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="comment">// rawFootPrintNode: Start draw override render item update for object: |transform1|rawfootPrint1</span></div>
<div class="line"> <span class="comment">// rawFootPrintNode:  - call draw override prepareForDraw()</span></div>
<div class="line"> <span class="comment">// rawFootPrintNode: End draw override render item update for object: |transform1|rawfootPrint1</span></div>
<div class="line"> <span class="comment">// rawFootPrintNode: Start draw override queuing of UI drawables for object: |transform1|rawfootPrint1</span></div>
<div class="line"> <span class="comment">// rawFootPrintNode:  - call draw override addUIDrawables()</span></div>
<div class="line"> <span class="comment">// rawFootPrintNode: End draw override queuing of UI drawables for object: |transform1|rawfootPrint1</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"></div>
<div class="line"> <span class="comment">// Every draw:</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="comment">// rawFootPrintNode: Start draw override draw function: |transform1|rawfootPrint1</span></div>
<div class="line"> <span class="comment">// rawFootPrintNode: End draw override draw function: |transform1|rawfootPrint1</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="keywordtype">bool</span> traceCallSequence()<span class="keyword"> const override</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line"> <span class="comment">// Return true if internal tracing is desired.</span></div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordtype">void</span> handleTraceMessage( <span class="keyword">const</span> <a class="code" href="./class_m_string.html">MString</a> &amp;message )<span class="keyword"> const override</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line"> <span class="comment">// Some simple custom message formatting.</span></div>
<div class="line">        fputs(<span class="stringliteral">"rawFootPrintNode: "</span>, stderr);</div>
<div class="line">        fputs(message.<a class="code" href="./class_m_string.html#aa9ab612f356c53479afc4c648c9ef94d">asChar</a>(), stderr);</div>
<div class="line">        fputs(<span class="stringliteral">"\n"</span>, stderr);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">bool</span> wantUserSelection()<span class="keyword"> const override</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line"> <span class="comment">// Perform user selection when the viewport renderer is using legacy</span></div>
<div class="line"> <span class="comment">// OpenGL API which supports OpenGL selection mode</span></div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_renderer.html">MHWRender::MRenderer</a>* theRenderer = <a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#a4678a72ac6959ed21d422d27928d0343">MHWRender::MRenderer::theRenderer</a>();</div>
<div class="line"> <span class="keywordflow">return</span> theRenderer &amp;&amp; theRenderer-&gt;<a name="a57"></a><a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#ae2d5ce57991bca16f525728e8d9d399e">drawAPI</a>() == <a name="a58"></a><a class="code" href="./namespace_m_h_w_render.html#ad970d5c990d4803d0e9d73c1ff4fda49a72361be679c1aca1c1be5f9b500a3315">MHWRender::kOpenGL</a>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">bool</span> userSelect(</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_selection_info.html">MHWRender::MSelectionInfo</a>&amp; selectInfo,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; objPath,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_user_data.html">MUserData</a>* data,</div>
<div class="line"> <a name="_a59"></a><a class="code" href="./class_m_selection_list.html">MSelectionList</a>&amp; selectionList,</div>
<div class="line"> <a name="_a60"></a><a class="code" href="./class_m_point_array.html">MPointArray</a>&amp; worldSpaceHitPts)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line"> <span class="comment">// This is the user selection function that will be invoked only if</span></div>
<div class="line"> <span class="comment">// wantUserSelection() returns true. The OpenGL selection mode is used</span></div>
<div class="line"> <span class="comment">// here for simplicity reason, however, a plug-in can choose other</span></div>
<div class="line"> <span class="comment">// GPU-based approaches like occlusion query, or CPU-based approaches</span></div>
<div class="line"> <span class="comment">// which perform hit test on object shapes.</span></div>
<div class="line"></div>
<div class="line"> <span class="comment">// Set up selection buffer</span></div>
<div class="line"> <span class="keyword">const</span> GLsizei BUF_SIZE = 10;</div>
<div class="line">        GLuint selectBuf[BUF_SIZE];</div>
<div class="line">        glSelectBuffer(BUF_SIZE, selectBuf);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Enter OpenGL selection mode</span></div>
<div class="line">        glRenderMode(GL_SELECT);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Call into draw code with a name pushed onto the name stack and the</span></div>
<div class="line"> <span class="comment">// select info passed into the method for adjusting projection matrix.</span></div>
<div class="line">        glInitNames();</div>
<div class="line">        glPushName(0);</div>
<div class="line">        drawImpl(context, &amp;selectInfo, data);</div>
<div class="line">        glPopName();</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Exit OpenGL selection mode.</span></div>
<div class="line">        GLint hits = glRenderMode(GL_RENDER);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Return false if nothing is hit.</span></div>
<div class="line"> <span class="keywordflow">if</span> (hits &lt;= 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Otherwise, calculate the hit point in world space. The depth is the</span></div>
<div class="line"> <span class="comment">// average of minimum and maximum, so it isn't the accurate depth at</span></div>
<div class="line"> <span class="comment">// the cursor position.</span></div>
<div class="line">        GLuint minZ = selectBuf[1];</div>
<div class="line">        GLuint maxZ = selectBuf[2];</div>
<div class="line"> <span class="keywordtype">double</span> depth = (minZ*0.5 + maxZ*0.5) / 0xFFFFFFFF;</div>
<div class="line"></div>
<div class="line"> <a name="_a61"></a><a class="code" href="./class_m_fn_camera.html">MFnCamera</a> camera(context.<a name="a62"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a7785aa5262ffc0200653a692b16fa608">getCurrentCameraPath</a>());</div>
<div class="line"> <span class="keywordflow">if</span> (!camera.isOrtho())</div>
<div class="line">        {</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">double</span> Zn = camera.<a name="a63"></a><a class="code" href="./class_m_fn_camera.html#a7189bcaad0276cd50d0d67b69e572ddd">nearClippingPlane</a>();</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">double</span> Zf = camera.farClippingPlane();</div>
<div class="line">            depth *= Zn / (Zf - depth * (Zf - Zn));</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x, y, w, h;</div>
<div class="line">        selectInfo.<a class="code" href="./class_m_h_w_render_1_1_m_selection_info.html#a2e00d4919c72b22e16478dfd986684b2">selectRect</a>(x, y, w, h);</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_point.html">MPoint</a> nearPw, farPw;</div>
<div class="line">        context.<a name="a64"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a0f5a55195c724b06707730d7d52d915c">viewportToWorld</a>(x + w*0.5, y + h*0.5, nearPw, farPw);</div>
<div class="line"></div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_point.html">MPoint</a> hitPoint = nearPw + depth * (farPw - nearPw);</div>
<div class="line"></div>
<div class="line">        selectionList.<a name="a65"></a><a class="code" href="./class_m_selection_list.html#a23929aeafb29672f2652128eac9c4dec">add</a>(objPath);</div>
<div class="line">        worldSpaceHitPts.<a name="a66"></a><a class="code" href="./class_m_point_array.html#abe5a9fe36b4651af38a4a26c85f46e1a">append</a>(hitPoint);</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keyword">static</span> <span class="keywordtype">void</span> drawImpl(</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_selection_info.html">MHWRender::MSelectionInfo</a>* selectInfo,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_user_data.html">MUserData</a>* data);</div>
<div class="line"></div>
<div class="line"> <span class="keyword">static</span> <span class="keywordtype">void</span> draw(</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_user_data.html">MUserData</a>* data)</div>
<div class="line">    {</div>
<div class="line">        drawImpl(context, <span class="keyword">nullptr</span>, data);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line"> <a class="code" href="./class_m_bounding_box.html">MBoundingBox</a> mCurrentBoundingBox;</div>
<div class="line"> <span class="keywordtype">bool</span>         mCustomBoxDraw;</div>
<div class="line"> <span class="keywordtype">bool</span>         mExcludeFromPostEffects;</div>
<div class="line"> <span class="keywordtype">bool</span>         mTransparencySort;</div>
<div class="line">    MUint64     mLastFrameStamp;</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    RawFootPrintDrawOverride(<span class="keyword">const</span> <a class="code" href="./class_m_object.html">MObject</a>&amp; obj);</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">float</span>   getMultiplier(<span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; objPath) <span class="keyword">const</span>;</div>
<div class="line"> <span class="keywordtype">bool</span>    isTransparentSort(<span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; objPath) <span class="keyword">const</span>;</div>
<div class="line"> <span class="keywordtype">float</span>   getTransparency(<span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; objPath) <span class="keyword">const</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">static</span> <span class="keywordtype">void</span> OnModelEditorChanged(<span class="keywordtype">void</span> *clientData);</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./_m_message_8h.html#a42e6e9d54a954c3e2d798a156091ca1d">MCallbackId</a> fModelEditorChangedCbId;</div>
<div class="line"> <a class="code" href="./class_m_object.html">MObject</a> fRawFootPrint;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_blend_state.html">MHWRender::MBlendState</a>* mBlendState;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">// By setting isAlwaysDirty to false in MPxDrawOverride constructor, the</span></div>
<div class="line"><span class="comment">// draw override will be updated (via prepareForDraw()) only when the node</span></div>
<div class="line"><span class="comment">// is marked dirty via DG evaluation or dirty propagation. Additional</span></div>
<div class="line"><span class="comment">// callback is also added to explicitly mark the node as being dirty (via</span></div>
<div class="line"><span class="comment">// MRenderer::setGeometryDrawDirty()) for certain circumstances.</span></div>
<div class="line">RawFootPrintDrawOverride::RawFootPrintDrawOverride(<span class="keyword">const</span> <a class="code" href="./class_m_object.html">MObject</a>&amp; obj)</div>
<div class="line">: <a class="code" href="./namespace_m_h_w_render.html">MHWRender</a>::MPxDrawOverride(obj, RawFootPrintDrawOverride::draw, false)</div>
<div class="line"><span class="comment">// We want to perform custom bounding box drawing</span></div>
<div class="line"><span class="comment">// so return true so that the internal rendering code</span></div>
<div class="line"><span class="comment">// will not draw it for us.</span></div>
<div class="line">, mCustomBoxDraw(true)</div>
<div class="line">, mExcludeFromPostEffects(false)</div>
<div class="line">, mTransparencySort(false)</div>
<div class="line">, mBlendState(NULL)</div>
<div class="line">, mLastFrameStamp(0)</div>
<div class="line">, fRawFootPrint(obj)</div>
<div class="line">{</div>
<div class="line">    fModelEditorChangedCbId = <a name="a67"></a><a class="code" href="./class_m_event_message.html#a8d22c58b90484867755273c2f7ffc6ec">MEventMessage::addEventCallback</a>(</div>
<div class="line"> <span class="stringliteral">"modelEditorChanged"</span>, OnModelEditorChanged, <span class="keyword">this</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">RawFootPrintDrawOverride::~RawFootPrintDrawOverride()</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">if</span> (mBlendState)</div>
<div class="line">    {</div>
<div class="line"> <a name="a68"></a><a class="code" href="./class_m_h_w_render_1_1_m_state_manager.html#a544e5c653741b90e7c65d2b34e8ebe60">MHWRender::MStateManager::releaseBlendState</a>(mBlendState);</div>
<div class="line">        mBlendState = NULL;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (fModelEditorChangedCbId != 0)</div>
<div class="line">    {</div>
<div class="line"> <a name="a69"></a><a class="code" href="./class_m_message.html#a50fe995add3ce133b8b56551abb4ed09">MMessage::removeCallback</a>(fModelEditorChangedCbId);</div>
<div class="line">        fModelEditorChangedCbId = 0;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawOverride::OnModelEditorChanged(<span class="keywordtype">void</span> *clientData)</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Mark the node as being dirty so that it can update on display appearance</span></div>
<div class="line"> <span class="comment">// switch among wireframe and shaded.</span></div>
<div class="line">    RawFootPrintDrawOverride *ovr = <span class="keyword">static_cast&lt;</span>RawFootPrintDrawOverride*<span class="keyword">&gt;</span>(clientData);</div>
<div class="line"> <span class="keywordflow">if</span> (ovr) <a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#ab2843a350b76cdcbf16dd70d884f9766">MHWRender::MRenderer::setGeometryDrawDirty</a>(ovr-&gt;fRawFootPrint);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="./namespace_m_h_w_render.html#ad970d5c990d4803d0e9d73c1ff4fda49">MHWRender::DrawAPI</a> RawFootPrintDrawOverride::supportedDrawAPIs()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line"> <span class="comment">// this plugin supports both GL and DX</span></div>
<div class="line"> <span class="keywordflow">return</span> (<a class="code" href="./namespace_m_h_w_render.html#ad970d5c990d4803d0e9d73c1ff4fda49a72361be679c1aca1c1be5f9b500a3315">MHWRender::kOpenGL</a> | <a name="a70"></a><a class="code" href="./namespace_m_h_w_render.html#ad970d5c990d4803d0e9d73c1ff4fda49a90bc0a1678af7ac4d1e62e2e954be4e5">MHWRender::kDirectX11</a> | <a name="a71"></a><a class="code" href="./namespace_m_h_w_render.html#ad970d5c990d4803d0e9d73c1ff4fda49aaebf48c70b63878eff38483392f19fb7">MHWRender::kOpenGLCoreProfile</a>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">float</span> RawFootPrintDrawOverride::getMultiplier(<span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; objPath)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line"> <span class="comment">// Retrieve value of the size attribute from the node</span></div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> status;</div>
<div class="line"> <a class="code" href="./class_m_object.html">MObject</a> rawfootprintNode = objPath.<a name="a72"></a><a class="code" href="./class_m_dag_path.html#ae024049dad815f2f186e6a4fead8be51">node</a>(&amp;status);</div>
<div class="line"> <span class="keywordflow">if</span> (status)</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="./class_m_plug.html">MPlug</a> plug(rawfootprintNode, rawfootPrint::size);</div>
<div class="line"> <span class="keywordflow">if</span> (!plug.isNull())</div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="./class_m_distance.html">MDistance</a> sizeVal;</div>
<div class="line"> <span class="keywordflow">if</span> (plug.getValue(sizeVal))</div>
<div class="line">            {</div>
<div class="line"> <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)sizeVal.<a class="code" href="./class_m_distance.html#ace39ab92685b0f5ab1a2925e748efb1f">asCentimeters</a>();</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> 1.0f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> RawFootPrintDrawOverride::isTransparentSort(<span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; objPath)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> status;</div>
<div class="line"> <a class="code" href="./class_m_object.html">MObject</a> rawfootprintNode = objPath.<a class="code" href="./class_m_dag_path.html#ae024049dad815f2f186e6a4fead8be51">node</a>(&amp;status);</div>
<div class="line"> <span class="keywordflow">if</span> (status)</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="./class_m_plug.html">MPlug</a> plug(rawfootprintNode, rawfootPrint::transparencySort);</div>
<div class="line"> <span class="keywordflow">if</span> (!plug.isNull())</div>
<div class="line">        {</div>
<div class="line"> <span class="keywordtype">bool</span> isTransparent;</div>
<div class="line"> <span class="keywordflow">if</span> (plug.getValue(isTransparent))</div>
<div class="line">            {</div>
<div class="line"> <span class="keywordflow">return</span> isTransparent;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">float</span> RawFootPrintDrawOverride::getTransparency(<span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; objPath)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line"> <span class="comment">// Retrieve value of the transparency attribute from the node</span></div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> status;</div>
<div class="line"> <a class="code" href="./class_m_object.html">MObject</a> rawfootprintNode = objPath.<a class="code" href="./class_m_dag_path.html#ae024049dad815f2f186e6a4fead8be51">node</a>(&amp;status);</div>
<div class="line"> <span class="keywordflow">if</span> (status)</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="./class_m_plug.html">MPlug</a> plug(rawfootprintNode, rawfootPrint::transparency);</div>
<div class="line"> <span class="keywordflow">if</span> (!plug.isNull())</div>
<div class="line">        {</div>
<div class="line"> <span class="keywordtype">float</span> transparencyVal;</div>
<div class="line"> <span class="keywordflow">if</span> (plug.getValue(transparencyVal))</div>
<div class="line">            {</div>
<div class="line"> <span class="keywordflow">return</span> transparencyVal;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> 1.0f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> RawFootPrintDrawOverride::isBounded(<span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; <span class="comment">/*objPath*/</span>,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; <span class="comment">/*cameraPath*/</span>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="./class_m_matrix.html">MMatrix</a> RawFootPrintDrawOverride::transform(</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; objPath,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; cameraPath)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line"> <span class="comment">// Update the transform matrix with the multiplier value,</span></div>
<div class="line"> <span class="comment">// this way, the matrices of the draw context will already contain the multiplier factor.</span></div>
<div class="line"> <span class="comment">// That way the WorldViewProjection uniform of the selection shader - which we do not have access to -</span></div>
<div class="line"> <span class="comment">// will be set properly.</span></div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_matrix.html">MMatrix</a> transform = objPath.<a name="a73"></a><a class="code" href="./class_m_dag_path.html#afb30f64680f5aa038da428a79579d08c">inclusiveMatrix</a>();</div>
<div class="line"> <span class="keywordtype">float</span> multiplier = getMultiplier(objPath);</div>
<div class="line"></div>
<div class="line">    transform[0][0] *= multiplier;</div>
<div class="line">    transform[1][1] *= multiplier;</div>
<div class="line">    transform[2][2] *= multiplier;</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> transform;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="./class_m_bounding_box.html">MBoundingBox</a> RawFootPrintDrawOverride::boundingBox(</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; objPath,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; cameraPath)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line"> <a class="code" href="./class_m_point.html">MPoint</a> corner1( -0.17, 0.0, -0.7 );</div>
<div class="line"> <a class="code" href="./class_m_point.html">MPoint</a> corner2( 0.17, 0.0, 0.3 );</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">float</span> multiplier = getMultiplier(objPath);</div>
<div class="line">    corner1 = corner1 * multiplier;</div>
<div class="line">    corner2 = corner2 * multiplier;</div>
<div class="line"></div>
<div class="line">    RawFootPrintDrawOverride *nonConstThis = (RawFootPrintDrawOverride *)<span class="keyword">this</span>;</div>
<div class="line">    nonConstThis-&gt;mCurrentBoundingBox.clear();</div>
<div class="line">    nonConstThis-&gt;mCurrentBoundingBox.expand( corner1 );</div>
<div class="line">    nonConstThis-&gt;mCurrentBoundingBox.expand( corner2 );</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> mCurrentBoundingBox;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> RawFootPrintDrawOverride::disableInternalBoundingBoxDraw()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line"> <span class="keywordflow">return</span> mCustomBoxDraw;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> RawFootPrintDrawOverride::excludedFromPostEffects()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line"> <span class="keywordflow">return</span> mExcludeFromPostEffects;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> RawFootPrintDrawOverride::isTransparent()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line"> <span class="keywordflow">return</span> mTransparencySort;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="./class_m_user_data.html">MUserData</a>* RawFootPrintDrawOverride::prepareForDraw(</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; objPath,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; cameraPath,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html">MHWRender::MFrameContext</a>&amp; frameContext,</div>
<div class="line"> <a class="code" href="./class_m_user_data.html">MUserData</a>* oldData)</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// We only care about post effects when in shaded mode</span></div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> displayStyle = frameContext.<a name="a74"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#acd5ce60bbd3d03181b1ad681023ff44d">getDisplayStyle</a>();</div>
<div class="line"> <span class="keywordtype">bool</span> shadedMode = (displayStyle &amp; <a name="a75"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aa620925ec70781a5f5de890d906660d24">MHWRender::MFrameContext::kGouraudShaded</a>) ||</div>
<div class="line">                      (displayStyle &amp; <a name="a76"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aa7914d385424ca72fdf84654b735a5a50">MHWRender::MFrameContext::kFlatShaded</a>);</div>
<div class="line"> <span class="keyword">static</span> <span class="keywordtype">bool</span> sExcludedFromPostEffects =</div>
<div class="line">        (getenv(<span class="stringliteral">"MAYA_RAWFOOTPRINT_EXCLUDEDFROMPOSTEFFECTS"</span>) != NULL);</div>
<div class="line">    mExcludeFromPostEffects = !shadedMode || sExcludedFromPostEffects;</div>
<div class="line"></div>
<div class="line">    mTransparencySort = isTransparentSort(objPath);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Retrieve data cache (create if does not exist)</span></div>
<div class="line">    RawFootPrintData* data = <span class="keyword">dynamic_cast&lt;</span>RawFootPrintData*<span class="keyword">&gt;</span>(oldData);</div>
<div class="line"> <span class="keywordflow">if</span> (!data)</div>
<div class="line">    {</div>
<div class="line">        data = <span class="keyword">new</span> RawFootPrintData();</div>
<div class="line">        data-&gt;mLastFrameStamp = 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// compute data and cache it</span></div>
<div class="line">    data-&gt;fMultiplier = getMultiplier(objPath);</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./namespace_m_h_w_render.html#ad9c34c5373567566950642c16a7c4bca">MHWRender::DisplayStatus</a> displayStatus =</div>
<div class="line"> <a name="a77"></a><a class="code" href="./class_m_h_w_render_1_1_m_geometry_utilities.html#aa2838b92c9f7db4a810690a986199134">MHWRender::MGeometryUtilities::displayStatus</a>(objPath);</div>
<div class="line"> <span class="keywordflow">if</span> ((displayStatus == <a name="a78"></a><a class="code" href="./namespace_m_h_w_render.html#ad9c34c5373567566950642c16a7c4bcaa1606a62e097fcfa55af6251a83b44243">MHWRender::kLead</a>) ||</div>
<div class="line">        (displayStatus == <a name="a79"></a><a class="code" href="./namespace_m_h_w_render.html#ad9c34c5373567566950642c16a7c4bcaab6a8784b4cf96692e0d71d19c44ce732">MHWRender::kActive</a>) ||</div>
<div class="line">        (displayStatus == <a name="a80"></a><a class="code" href="./namespace_m_h_w_render.html#ad9c34c5373567566950642c16a7c4bcaa88694d85749c9c85738c56c4912c385a">MHWRender::kHilite</a>) ||</div>
<div class="line">        (displayStatus == <a name="a81"></a><a class="code" href="./namespace_m_h_w_render.html#ad9c34c5373567566950642c16a7c4bcaa1d8e358d420ca7c9f6888faf51f4ec75">MHWRender::kActiveComponent</a>))</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="./class_m_color.html">MColor</a> color = <a name="a82"></a><a class="code" href="./class_m_h_w_render_1_1_m_geometry_utilities.html#a6221bc7407b14246b14f79a751496276">MHWRender::MGeometryUtilities::wireframeColor</a>(objPath);</div>
<div class="line">        data-&gt;fColor[0] = color.<a name="a83"></a><a class="code" href="./class_m_color.html#a4788d82c901b9367dd5c0daff8a7616b">r</a>;</div>
<div class="line">        data-&gt;fColor[1] = color.<a name="a84"></a><a class="code" href="./class_m_color.html#a8cf17d727651616de6f2b79ef32170cd">g</a>;</div>
<div class="line">        data-&gt;fColor[2] = color.<a name="a85"></a><a class="code" href="./class_m_color.html#a83fc1af92e29717b4513d121b0c72c7d">b</a>;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        data-&gt;fColor[0] = 0.6f;</div>
<div class="line">        data-&gt;fColor[1] = 0.6f;</div>
<div class="line">        data-&gt;fColor[2] = 0.6f;</div>
<div class="line">    }</div>
<div class="line">    data-&gt;fColor[3] = getTransparency(objPath);</div>
<div class="line"></div>
<div class="line">    data-&gt;fCustomBoxDraw = mCustomBoxDraw;</div>
<div class="line">    data-&gt;fCurrentBoundingBox = mCurrentBoundingBox;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Get the draw override information</span></div>
<div class="line">    data-&gt;fDrawOV = objPath.<a name="a86"></a><a class="code" href="./class_m_dag_path.html#aea0b55ce377063a108c3241885fc5c66">getDrawOverrideInfo</a>();</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Get a blend state override</span></div>
<div class="line"> <span class="keywordflow">if</span> (!mBlendState)</div>
<div class="line">    {</div>
<div class="line"> <a name="_a87"></a><a class="code" href="./class_m_h_w_render_1_1_m_blend_state_desc.html">MHWRender::MBlendStateDesc</a> blendStateDesc;</div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; (blendStateDesc.<a name="a88"></a><a class="code" href="./class_m_h_w_render_1_1_m_blend_state_desc.html#ab374ca375c42792265e69bb0a4123559">independentBlendEnable</a> ? <a name="a89"></a><a class="code" href="./class_m_h_w_render_1_1_m_blend_state.html#ab6b4785ac0e20c5947d74921bacc49b8">MHWRender::MBlendState::kMaxTargets</a> : 1); ++i)</div>
<div class="line">        {</div>
<div class="line">            blendStateDesc.<a name="a90"></a><a class="code" href="./class_m_h_w_render_1_1_m_blend_state_desc.html#ab6054509e76bc88d697a365e82c504c8">targetBlends</a>[i].<a name="a91"></a><a class="code" href="./class_m_h_w_render_1_1_m_target_blend_desc.html#af69e3282d64f8cfe88a2759960788417">blendEnable</a> = <span class="keyword">true</span>;</div>
<div class="line">            blendStateDesc.<a class="code" href="./class_m_h_w_render_1_1_m_blend_state_desc.html#ab6054509e76bc88d697a365e82c504c8">targetBlends</a>[i].<a name="a92"></a><a class="code" href="./class_m_h_w_render_1_1_m_target_blend_desc.html#a5c49c83334018fa4b2f69ac30b60d003">sourceBlend</a> = <a name="a93"></a><a class="code" href="./class_m_h_w_render_1_1_m_blend_state.html#acdb056fac09601eaa8b5f1b5df3ee4eaa76de73d01667fca98bcd3754f1f92c00">MHWRender::MBlendState::kSourceAlpha</a>;</div>
<div class="line">            blendStateDesc.<a class="code" href="./class_m_h_w_render_1_1_m_blend_state_desc.html#ab6054509e76bc88d697a365e82c504c8">targetBlends</a>[i].<a name="a94"></a><a class="code" href="./class_m_h_w_render_1_1_m_target_blend_desc.html#adadc1ea4b5fca51312ae451f346434e3">destinationBlend</a> = <a name="a95"></a><a class="code" href="./class_m_h_w_render_1_1_m_blend_state.html#acdb056fac09601eaa8b5f1b5df3ee4eaaa58d506c01416594f41c42e255dec594">MHWRender::MBlendState::kInvSourceAlpha</a>;</div>
<div class="line">            blendStateDesc.<a class="code" href="./class_m_h_w_render_1_1_m_blend_state_desc.html#ab6054509e76bc88d697a365e82c504c8">targetBlends</a>[i].<a name="a96"></a><a class="code" href="./class_m_h_w_render_1_1_m_target_blend_desc.html#a919cbb29a19a1fc79843f58e68ccad57">blendOperation</a> = <a name="a97"></a><a class="code" href="./class_m_h_w_render_1_1_m_blend_state.html#ad3316ff174eff6a45c45f0e90d84eabea8d20f6cca2d49a8732f535cfe28812c8">MHWRender::MBlendState::kAdd</a>;</div>
<div class="line">            blendStateDesc.<a class="code" href="./class_m_h_w_render_1_1_m_blend_state_desc.html#ab6054509e76bc88d697a365e82c504c8">targetBlends</a>[i].<a name="a98"></a><a class="code" href="./class_m_h_w_render_1_1_m_target_blend_desc.html#a9fbc968d46ad9a7107696211e34b4e51">alphaSourceBlend</a> = <a name="a99"></a><a class="code" href="./class_m_h_w_render_1_1_m_blend_state.html#acdb056fac09601eaa8b5f1b5df3ee4eaa567435a26feac1c98cd5213345ec6681">MHWRender::MBlendState::kOne</a>;</div>
<div class="line">            blendStateDesc.<a class="code" href="./class_m_h_w_render_1_1_m_blend_state_desc.html#ab6054509e76bc88d697a365e82c504c8">targetBlends</a>[i].<a name="a100"></a><a class="code" href="./class_m_h_w_render_1_1_m_target_blend_desc.html#aa0f38fbd90e3171cc6c092e80ff25c7c">alphaDestinationBlend</a> = <a class="code" href="./class_m_h_w_render_1_1_m_blend_state.html#acdb056fac09601eaa8b5f1b5df3ee4eaaa58d506c01416594f41c42e255dec594">MHWRender::MBlendState::kInvSourceAlpha</a>;</div>
<div class="line">            blendStateDesc.<a class="code" href="./class_m_h_w_render_1_1_m_blend_state_desc.html#ab6054509e76bc88d697a365e82c504c8">targetBlends</a>[i].<a name="a101"></a><a class="code" href="./class_m_h_w_render_1_1_m_target_blend_desc.html#a4d3de738732021fb87a82040e77f0aa4">alphaBlendOperation</a> = <a class="code" href="./class_m_h_w_render_1_1_m_blend_state.html#ad3316ff174eff6a45c45f0e90d84eabea8d20f6cca2d49a8732f535cfe28812c8">MHWRender::MBlendState::kAdd</a>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        blendStateDesc.<a name="a102"></a><a class="code" href="./class_m_h_w_render_1_1_m_blend_state_desc.html#a320c6d5843805b550f81726b07aa7f17">blendFactor</a>[0] = 1.0f;</div>
<div class="line">        blendStateDesc.<a class="code" href="./class_m_h_w_render_1_1_m_blend_state_desc.html#a320c6d5843805b550f81726b07aa7f17">blendFactor</a>[1] = 1.0f;</div>
<div class="line">        blendStateDesc.<a class="code" href="./class_m_h_w_render_1_1_m_blend_state_desc.html#a320c6d5843805b550f81726b07aa7f17">blendFactor</a>[2] = 1.0f;</div>
<div class="line">        blendStateDesc.<a class="code" href="./class_m_h_w_render_1_1_m_blend_state_desc.html#a320c6d5843805b550f81726b07aa7f17">blendFactor</a>[3] = 1.0f;</div>
<div class="line"></div>
<div class="line">        mBlendState = <a name="a103"></a><a class="code" href="./class_m_h_w_render_1_1_m_state_manager.html#aeb560f7829270f34ab413ad314314c8f">MHWRender::MStateManager::acquireBlendState</a>(blendStateDesc);</div>
<div class="line">    }</div>
<div class="line">    data-&gt;mBlendState = mBlendState;</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> data;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawOverride::addUIDrawables(</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_dag_path.html">MDagPath</a>&amp; objPath,</div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_u_i_draw_manager.html">MHWRender::MUIDrawManager</a>&amp; drawManager,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html">MHWRender::MFrameContext</a>&amp; frameContext,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_user_data.html">MUserData</a>* data)</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Draw a text "Foot"</span></div>
<div class="line"> <a class="code" href="./class_m_point.html">MPoint</a> pos( 0.0, 0.0, 0.0 ); <span class="comment">// Position of the text</span></div>
<div class="line"> <a class="code" href="./class_m_color.html">MColor</a> textColor( 0.1f, 0.8f, 0.8f, 1.0f ); <span class="comment">// Text color</span></div>
<div class="line"></div>
<div class="line">    drawManager.<a name="a104"></a><a class="code" href="./class_m_h_w_render_1_1_m_u_i_draw_manager.html#a9008ebfa63c02670625076230d77c3f9">beginDrawable</a>();</div>
<div class="line"></div>
<div class="line">    drawManager.<a name="a105"></a><a class="code" href="./class_m_h_w_render_1_1_m_u_i_draw_manager.html#a9baede3e37abe9551e50a8c6be65ec4d">setColor</a>( textColor );</div>
<div class="line">    drawManager.<a name="a106"></a><a class="code" href="./class_m_h_w_render_1_1_m_u_i_draw_manager.html#adfd0cfdd2cc781dba3987f64cb638a67">setFontSize</a>( <a name="a107"></a><a class="code" href="./class_m_h_w_render_1_1_m_u_i_draw_manager.html#a88cff078229df1c0803a690e4826b5f1a7218bb69173cb216cb619effff1055ea">MHWRender::MUIDrawManager::kSmallFontSize</a> );</div>
<div class="line">    drawManager.<a name="a108"></a><a class="code" href="./class_m_h_w_render_1_1_m_u_i_draw_manager.html#a334e4280e5ddd4653c69f9703b5dd3b4">text</a>( pos,  <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"rawFootprint"</span>), <a name="a109"></a><a class="code" href="./class_m_h_w_render_1_1_m_u_i_draw_manager.html#aa56f1a82069b5feeadbb4591cb3e474fae006401ce2987367501dd62b12f1396d">MHWRender::MUIDrawManager::kCenter</a> );</div>
<div class="line"></div>
<div class="line">    drawManager.<a name="a110"></a><a class="code" href="./class_m_h_w_render_1_1_m_u_i_draw_manager.html#a78c343c25a05be7e46dd4b7ebab82ff6">endDrawable</a>();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Sample code to debug camera information</span></div>
<div class="line"><span class="keywordtype">void</span> footPrint_DebugCameraInformation(<span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">bool</span> debugCameraInformation = <span class="keyword">false</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (debugCameraInformation)</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> status;</div>
<div class="line"> <a class="code" href="./class_m_bounding_box.html">MBoundingBox</a> frustum = context.<a name="a111"></a><a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#a6507cd42e5e18556f966088b0866fd0f">getFrustumBox</a>(&amp;status);</div>
<div class="line"> <a class="code" href="./class_m_point.html">MPoint</a> min = frustum.<a name="a112"></a><a class="code" href="./class_m_bounding_box.html#afb3213b98f3a6b4bda9759511e9b79a1">min</a>();</div>
<div class="line"> <a class="code" href="./class_m_point.html">MPoint</a> max = frustum.<a name="a113"></a><a class="code" href="./class_m_bounding_box.html#a1dfdbea9d5560e4aa09d34bdbd82480c">max</a>();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// 1. Query informaiton available from the draw context</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line">        printf(<span class="stringliteral">"Context Camera Info:\n"</span>);</div>
<div class="line">        printf(<span class="stringliteral">"====================\n"</span>);   </div>
<div class="line">        printf(<span class="stringliteral">"-- Frustum: W = %g, H = %g, D= %g. Min = %g,%g,%g. Max = %g,%g,%g\n"</span>, </div>
<div class="line">            frustum.<a name="a114"></a><a class="code" href="./class_m_bounding_box.html#a6cddcbf72c80144aa2e6501abb150c30">width</a>(), frustum.<a name="a115"></a><a class="code" href="./class_m_bounding_box.html#afa7750092d5dcf402c83fb5adba91453">height</a>(), frustum.<a name="a116"></a><a class="code" href="./class_m_bounding_box.html#a65c72a51aba9fc4233b58751dd712e43">depth</a>(), min[0], min[1], min[2],</div>
<div class="line">            max[0], max[1], max[2]);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Get depth range</span></div>
<div class="line"> <span class="keywordtype">float</span> nearV, farV;</div>
<div class="line">        context.<a name="a117"></a><a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#ae1bda403fc02486d936aadc56a90e395">getDepthRange</a>(nearV, farV);</div>
<div class="line">        printf(<span class="stringliteral">"-- Depth Range: near=%g, far=%g\n"</span>, nearV, farV);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Determine if view direction is along Z- (or Z+)</span></div>
<div class="line"> <span class="keywordtype">bool</span> alongNegZ = context.<a name="a118"></a><a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#a6913c6eda7d76d313d3ea1a8fab5318d">viewDirectionAlongNegZ</a>(&amp;status);</div>
<div class="line">        printf(<span class="stringliteral">"-- View direction = %s\n"</span>, alongNegZ ? <span class="stringliteral">"-Z"</span> : <span class="stringliteral">"+Z"</span>); </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Find out the camera coordinate system</span></div>
<div class="line"> <a name="_a119"></a><a class="code" href="./class_m_double_array.html">MDoubleArray</a> vPos = context.<a name="a120"></a><a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#a3a2746b602eb8dd543fa0a74497614d1">getTuple</a>(<a name="a121"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#af164f32d9bda6829f1738ef3fb2c6670aba1d4dab9b951b21263efade0a8f6729">MHWRender::MFrameContext::kViewPosition</a>);</div>
<div class="line">        printf(<span class="stringliteral">"-- View position = %g,%g,%g\n"</span>, vPos[0], vPos[1], vPos[2]);</div>
<div class="line"> <a class="code" href="./class_m_double_array.html">MDoubleArray</a> vDir = context.<a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#a3a2746b602eb8dd543fa0a74497614d1">getTuple</a>(<a name="a122"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#af164f32d9bda6829f1738ef3fb2c6670a227b592bc3c59e5855866b1d9f8c997b">MHWRender::MFrameContext::kViewDirection</a>);</div>
<div class="line">        printf(<span class="stringliteral">"-- View direction = %g,%g,%g\n"</span>, vDir [0], vDir [1], vDir [2]);</div>
<div class="line"> <a class="code" href="./class_m_double_array.html">MDoubleArray</a> vals = context.<a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#a3a2746b602eb8dd543fa0a74497614d1">getTuple</a>(<a name="a123"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#af164f32d9bda6829f1738ef3fb2c6670a46bdbff9d5db6921557766fcf9e4133f">MHWRender::MFrameContext::kViewUp</a>);</div>
<div class="line">        printf(<span class="stringliteral">"-- View up = %g,%g,%g\n"</span>, vals[0], vals[1], vals[2]);</div>
<div class="line">        vals = context.<a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#a3a2746b602eb8dd543fa0a74497614d1">getTuple</a>(<a name="a124"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#af164f32d9bda6829f1738ef3fb2c6670ae859394c6853c70c4000dc7a7a766bf1">MHWRender::MFrameContext::kViewRight</a>);</div>
<div class="line">        printf(<span class="stringliteral">"-- View right = %g,%g,%g\n"</span>, vals[0], vals[1], vals[2]);</div>
<div class="line"> <a class="code" href="./class_m_double_array.html">MDoubleArray</a> vNear = context.<a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#a3a2746b602eb8dd543fa0a74497614d1">getTuple</a>(<a name="a125"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#af164f32d9bda6829f1738ef3fb2c6670ab2b11196237108d7c893c6940cfe4b16">MHWRender::MFrameContext::kViewUnnormlizedNearClipValue</a>);</div>
<div class="line">        printf(<span class="stringliteral">"-- View near clip value = %g\n"</span>, vNear[0]);</div>
<div class="line"> <a class="code" href="./class_m_double_array.html">MDoubleArray</a> vFar = context.<a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#a3a2746b602eb8dd543fa0a74497614d1">getTuple</a>(<a name="a126"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#af164f32d9bda6829f1738ef3fb2c6670a973730135c8d1f08c5de00aa2997e914">MHWRender::MFrameContext::kViewUnnormalizedFarClipValue</a>);</div>
<div class="line">        printf(<span class="stringliteral">"-- View far clip value = %g\n"</span>, vFar[0]);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Compute the world space planes for the near and far clip planes</span></div>
<div class="line"> <span class="comment">// The near is pointing away from the camera and is thus point in the</span></div>
<div class="line"> <span class="comment">// negative direction while the far is point towards the camera (positive </span></div>
<div class="line"> <span class="comment">// direction.</span></div>
<div class="line"> <span class="keywordtype">double</span> distW = vPos[0]*vDir[0] + </div>
<div class="line">                    vPos[1]*vDir[1] + </div>
<div class="line">                    vPos[2]*vDir[2]; </div>
<div class="line"> <span class="comment">// Face near plane away from the camera</span></div>
<div class="line"> <span class="keywordtype">double</span> distNearW = -1.0 * (distW + vNear[0]); </div>
<div class="line">        printf(<span class="stringliteral">"-- World space near plane dist=%g. Dir=%g,%g,%g\n"</span>, distNearW,</div>
<div class="line">            vDir[0], vDir[1], vDir[2]);</div>
<div class="line"> <span class="comment">// Face far plane torwards the camera</span></div>
<div class="line"> <span class="keywordtype">double</span> distFarW = distW + vFar[0];</div>
<div class="line">        printf(<span class="stringliteral">"-- World space far plane dist=%g. Dir=%g,%g,%g\n"</span>, distFarW,</div>
<div class="line">            -vDir[0], -vDir[1], -vDir[2]);  </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// 2. Query the active Maya camera for information from the draw context</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <a class="code" href="./class_m_dag_path.html">MDagPath</a> cameraPath = context.<a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a7785aa5262ffc0200653a692b16fa608">getCurrentCameraPath</a>();</div>
<div class="line"> <a class="code" href="./class_m_fn_camera.html">MFnCamera</a> activeCamera(cameraPath);</div>
<div class="line"> <span class="keywordtype">int</span> uiX, uiY, uiWidth, uiHeight;</div>
<div class="line">        context.<a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#a7cd3b2dca6e4f8f4641b587bc642b08e">getViewportDimensions</a>(uiX, uiY, uiWidth, uiHeight);</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">double</span> windowAspect = (double)uiWidth / (<span class="keywordtype">double</span>)uiHeight;</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">double</span> left, bottom, right, top;</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> destinationName;</div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a4c4732853003d9156d368e44cbe552f9">MHWRender::MFrameContext::RenderingDestination</a> dest = context.<a name="a127"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a0df712533d76bdc96f2b49f4767ed85e">renderingDestination</a>(destinationName);</div>
<div class="line"> <span class="keywordtype">bool</span> viewportMode = (dest == <a name="a128"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a4c4732853003d9156d368e44cbe552f9a3549cf4609bdd691a990ade34855ea5e">MHWRender::MFrameContext::k3dViewport</a>);</div>
<div class="line"> <span class="comment">// If rendering mode ignore all the in viewport options</span></div>
<div class="line"> <span class="keywordflow">if</span> (!viewportMode)</div>
<div class="line">        {</div>
<div class="line">            activeCamera.getRenderingFrustum(windowAspect, left, right, bottom, top);</div>
<div class="line">        }</div>
<div class="line"> <span class="comment">// If viewport mode take into consideration overscan, and pan+zoom but not squeeze.</span></div>
<div class="line"> <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line"> <span class="keyword">static</span> <span class="keywordtype">bool</span> overscan = <span class="keyword">true</span>;</div>
<div class="line"> <span class="keyword">static</span> <span class="keywordtype">bool</span> squeeze = <span class="keyword">false</span>;</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">bool</span> panAndZoom = activeCamera.panZoomEnabled();</div>
<div class="line">            activeCamera.getViewingFrustum(windowAspect, left, right, bottom, top, overscan, squeeze, panAndZoom );</div>
<div class="line">        }</div>
<div class="line"> <span class="comment">// Relative near and far with respect to camera position.</span></div>
<div class="line"> <span class="comment">// Get the unnormalized value.</span></div>
<div class="line"> <span class="keywordtype">double</span> nearD = activeCamera.unnormalizedNearClippingPlane();</div>
<div class="line"> <span class="keywordtype">double</span> farD = activeCamera.unnormalizedFarClippingPlane();</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">"Camera Info:\n"</span>);</div>
<div class="line">        printf(<span class="stringliteral">"============\n"</span>);</div>
<div class="line">        printf(<span class="stringliteral">"-- Shape %s, Frustum: left=%g, bottom=%g, right=%g, top=%g near=%g, far=%g\n"</span>, </div>
<div class="line">            activeCamera.name().asChar(), left, bottom, right, top, nearD, farD);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Object space information</span></div>
<div class="line"> <a class="code" href="./class_m_point.html">MPoint</a> eyePoint = activeCamera.eyePoint();</div>
<div class="line"> <a name="_a129"></a><a class="code" href="./class_m_vector.html">MVector</a> viewDirection = activeCamera.viewDirection();</div>
<div class="line"> <a class="code" href="./class_m_vector.html">MVector</a> upDirection = activeCamera.upDirection();</div>
<div class="line"> <a class="code" href="./class_m_vector.html">MVector</a> rightDirection = activeCamera.rightDirection();</div>
<div class="line">        printf(<span class="stringliteral">"-- Object space values: eyePoint=%g,%g,%g. vdir=%g,%g,%g. vup=%g,%g,%g, vright=%g,%g,%g\n"</span>, </div>
<div class="line">            eyePoint[0], eyePoint[1], eyePoint[2],</div>
<div class="line">            viewDirection[0], viewDirection[1], viewDirection[2],</div>
<div class="line">            upDirection[0], upDirection[1], upDirection[2],</div>
<div class="line">            rightDirection[0], rightDirection[1], rightDirection[2]);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// World space information</span></div>
<div class="line"> <a class="code" href="./class_m_point.html">MPoint</a> eyePointW = activeCamera.eyePoint(<a name="a130"></a><a class="code" href="./class_m_space.html#ab11a1dda34491acff014ddfc9e6bafb8a45a60f04ac9114f0d6e865a6285f40b2">MSpace::kWorld</a>);</div>
<div class="line"> <a class="code" href="./class_m_vector.html">MVector</a> viewDirectionW = activeCamera.viewDirection(<a class="code" href="./class_m_space.html#ab11a1dda34491acff014ddfc9e6bafb8a45a60f04ac9114f0d6e865a6285f40b2">MSpace::kWorld</a>);</div>
<div class="line"> <a class="code" href="./class_m_vector.html">MVector</a> upDirectionW = activeCamera.upDirection(<a class="code" href="./class_m_space.html#ab11a1dda34491acff014ddfc9e6bafb8a45a60f04ac9114f0d6e865a6285f40b2">MSpace::kWorld</a>);</div>
<div class="line"> <a class="code" href="./class_m_vector.html">MVector</a> rightDirectionW = activeCamera.rightDirection(<a class="code" href="./class_m_space.html#ab11a1dda34491acff014ddfc9e6bafb8a45a60f04ac9114f0d6e865a6285f40b2">MSpace::kWorld</a>);</div>
<div class="line">        printf(<span class="stringliteral">"-- World space values: eyePoint=%g,%g,%g. vdir=%g,%g,%g. vup=%g,%g,%g, vright=%g,%g,%g\n"</span>, </div>
<div class="line">            eyePointW[0], eyePointW[1], eyePointW[2],</div>
<div class="line">            viewDirectionW[0], viewDirectionW[1], viewDirectionW[2],</div>
<div class="line">            upDirectionW[0], upDirectionW[1], upDirectionW[2],</div>
<div class="line">            rightDirectionW[0], rightDirectionW[1], rightDirectionW[2]);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Compute the world space planes for the near and far clip planes</span></div>
<div class="line"> <span class="comment">// The near is pointing away from the camera and is thus point in the</span></div>
<div class="line"> <span class="comment">// negative direction while the far is point towards the camera (positive </span></div>
<div class="line"> <span class="comment">// direction.</span></div>
<div class="line">        distW = eyePointW[0]*viewDirectionW[0] + </div>
<div class="line">            eyePointW[1]*viewDirectionW[1] + </div>
<div class="line">            eyePointW[2]*viewDirectionW[2]; </div>
<div class="line"> <span class="comment">// Face near plane away from the camera</span></div>
<div class="line">        distNearW = -1.0 * (distW + nearD); </div>
<div class="line">        printf(<span class="stringliteral">"-- World space near plane: Dir=%g,%g,%g. Dist=%g.\n"</span>, </div>
<div class="line">            viewDirectionW[0], viewDirectionW[1], viewDirectionW[2], distNearW);</div>
<div class="line"> <span class="comment">// Face far plane torwards the camera</span></div>
<div class="line">        distFarW = distW + farD;    </div>
<div class="line">        printf(<span class="stringliteral">"-- World space far plane: Dir=%g,%g,%g, Dist=%g. \n"</span>, </div>
<div class="line">            -viewDirectionW[0], -viewDirectionW[1], -viewDirectionW[2], distFarW);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// World space near and far clip points.</span></div>
<div class="line"> <a class="code" href="./class_m_point.html">MPoint</a> clipPts[4];</div>
<div class="line">        activeCamera.getFilmFrustum( -nearD, clipPts );</div>
<div class="line"> <a class="code" href="./class_m_matrix.html">MMatrix</a> icMat = cameraPath.<a class="code" href="./class_m_dag_path.html#afb30f64680f5aa038da428a79579d08c">inclusiveMatrix</a>();</div>
<div class="line"> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line"> <span class="keywordflow">for</span> ( i = 0; i &lt; 4; i ++ ) </div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="./class_m_point.html">MPoint</a> pt = clipPts[i] * icMat;</div>
<div class="line">            printf(<span class="stringliteral">"-- Near clip point[%d] = %g,%g,%g\n"</span>, i, pt[0], pt[1], pt[2]);</div>
<div class="line">        }</div>
<div class="line">        activeCamera.getFilmFrustum( -farD, clipPts );</div>
<div class="line"> <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; 4; i ++ ) </div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="./class_m_point.html">MPoint</a> pt = clipPts[i] * icMat;</div>
<div class="line">            printf(<span class="stringliteral">"-- Far clip point[%d] = %g,%g,%g\n"</span>, i, pt[0], pt[1], pt[2]);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">//  Sample code to debug object type exclusion</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">void</span> footPrint_DebugObjectTypeExclusions(<span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context)</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Sample code to determine object type exclusion</span></div>
<div class="line"> <span class="keywordtype">bool</span> debugTypeExclusions = <span class="keyword">false</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (debugTypeExclusions)</div>
<div class="line">    {</div>
<div class="line">        MUint64 excluded = </div>
<div class="line">            context.<a name="a131"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#ac261da38b7d3de4b388a98fd0b2a0b0a">objectTypeExclusions</a>();</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &gt; 0)</div>
<div class="line">        {</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a132"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#aa5b2f44180cea99fc3e9a8629b0c4d6a">MHWRender::MFrameContext::kExcludeNurbsCurves</a>)   <a name="a133"></a><a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude NURBS curves"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a134"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a661bf21087bbeabdf2dd427de9b68c2b">MHWRender::MFrameContext::kExcludeNurbsSurfaces</a>) <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude NURBS surface"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a135"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#ae96d5e7dbf99e6cfec3ddd2f3fa18073">MHWRender::MFrameContext::kExcludeMeshes</a>)        <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude polygonal meshes"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a136"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a2d57a764a2dd3bad812a763ee252cc75">MHWRender::MFrameContext::kExcludePlanes</a>)        <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude planes"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a137"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a6be6eccb50a49f2a7c92cf687e9ff6d0">MHWRender::MFrameContext::kExcludeLights</a>)        <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude lights"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a138"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a2265439f1faefdf8bf923c219f2624f0">MHWRender::MFrameContext::kExcludeCameras</a>)       <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude camera"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a139"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a5f4b7faab541fb9cbd9d22127074dabe">MHWRender::MFrameContext::kExcludeJoints</a>)        <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude joints"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a140"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#abb4356cd32d62cc3792ef93b3a91c5bf">MHWRender::MFrameContext::kExcludeIkHandles</a>)     <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude IK handles"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a141"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#ae33b4aa43f55270d0c71a445f30c1b7e">MHWRender::MFrameContext::kExcludeDeformers</a>)     <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude all deformations"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a142"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#adedf9629d861ec88a4fe1f2f6f5ab92a">MHWRender::MFrameContext::kExcludeDynamics</a>)      <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude all dynamics objects (emiiters, cloth)"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a143"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a9b13467c402b895800aa83b4a3adfc53">MHWRender::MFrameContext::kExcludeParticleInstancers</a>)    <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude all particle instancers"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a144"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a631efff94793222cefc921fae615d2e9">MHWRender::MFrameContext::kExcludeLocators</a>)      <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude locators"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a145"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a967528898bc4e0f010e11e364020d2e2">MHWRender::MFrameContext::kExcludeDimensions</a>)    <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude all measurement objects"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a146"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#adc2a4bc02f6bda24301d0b5b1424bb53">MHWRender::MFrameContext::kExcludeSelectHandles</a>) <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude selection handles"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a147"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#ad8b04fd81fabf2515cf3d51761d8f1ec">MHWRender::MFrameContext::kExcludePivots</a>)        <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude pivots"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a148"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#ae0e1b1b58e3460142235f67cd1316f79">MHWRender::MFrameContext::kExcludeTextures</a>)      <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude texure placement objects"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a149"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#ac952f34f07906371d0a7cf39a2b6e825">MHWRender::MFrameContext::kExcludeGrid</a>)          <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude grid drawing"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a150"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a770c98f88405bab8058d3e5ae6f43342">MHWRender::MFrameContext::kExcludeCVs</a>)           <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude NURBS control vertices"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a151"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#ae14ead64070852995e348dc4ed4c4de6">MHWRender::MFrameContext::kExcludeHulls</a>)         <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude NURBS hulls"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a152"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a935b7c436ae8bcd2d008d34f88a9c6db">MHWRender::MFrameContext::kExcludeStrokes</a>)       <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude PaintFX strokes"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a153"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#adf18dc2686a018049b1b9df761a71edc">MHWRender::MFrameContext::kExcludeSubdivSurfaces</a>) <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude subdivision surfaces"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a154"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1e98b44eb1e96485c94228b69163e618">MHWRender::MFrameContext::kExcludeFluids</a>)        <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude fluid objects"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a155"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a38c360cee5e043155077cfee2c8ee432">MHWRender::MFrameContext::kExcludeFollicles</a>)     <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude hair follicles"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a156"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a488c3706eb8be1b19b86d9e77af32997">MHWRender::MFrameContext::kExcludeHairSystems</a>)   <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude hair system"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a157"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#af6b2ecf5ee11bd057fa6853c65189af2">MHWRender::MFrameContext::kExcludeImagePlane</a>)    <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude image planes"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a158"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#ab02ded8ddcafbb2322a0bc84c550cad6">MHWRender::MFrameContext::kExcludeNCloths</a>)       <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude N-cloth objects"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a159"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a4ddbe516885981033dea40fa975d641d">MHWRender::MFrameContext::kExcludeNRigids</a>)       <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude rigid-body objects"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a160"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a6b7c2852337fbfc59a6ef537d148ae55">MHWRender::MFrameContext::kExcludeDynamicConstraints</a>)    <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude rigid-body constraints"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a161"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a01ff39f9f38157c7acae37e62028b5af">MHWRender::MFrameContext::kExcludeManipulators</a>)  <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude manipulators"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a162"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a53d26c88d652d9018e01674563fd3694">MHWRender::MFrameContext::kExcludeNParticles</a>)    <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude N-particle objects"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a163"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#abe4ec3f6c7c9d26b32b060050595a4d0">MHWRender::MFrameContext::kExcludeMotionTrails</a>)  <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude motion trails"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a164"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a6c7cc9d8563c08d856412af6c866c8c7">MHWRender::MFrameContext::kExcludeHoldOuts</a>)      <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude hold-outs"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a165"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#ad7bdabe5ece97e23d82287005e91e2fb">MHWRender::MFrameContext::kExcludePluginShapes</a>)  <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude plug-in shapes"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a166"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a19e5b2fee997e6804502d1e45887530c">MHWRender::MFrameContext::kExcludeHUD</a>)           <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude HUD"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a167"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a832f6df0d8de787303036322a9d140dc">MHWRender::MFrameContext::kExcludeClipGhosts</a>)    <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude animation clip ghosts"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a168"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a11ec30d814c696a5c4c3565b7a2fe52d">MHWRender::MFrameContext::kExcludeGreasePencils</a>) <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude grease pencil drawing"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (excluded &amp; <a name="a169"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a36d333ac930b95c6d0009366d438a279">MHWRender::MFrameContext::kExcludeControllers</a>)   <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Exclude controllers objects"</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Sample code to determine classification type exclusion</span></div>
<div class="line"> <span class="keywordtype">bool</span> debugClassificationExclusions = <span class="keyword">false</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (debugClassificationExclusions )</div>
<div class="line">    {</div>
<div class="line"> <a name="_a170"></a><a class="code" href="./class_m_string_array.html">MStringArray</a> classifications;</div>
<div class="line">        context.<a name="a171"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a53dcd8befa544040b1c48808fdfae27b">classificationExclusions</a>( classifications );</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> info(<span class="stringliteral">"Classification strings excluded: "</span>);</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;classifications.<a name="a172"></a><a class="code" href="./class_m_string_array.html#a580388f31f60c46fac867ca48a48da1e">length</a>(); i++)</div>
<div class="line">        {</div>
<div class="line">            info += classifications[i];</div>
<div class="line">            info += <span class="stringliteral">";"</span>;</div>
<div class="line">        }</div>
<div class="line"> <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>( info );</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Sample code to debug background parameters</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">void</span> footPrint_DebugBackground(<span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">bool</span> debugBackground = <span class="keyword">false</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (debugBackground)</div>
<div class="line">    {</div>
<div class="line"> <a name="_a173"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_background_params.html">MHWRender::MFrameContext::BackgroundParams</a> backParams;</div>
<div class="line">        context.<a name="a174"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a884cc89835076a7b836b86538c01e722">getBackgroundParameters</a>(backParams);</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> info(<span class="stringliteral">"Display Gradient: "</span>); info += backParams.<a name="a175"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_background_params.html#a127ce7706df392d9cb498e03768fbaf5">displayGradient</a>; <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(info);</div>
<div class="line">        info = <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"Clear color bit: "</span>); info += backParams.<a name="a176"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_background_params.html#a01ce816fb45a354a86a31b053332707e">clearColorFlag</a>; <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(info);</div>
<div class="line">        info = <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"Clear depth bit: "</span>); info += backParams.<a name="a177"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_background_params.html#af9100c06665ebc59126c19e6703bf821">clearDepthFlag</a>; <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(info);</div>
<div class="line">        info = <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"Clear stencil bit: "</span>); info += backParams.<a name="a178"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_background_params.html#a50b68b504399f3ce873183a6fd368955">clearStencilFlag</a>; <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(info);</div>
<div class="line">        info = <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"Clear color: "</span>); </div>
<div class="line">        info += backParams.<a name="a179"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_background_params.html#a80b1e198f586619d844fff6bb4cc4679">clearColor1</a>[0]; info += <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">","</span>);</div>
<div class="line">        info += backParams.<a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_background_params.html#a80b1e198f586619d844fff6bb4cc4679">clearColor1</a>[1]; info += <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">","</span>);</div>
<div class="line">        info += backParams.<a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_background_params.html#a80b1e198f586619d844fff6bb4cc4679">clearColor1</a>[2]; info += <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">","</span>);</div>
<div class="line">        info += backParams.<a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_background_params.html#a80b1e198f586619d844fff6bb4cc4679">clearColor1</a>[3]; </div>
<div class="line"> <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(info);</div>
<div class="line">        info = <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"Clear color 2: "</span>); </div>
<div class="line">        info += backParams.<a name="a180"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_background_params.html#a51a529fc62d83747bb1b7f1ed04ff22e">clearColor2</a>[0]; info += <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">","</span>);</div>
<div class="line">        info += backParams.<a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_background_params.html#a51a529fc62d83747bb1b7f1ed04ff22e">clearColor2</a>[1]; info += <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">","</span>);</div>
<div class="line">        info += backParams.<a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_background_params.html#a51a529fc62d83747bb1b7f1ed04ff22e">clearColor2</a>[2]; info += <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">","</span>);</div>
<div class="line">        info += backParams.<a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_background_params.html#a51a529fc62d83747bb1b7f1ed04ff22e">clearColor2</a>[3]; </div>
<div class="line"> <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(info);</div>
<div class="line">        info = <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"Clear depth value: "</span>); info += backParams.<a name="a181"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_background_params.html#a08244f814f06c8716897536d8386e4cd">clearDepthValue</a>; <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(info);</div>
<div class="line">        info = <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"Clear stencil value: "</span>); info += backParams.<a name="a182"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_background_params.html#a2cb70220d3d1dcd8f01ad0650d32ea30">clearStencilValue</a>; <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(info);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Sample code to debug post effect information</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">void</span> footPrint_DebugPostEffects(<span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">bool</span> debugPostEffects = <span class="keyword">false</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (debugPostEffects)</div>
<div class="line">    {</div>
<div class="line"> <span class="keywordflow">if</span> (context.<a name="a183"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1f7de24693b8d7be24a0624f9b970983">getPostEffectEnabled</a>( <a name="a184"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#aed6597b6ca26d0c599d1d9a004442e21ad1489eaf62f989ec0fb25acf68bedfe0">MHWRender::MFrameContext::kAmbientOcclusion</a> ))</div>
<div class="line"> <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"SSAO enabled"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (context.<a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1f7de24693b8d7be24a0624f9b970983">getPostEffectEnabled</a>( <a name="a185"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#aed6597b6ca26d0c599d1d9a004442e21aaf082eeacce9a2ee38f421f3f5cdc50c">MHWRender::MFrameContext::kMotionBlur</a> ))</div>
<div class="line"> <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Motion blur enabled"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (context.<a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1f7de24693b8d7be24a0624f9b970983">getPostEffectEnabled</a>( <a name="a186"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#aed6597b6ca26d0c599d1d9a004442e21a9f7ec2595ebbeea1cbec76e4b0534537">MHWRender::MFrameContext::kViewColorTransformEnabled</a> ))</div>
<div class="line"> <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Color management enabled"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (context.<a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1f7de24693b8d7be24a0624f9b970983">getPostEffectEnabled</a>( <a name="a187"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#aed6597b6ca26d0c599d1d9a004442e21a12a6c9c6d81719d67d63412fe85aaffb">MHWRender::MFrameContext::kDepthOfField</a> ))</div>
<div class="line">        {</div>
<div class="line"> <a name="_a188"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_d_o_f_params.html">MHWRender::MFrameContext::DOFParams</a> dofParams;</div>
<div class="line">            context.<a name="a189"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#adc3c931b5b8b55549af38d1b3288ed91">getDOFParameters</a>(dofParams);</div>
<div class="line"> <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Depth-of-field enabled:"</span>);</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> info(<span class="stringliteral">"- Focus distance: "</span>); info += dofParams.<a name="a190"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_d_o_f_params.html#a57f00d353f941a588ca5edb1f9a4f8cd">focalDistance</a>; <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(info);</div>
<div class="line">            info = <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"- Alpha: "</span>); info += dofParams.<a name="a191"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_d_o_f_params.html#ab1551d8043c2aa4410fb7dbb1fe3be7b">alpha</a>; <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(info);</div>
<div class="line"></div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">if</span> (context.<a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1f7de24693b8d7be24a0624f9b970983">getPostEffectEnabled</a>( <a name="a192"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#aed6597b6ca26d0c599d1d9a004442e21aafe2e2c0bbb8da0d1e70a0ab0b4b5576">MHWRender::MFrameContext::kAntiAliasing</a> ))</div>
<div class="line"> <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Anti-aliasing enabled"</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Sample code to debug render destination</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">void</span> footPrint_DebugDestination(<span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context)</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Sample code to determine the rendering destination</span></div>
<div class="line"> <span class="keywordtype">bool</span> debugDestination = <span class="keyword">false</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (debugDestination)</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> destinationIdentifier;</div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a4c4732853003d9156d368e44cbe552f9">MHWRender::MFrameContext::RenderingDestination</a> dest = context.<a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a0df712533d76bdc96f2b49f4767ed85e">renderingDestination</a>(destinationIdentifier);</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> destinationType = <span class="stringliteral">" 3d viewport"</span>;</div>
<div class="line"> <span class="keywordtype">bool</span> found3dView = <span class="keyword">false</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (dest == <a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a4c4732853003d9156d368e44cbe552f9a3549cf4609bdd691a990ade34855ea5e">MHWRender::MFrameContext::k3dViewport</a>)</div>
<div class="line">        {</div>
<div class="line"> <a name="_a193"></a><a class="code" href="./class_m3d_view.html">M3dView</a> view;</div>
<div class="line"> <span class="keywordflow">if</span> (<a name="a194"></a><a class="code" href="./class_m3d_view.html#a6f8dcac6993b14738fc6259cfd50a3b8">M3dView::getM3dViewFromModelPanel</a>(destinationIdentifier, view) == <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MStatus::kSuccess</a>)</div>
<div class="line">            {</div>
<div class="line">                found3dView = <span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dest == <a name="a195"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a4c4732853003d9156d368e44cbe552f9a6f4723549117a9e163b5656977b57c5a">MHWRender::MFrameContext::k2dViewport</a>)</div>
<div class="line">            destinationType = <span class="stringliteral">" 2d viewport"</span>;</div>
<div class="line"> <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dest == <a name="a196"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a4c4732853003d9156d368e44cbe552f9a9df07847c20cd540354c92617d62ee38">MHWRender::MFrameContext::kImage</a>)</div>
<div class="line">            destinationType = <span class="stringliteral">"n image"</span>;</div>
<div class="line">        printf(<span class="stringliteral">"rawfootprint node render destination is a%s. Destination name=%s. Found M3dView=%d\n"</span>, </div>
<div class="line">            destinationType.<a class="code" href="./class_m_string.html#aa9ab612f356c53479afc4c648c9ef94d">asChar</a>(), destinationIdentifier.<a class="code" href="./class_m_string.html#aa9ab612f356c53479afc4c648c9ef94d">asChar</a>(), found3dView);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Sample code to debug render override</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">void</span> footPrint_DebugRenderOverride(<span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">bool</span> debugRenderOverride = <span class="keyword">false</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (debugRenderOverride)</div>
<div class="line">    {</div>
<div class="line"> <a name="_a197"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_render_override_information.html">MHWRender::MFrameContext::RenderOverrideInformation</a> overrideInfo;</div>
<div class="line">        context.<a name="a198"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#aed7789770ef0eb47fd196edfc669d8f6">getRenderOverrideInformation</a>(overrideInfo);</div>
<div class="line"> <span class="keywordflow">if</span> (overrideInfo.<a name="a199"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_render_override_information.html#a7d246d5345a44680468aa6cae4cfc648">overrideName</a>.<a name="a200"></a><a class="code" href="./class_m_string.html#a580388f31f60c46fac867ca48a48da1e">length</a>())</div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> info(<span class="stringliteral">"Render Override: "</span>); info += overrideInfo.<a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_render_override_information.html#a7d246d5345a44680468aa6cae4cfc648">overrideName</a>; <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(info);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}   </div>
<div class="line"></div>
<div class="line"><span class="comment">// Sample code to debug display style</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">void</span> footPrint_DebugDisplayStyle(<span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context,</div>
<div class="line"> <span class="keyword">const</span> RawFootPrintData* footData)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">bool</span> debugDisplayStyle = <span class="keyword">false</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (debugDisplayStyle)</div>
<div class="line">    {</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> displayStyle = context.<a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#acd5ce60bbd3d03181b1ad681023ff44d">getDisplayStyle</a>();</div>
<div class="line"> <span class="keywordtype">bool</span> drawAsBoundingbox =</div>
<div class="line">            (displayStyle &amp; <a name="a201"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aa74c3784e844e54dab272e794fa6bcaa9">MHWRender::MFrameContext::kBoundingBox</a>) ||</div>
<div class="line">            (footData-&gt;fDrawOV.fLOD == <a name="a202"></a><a class="code" href="./class_m_d_a_g_draw_override_info.html#a750085d0d3a9a6a2888fdc87478cd01da95d9908c6f0be5e5025f119b9cca0a96">MDAGDrawOverrideInfo::kLODBoundingBox</a>);</div>
<div class="line"> <span class="keywordflow">if</span> (drawAsBoundingbox) <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Bbox display style on"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (displayStyle &amp; <a name="a203"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aa53c5241bb4e72f6c9547de918125d068">MHWRender::MFrameContext::kWireFrame</a>) <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Wireframe display style on"</span>);</div>
<div class="line"> <span class="keywordtype">bool</span> drawShaded = ((displayStyle &amp; <a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aa620925ec70781a5f5de890d906660d24">MHWRender::MFrameContext::kGouraudShaded</a>) ||</div>
<div class="line">                          (displayStyle &amp; MHWRender::MFrameContext::kFlatShaded));</div>
<div class="line"> <span class="keywordflow">if</span> (drawShaded) <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Shaded display style on"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (displayStyle &amp; <a name="a204"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aa17e882561d8db0dedc215d0d4978e887">MHWRender::MFrameContext::kTextured</a>) <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Textured display style on"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (displayStyle &amp; <a name="a205"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aac0e52a169c76e2d1747f043a2eb4838f">MHWRender::MFrameContext::kDefaultMaterial</a>) <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Use default material display style on"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (displayStyle &amp; <a name="a206"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aa99437964e7d704b69731888dcba2fe94">MHWRender::MFrameContext::kXrayJoint</a>) <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"X-ray joint display style on"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (displayStyle &amp; <a name="a207"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aa46c4787c817c63725de629dbb7cc74bd">MHWRender::MFrameContext::kXray</a>) <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"X-ray display style on"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (displayStyle &amp; <a name="a208"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aac8c533b01e236ad5b27f023374ec7027">MHWRender::MFrameContext::kTwoSidedLighting</a>) <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Two-sided lighting display style on"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (displayStyle &amp; MHWRender::MFrameContext::kFlatShaded) <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Flat shaded display style on"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (displayStyle &amp; <a name="a209"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aaafc1312afe4b53aa0b4a0b818c377bfc">MHWRender::MFrameContext::kShadeActiveOnly</a>) <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Shaded active display style on"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (displayStyle &amp; <a name="a210"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aaab3091414a40736866381fd46d9a1e0a">MHWRender::MFrameContext::kXrayActiveComponents</a>) <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"X-ray active component display style on"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (displayStyle &amp; <a name="a211"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aa8d96c94c9b833bae178635ba699dc2ee">MHWRender::MFrameContext::kBackfaceCulling</a>) <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Backface culling display style on"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (displayStyle &amp; <a name="a212"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aa9a962e9185fe5bb3b7a2a0751a3fe5ba">MHWRender::MFrameContext::kSmoothWireframe</a>) <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"Smooth wireframe display style on"</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Sample code to debug fog parameters</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">void</span> footPrint_DebugFogStatus(<span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">bool</span> debugFogStatus = <span class="keyword">false</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (debugFogStatus)</div>
<div class="line">    {</div>
<div class="line"> <a name="_a213"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_hw_fog_params.html">MHWRender::MFrameContext::HwFogParams</a> params = context.<a name="a214"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#aa4e74730699e09cec07f3b59fd2679e8">getHwFogParameters</a>();</div>
<div class="line"> <span class="keywordflow">if</span> (params.<a name="a215"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_hw_fog_params.html#ae127077f7a1eda466f6837a3a1dc8277">HwFogEnabled</a>)</div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"Fog mode = "</span>) + params.<a name="a216"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_hw_fog_params.html#aa283269f91a1d2ddac0f0af5a485ff39">HwFogMode</a>);</div>
<div class="line"> <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"Fog start = "</span>) + params.<a name="a217"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_hw_fog_params.html#aab8b5ae43dd8979294e7a9e933be5934">HwFogStart</a>);</div>
<div class="line"> <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"Fog end = "</span>) + params.<a name="a218"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_hw_fog_params.html#a2080b4810338eb92be71796f16e547d5">HwFogEnd</a>);</div>
<div class="line"> <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"Fog density = "</span>) + params.<a name="a219"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_hw_fog_params.html#ab98580d56f9bccc16b7ab408055774e3">HwFogDensity</a>);</div>
<div class="line"> <a class="code" href="./class_m_color.html">MColor</a> col = params.<a name="a220"></a><a class="code" href="./struct_m_h_w_render_1_1_m_frame_context_1_1_hw_fog_params.html#a145d982480d906036f1de9abd0eb6333">HwFogColor</a>;</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> info(<span class="stringliteral">"Fog color = "</span>);</div>
<div class="line">            info += col[0]; info += <span class="stringliteral">","</span>;</div>
<div class="line">            info += col[1]; info += <span class="stringliteral">","</span>;</div>
<div class="line">            info += col[2]; info += <span class="stringliteral">","</span>;</div>
<div class="line">            info += col[3]; </div>
<div class="line"> <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(info);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Sample code to debug print out pass information</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">void</span> footPrint_DebugPassInformation(<span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context)</div>
<div class="line">{</div>
<div class="line"> <span class="keyword">static</span> <span class="keywordtype">bool</span> debugPassInformation = <span class="keyword">false</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (debugPassInformation)</div>
<div class="line">    {</div>
<div class="line"> <span class="keyword">const</span> <a name="_a221"></a><a class="code" href="./class_m_h_w_render_1_1_m_pass_context.html">MHWRender::MPassContext</a> &amp; passCtx = context.<a name="a222"></a><a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#ad3f9422688a9ffbe815c374ece46c1ea">getPassContext</a>();</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_string_array.html">MStringArray</a> &amp; passSem = passCtx.<a name="a223"></a><a class="code" href="./class_m_h_w_render_1_1_m_pass_context.html#a9737189d5cfffd795336d711a678d627">passSemantics</a>();</div>
<div class="line"></div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_string.html">MString</a> &amp; passId = passCtx.<a name="a224"></a><a class="code" href="./class_m_h_w_render_1_1_m_pass_context.html#ae90d4b4c8175e81800d8eb16ee126e1f">passIdentifier</a>();</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> info(<span class="stringliteral">"rawfootprint node drawing in pass["</span>); </div>
<div class="line">        info += passId.<a class="code" href="./class_m_string.html#aa9ab612f356c53479afc4c648c9ef94d">asChar</a>(); info += <span class="stringliteral">"]"</span>;</div>
<div class="line"> <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(info);</div>
<div class="line"> <span class="keywordflow">if</span> (passSem.<a class="code" href="./class_m_string_array.html#a580388f31f60c46fac867ca48a48da1e">length</a>()) </div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> info(<span class="stringliteral">"--- semantics["</span>);</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;passSem.<a class="code" href="./class_m_string_array.html#a580388f31f60c46fac867ca48a48da1e">length</a>(); i++)</div>
<div class="line">            {</div>
<div class="line">                info += <span class="stringliteral">" "</span>;</div>
<div class="line">                info += passSem[i].asChar();</div>
<div class="line">            }</div>
<div class="line">            info += <span class="stringliteral">"]"</span>;</div>
<div class="line"> <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(info);</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">if</span> (passCtx.<a name="a225"></a><a class="code" href="./class_m_h_w_render_1_1_m_pass_context.html#a54cb1ff5e4a10ffc51cb05ddab8e69ab">hasShaderOverride</a>()) </div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html">MHWRender::MShaderInstance</a>* passShaderOverride = </div>
<div class="line">                    passCtx.<a name="a226"></a><a class="code" href="./class_m_h_w_render_1_1_m_pass_context.html#aef8d7620ddd58e44e45ea0f0dfaa6fb4">shaderOverrideInstance</a>();</div>
<div class="line"> <span class="keywordflow">if</span> (passShaderOverride) {</div>
<div class="line"> <a class="code" href="./class_m_global.html#a3d14e9f9ed022a80f664eac0136c2f7a">MGlobal::displayInfo</a>(<span class="stringliteral">"--- use internal shaderOverride"</span>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Main drawing routine</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">void</span> RawFootPrintDrawOverride::drawImpl(</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html">MHWRender::MDrawContext</a>&amp; context,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_selection_info.html">MHWRender::MSelectionInfo</a>* selectInfo,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_user_data.html">MUserData</a>* data)</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Get renderer</span></div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_renderer.html">MHWRender::MRenderer</a>* theRenderer = <a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#a4678a72ac6959ed21d422d27928d0343">MHWRender::MRenderer::theRenderer</a>();</div>
<div class="line"> <span class="keywordflow">if</span> (!theRenderer)</div>
<div class="line">    {</div>
<div class="line"> <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Get user draw data</span></div>
<div class="line"> <span class="keyword">const</span> RawFootPrintData* footData = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>RawFootPrintData*<span class="keyword">&gt;</span>(data);</div>
<div class="line"> <span class="keywordflow">if</span> (!footData)</div>
<div class="line">    {</div>
<div class="line"> <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Debug code to trace frame stamp numbering</span></div>
<div class="line"> <span class="keyword">static</span> <span class="keywordtype">bool</span> traceFrameStamp = <span class="keyword">false</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (traceFrameStamp)</div>
<div class="line">    {</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_pass_context.html">MHWRender::MPassContext</a> &amp; passCtx = context.<a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#ad3f9422688a9ffbe815c374ece46c1ea">getPassContext</a>();</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_string_array.html">MStringArray</a> &amp; passSem = passCtx.<a class="code" href="./class_m_h_w_render_1_1_m_pass_context.html#a9737189d5cfffd795336d711a678d627">passSemantics</a>();</div>
<div class="line">        MUint64 currentFrameStamp = context.<a name="a227"></a><a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#ac9d36cff81e99e1fb66d9e162b97ecfb">getFrameStamp</a>();</div>
<div class="line"> <span class="keywordflow">if</span> (currentFrameStamp != footData-&gt;mLastFrameStamp)</div>
<div class="line">        {</div>
<div class="line"> <span class="keywordtype">bool</span> updateColorPassFrameStamp = <span class="keyword">true</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (passSem.<a class="code" href="./class_m_string_array.html#a580388f31f60c46fac867ca48a48da1e">length</a>() == 1 &amp;&amp; </div>
<div class="line">                (passSem[0] == <a name="a228"></a><a class="code" href="./class_m_h_w_render_1_1_m_pass_context.html#a728fc00f0764227a6f345c089058c998">MHWRender::MPassContext::kSelectionPassSemantic</a> ||</div>
<div class="line">                passSem[0] == <a name="a229"></a><a class="code" href="./class_m_h_w_render_1_1_m_pass_context.html#ab0d481f367db0fa41c2b3a1aeb2074c8">MHWRender::MPassContext::kShadowPassSemantic</a>))</div>
<div class="line">            {</div>
<div class="line">                updateColorPassFrameStamp = <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line"> <span class="keywordflow">if</span> (updateColorPassFrameStamp)</div>
<div class="line">            {</div>
<div class="line">                printf(<span class="stringliteral">"RawFootPrintDrawOverride: frame stamp change from %ld to %ld\n"</span>,                    </div>
<div class="line">                    (<span class="keywordtype">long</span>)footData-&gt;mLastFrameStamp, (<span class="keywordtype">long</span>)currentFrameStamp);</div>
<div class="line">            }</div>
<div class="line">            ((RawFootPrintData*)footData)-&gt;mLastFrameStamp = currentFrameStamp;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Get DAG object draw override</span></div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_d_a_g_draw_override_info.html">MDAGDrawOverrideInfo</a>&amp; objectOverrideInfo = footData-&gt;fDrawOV;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Just return and draw nothing, if it is overridden invisible</span></div>
<div class="line"> <span class="keywordflow">if</span> ( objectOverrideInfo.<a name="a230"></a>fOverrideEnabled &amp;&amp; !objectOverrideInfo.<a name="a231"></a>fEnableVisible )</div>
<div class="line">    {</div>
<div class="line"> <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// If in playback but hidden in playback, skip drawing</span></div>
<div class="line"> <span class="keywordtype">bool</span> animPlay = <a name="a232"></a><a class="code" href="./class_m_anim_control.html#a8438e3403946accc1986a05b89ee7b03">MAnimControl::isPlaying</a>();</div>
<div class="line"> <span class="keywordtype">bool</span> animScrub = <a name="a233"></a><a class="code" href="./class_m_anim_control.html#a8d1e3f6d61a15ff72695396e9d36ae57">MAnimControl::isScrubbing</a>();</div>
<div class="line"> <span class="keywordflow">if</span> (!objectOverrideInfo.<a name="a234"></a>fPlaybackVisible &amp;&amp;</div>
<div class="line">        (animPlay || animScrub))</div>
<div class="line">    {</div>
<div class="line"> <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Optional debugging utility calls</span></div>
<div class="line">    footPrint_DebugCameraInformation(context);</div>
<div class="line">    footPrint_DebugObjectTypeExclusions(context);</div>
<div class="line">    footPrint_DebugBackground(context);</div>
<div class="line">    footPrint_DebugPostEffects(context);    </div>
<div class="line">    footPrint_DebugDestination(context);    </div>
<div class="line">    footPrint_DebugRenderOverride(context);</div>
<div class="line">    footPrint_DebugDisplayStyle(context, footData);</div>
<div class="line">    footPrint_DebugFogStatus(context);</div>
<div class="line">    footPrint_DebugPassInformation(context);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Check display styles to determine what modes to draw with</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> displayStyle = context.<a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#acd5ce60bbd3d03181b1ad681023ff44d">getDisplayStyle</a>();</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">bool</span> drawAsBoundingbox =</div>
<div class="line">        (displayStyle &amp; <a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aa74c3784e844e54dab272e794fa6bcaa9">MHWRender::MFrameContext::kBoundingBox</a>) ||</div>
<div class="line">        (footData-&gt;fDrawOV.fLOD == <a class="code" href="./class_m_d_a_g_draw_override_info.html#a750085d0d3a9a6a2888fdc87478cd01da95d9908c6f0be5e5025f119b9cca0a96">MDAGDrawOverrideInfo::kLODBoundingBox</a>);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Require shadeded draw</span></div>
<div class="line"> <span class="keywordtype">bool</span> drawShaded = ((displayStyle &amp; <a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aa620925ec70781a5f5de890d906660d24">MHWRender::MFrameContext::kGouraudShaded</a>) ||</div>
<div class="line">                      (displayStyle &amp; MHWRender::MFrameContext::kFlatShaded));</div>
<div class="line"> <span class="comment">// Require wireframe draw</span></div>
<div class="line"> <span class="keywordtype">bool</span> drawWireframe = (displayStyle &amp; <a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aa53c5241bb4e72f6c9547de918125d068">MHWRender::MFrameContext::kWireFrame</a>) &gt; 0;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Templated, only draw wirefame and it is not selectale</span></div>
<div class="line"> <span class="keywordtype">bool</span> overideTemplated = objectOverrideInfo.fOverrideEnabled &amp;&amp;</div>
<div class="line">        (objectOverrideInfo.<a name="a235"></a>fDisplayType == <a name="a236"></a><a class="code" href="./class_m_d_a_g_draw_override_info.html#ab422481bee446a6af09c5436925cd1cca9387ad37dc26db18a135740b8b0aa2f4">MDAGDrawOverrideInfo::kDisplayTypeTemplate</a>);</div>
<div class="line"> <span class="keywordflow">if</span> (overideTemplated)</div>
<div class="line">    {</div>
<div class="line">        drawWireframe = <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Override no shaded, only show wireframe</span></div>
<div class="line"> <span class="keywordtype">bool</span> overrideNoShaded = objectOverrideInfo.fOverrideEnabled &amp;&amp; !objectOverrideInfo.<a name="a237"></a>fEnableShading;</div>
<div class="line"> <span class="keywordflow">if</span> (overideTemplated || overrideNoShaded)</div>
<div class="line">    {</div>
<div class="line">        drawShaded = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// If we don't want to draw the bounds within this plugin</span></div>
<div class="line"> <span class="comment">// manually, then skip drawing altogether in bounding box mode</span></div>
<div class="line"> <span class="comment">// since the bounds draw is handled by the renderer and</span></div>
<div class="line"> <span class="comment">// doesn't need to be drawn here.</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="keywordflow">if</span> ( drawAsBoundingbox &amp;&amp; !footData-&gt;fCustomBoxDraw )</div>
<div class="line">    {</div>
<div class="line">        drawAsBoundingbox = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// For any viewport interactions switch to bounding box mode,</span></div>
<div class="line"> <span class="comment">// except when we are in playback. Uncomment to enable usage.</span></div>
<div class="line"> <span class="keywordflow">if</span> (context.<a name="a238"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#ae814ee8697336ed8a1f43182c3a43fd6">inUserInteraction</a>() || context.<a name="a239"></a><a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#acae6b9f8aa6589912296983df9f1aca8">userChangingViewContext</a>())</div>
<div class="line">    {</div>
<div class="line"> <span class="keywordflow">if</span> (!animPlay &amp;&amp; !animScrub)</div>
<div class="line">        {</div>
<div class="line">            ; <span class="comment">//drawAsBoundingbox = true;</span></div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Check to see if we are drawing with a shader override,</span></div>
<div class="line"> <span class="comment">// and look for any specific branching required for different passes</span></div>
<div class="line"> <span class="comment">// (e.g. for selection)</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="keywordtype">bool</span> inSelection = <span class="keyword">false</span>;</div>
<div class="line"> <span class="keywordtype">bool</span> inBeautyPass = <span class="keyword">false</span>;</div>
<div class="line"> <span class="keywordtype">bool</span> inTransparencyPass = <span class="keyword">false</span>;</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_string.html">MString</a> beautyPassSemantic(<span class="stringliteral">"shadedBeautyGraphSemantic"</span>);</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_pass_context.html">MHWRender::MPassContext</a> &amp; passCtx = context.<a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#ad3f9422688a9ffbe815c374ece46c1ea">getPassContext</a>();</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_string_array.html">MStringArray</a> &amp; passSem = passCtx.<a class="code" href="./class_m_h_w_render_1_1_m_pass_context.html#a9737189d5cfffd795336d711a678d627">passSemantics</a>();</div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html">MHWRender::MShaderInstance</a>* passShaderOverride = NULL;</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;passSem.<a class="code" href="./class_m_string_array.html#a580388f31f60c46fac867ca48a48da1e">length</a>(); i++)</div>
<div class="line">    {</div>
<div class="line"> <span class="keywordflow">if</span> (passSem[i] == <a class="code" href="./class_m_h_w_render_1_1_m_pass_context.html#a728fc00f0764227a6f345c089058c998">MHWRender::MPassContext::kSelectionPassSemantic</a>)</div>
<div class="line">        {</div>
<div class="line">            inSelection = <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">else</span> <span class="keywordflow">if</span> (passSem[i] == beautyPassSemantic)</div>
<div class="line">        {</div>
<div class="line">            inBeautyPass = <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Do not use the shader override in selection drawing code path</span></div>
<div class="line"> <span class="keywordflow">if</span> (selectInfo == <span class="keyword">nullptr</span> &amp;&amp; passCtx.<a class="code" href="./class_m_h_w_render_1_1_m_pass_context.html#a54cb1ff5e4a10ffc51cb05ddab8e69ab">hasShaderOverride</a>())</div>
<div class="line">        {</div>
<div class="line">            passShaderOverride = passCtx.<a class="code" href="./class_m_h_w_render_1_1_m_pass_context.html#aef8d7620ddd58e44e45ea0f0dfaa6fb4">shaderOverrideInstance</a>();</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Update single-sided state and normal multiplier as needed</span></div>
<div class="line">            passShaderOverride-&gt;<a name="a240"></a><a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html#aa17e2c9a17b86064950103066fa307ef">setParameter</a>(<span class="stringliteral">"isSingleSided"</span>, (displayStyle &amp; MHWRender::MFrameContext::kTwoSidedLighting) == 0);</div>
<div class="line">            passShaderOverride-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html#aa17e2c9a17b86064950103066fa307ef">setParameter</a>(<span class="stringliteral">"mayaNormalMultiplier"</span>, -1.0f);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (passSem[i] == <a name="a241"></a><a class="code" href="./class_m_h_w_render_1_1_m_pass_context.html#a99397c595d39f3decd87dfb85faf16a9">MHWRender::MPassContext::kCullBackSemantic</a> ||</div>
<div class="line">            passSem[i] == <a name="a242"></a><a class="code" href="./class_m_h_w_render_1_1_m_pass_context.html#a6715518f047f0e552636b74d311dfffd">MHWRender::MPassContext::kCullFrontSemantic</a>)</div>
<div class="line">        {</div>
<div class="line">            inTransparencyPass = <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Get cached data</span></div>
<div class="line"> <span class="keywordtype">float</span> color[4] = {</div>
<div class="line">            footData-&gt;fColor[0] * footData-&gt;fColor[3],</div>
<div class="line">            footData-&gt;fColor[1] * footData-&gt;fColor[3],</div>
<div class="line">            footData-&gt;fColor[2] * footData-&gt;fColor[3],</div>
<div class="line">            footData-&gt;fColor[3]</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">bool</span> requireBlending = <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (!inSelection)</div>
<div class="line">    {</div>
<div class="line"> <span class="comment">// Use some monotone version of color to show "default material mode"</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="comment">//if (displayStyle &amp; MHWRender::MFrameContext::kDefaultMaterial)</span></div>
<div class="line"> <span class="comment">//{</span></div>
<div class="line"> <span class="comment">//  color[0] = color[1] = color[2] = (color[0] + color[1] + color[2]) / 3.0f;</span></div>
<div class="line"> <span class="comment">//}</span></div>
<div class="line"> <span class="comment">// Do some alpha blending if in x-ray mode</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="keywordflow">if</span> (displayStyle &amp; MHWRender::MFrameContext::kXray)</div>
<div class="line">        {</div>
<div class="line"> <span class="comment">// If in beauty pass should still allow blending e.g. kMaterialOverrideSemantic</span></div>
<div class="line">            requireBlending = !passShaderOverride;</div>
<div class="line">            color[3] = 0.3f;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">//================================================</span></div>
<div class="line"> <span class="comment">// Set blend and raster state</span></div>
<div class="line"> <span class="comment">//================================================</span></div>
<div class="line"> <a name="_a243"></a><a class="code" href="./class_m_h_w_render_1_1_m_state_manager.html">MHWRender::MStateManager</a>* stateMgr = context.<a name="a244"></a><a class="code" href="./class_m_h_w_render_1_1_m_draw_context.html#a9eed5300933693e76ad77822b4feb37f">getStateManager</a>();</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_blend_state.html">MHWRender::MBlendState</a>* pOldBlendState = NULL;</div>
<div class="line"> <span class="keyword">const</span> <a name="_a245"></a><a class="code" href="./class_m_h_w_render_1_1_m_rasterizer_state.html">MHWRender::MRasterizerState</a>* pOldRasterState = NULL;</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_rasterizer_state.html">MHWRender::MRasterizerState</a>* rasterState = NULL;</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span>(stateMgr &amp;&amp; ((displayStyle &amp; <a class="code" href="./class_m_h_w_render_1_1_m_frame_context.html#a1b68f8823b8e275a4b548fdd27263e8aa620925ec70781a5f5de890d906660d24">MHWRender::MFrameContext::kGouraudShaded</a>) ||</div>
<div class="line">                   (displayStyle &amp; MHWRender::MFrameContext::kFlatShaded)))</div>
<div class="line">    {</div>
<div class="line"> <span class="comment">// draw filled, and with blending if required</span></div>
<div class="line"> <span class="keywordflow">if</span> (stateMgr &amp;&amp; requireBlending)</div>
<div class="line">        {       </div>
<div class="line"> <span class="keywordflow">if</span> (footData-&gt;mBlendState)</div>
<div class="line">            {</div>
<div class="line">                pOldBlendState = stateMgr-&gt;<a name="a246"></a><a class="code" href="./class_m_h_w_render_1_1_m_state_manager.html#a4dbf5ff33e99eba611b73273d868182f">getBlendState</a>();</div>
<div class="line">                stateMgr-&gt;<a name="a247"></a><a class="code" href="./class_m_h_w_render_1_1_m_state_manager.html#a27dbc083002d85108ed30ee1131f68c1">setBlendState</a>(footData-&gt;mBlendState);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// If the object is not draw as transparency, </span></div>
<div class="line"> <span class="comment">// override culling mode since we always want double-sided</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="keywordflow">if</span> (!inTransparencyPass)</div>
<div class="line">        {</div>
<div class="line">            pOldRasterState = stateMgr ? stateMgr-&gt;<a name="a248"></a><a class="code" href="./class_m_h_w_render_1_1_m_state_manager.html#a381d58fef9908f00a0e04bcf38b67838">getRasterizerState</a>() : NULL;</div>
<div class="line"> <span class="keywordflow">if</span> (pOldRasterState)</div>
<div class="line">            {</div>
<div class="line"></div>
<div class="line"> <a name="_a249"></a><a class="code" href="./class_m_h_w_render_1_1_m_rasterizer_state_desc.html">MHWRender::MRasterizerStateDesc</a> desc( pOldRasterState-&gt;<a name="a250"></a><a class="code" href="./class_m_h_w_render_1_1_m_rasterizer_state.html#a40659f03655c48c6f0060634b295067d">desc</a>() );</div>
<div class="line"> <span class="comment">// It's also possible to change this to kCullFront or kCullBack if we</span></div>
<div class="line"> <span class="comment">// wanted to set it to that.</span></div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_rasterizer_state.html#a9602dcbc7b9991767e322a6f55541e8a">MHWRender::MRasterizerState::CullMode</a> cullMode = <a name="a251"></a><a class="code" href="./class_m_h_w_render_1_1_m_rasterizer_state.html#a9602dcbc7b9991767e322a6f55541e8aaa6657ab67920a4dcc6e0a30044cc5487">MHWRender::MRasterizerState::kCullNone</a>;</div>
<div class="line"> <span class="keywordflow">if</span> (desc.cullMode != cullMode)</div>
<div class="line">                {</div>
<div class="line"> <span class="comment">// Just override the cullmode</span></div>
<div class="line">                    desc.cullMode = cullMode;</div>
<div class="line">                    rasterState = stateMgr-&gt;<a name="a252"></a><a class="code" href="./class_m_h_w_render_1_1_m_state_manager.html#a1f43e6ab99a6e2e5817df7bb1a0c69e6">acquireRasterizerState</a>(desc);</div>
<div class="line"> <span class="keywordflow">if</span> (rasterState)</div>
<div class="line">                    {</div>
<div class="line">                        stateMgr-&gt;<a name="a253"></a><a class="code" href="./class_m_h_w_render_1_1_m_state_manager.html#a7dfb1c4f28575ed6581aa40a7b64f22a">setRasterizerState</a>(rasterState);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">//================================================</span></div>
<div class="line"> <span class="comment">// Start the draw work</span></div>
<div class="line"> <span class="comment">//================================================</span></div>
<div class="line"></div>
<div class="line"> <span class="comment">// Prepare draw agent, default using OpenGL</span></div>
<div class="line">    RawFootPrintDrawAgentGL&amp; drawAgentRef = RawFootPrintDrawAgentGL::getDrawAgent();</div>
<div class="line">    RawFootPrintDrawAgent* drawAgentPtr = &amp;drawAgentRef;</div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"> <span class="comment">// DX Draw</span></div>
<div class="line"> <span class="keywordflow">if</span> ( !theRenderer-&gt;<a name="a254"></a><a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#aac2a5827e6a0ce3333e62ffa7751ba5e">drawAPIIsOpenGL</a>() )</div>
<div class="line">    {</div>
<div class="line">        RawFootPrintDrawAgentDX&amp; drawAgentRef = RawFootPrintDrawAgentDX::getDrawAgent();</div>
<div class="line">        drawAgentPtr = &amp;drawAgentRef;</div>
<div class="line">    }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> <span class="keywordflow">if</span> ( theRenderer-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#ae2d5ce57991bca16f525728e8d9d399e">drawAPI</a>() == <a class="code" href="./namespace_m_h_w_render.html#ad970d5c990d4803d0e9d73c1ff4fda49aaebf48c70b63878eff38483392f19fb7">MHWRender::kOpenGLCoreProfile</a> )</div>
<div class="line">    {</div>
<div class="line">        RawFootPrintDrawAgentCoreProfile&amp; drawAgentRef = RawFootPrintDrawAgentCoreProfile::getDrawAgent();</div>
<div class="line">        drawAgentPtr = &amp;drawAgentRef;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    assert( drawAgentPtr );</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (drawAgentPtr) {</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Set color</span></div>
<div class="line">        drawAgentPtr-&gt;setColor(<a class="code" href="./class_m_color.html">MColor</a>(color[0], color[1], color[2], color[3]));</div>
<div class="line"> <span class="comment">// Set matrix</span></div>
<div class="line">        drawAgentPtr-&gt;setMatrix( context, selectInfo);</div>
<div class="line"></div>
<div class="line">        drawAgentPtr-&gt;beginDraw( context, passShaderOverride );</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (drawAsBoundingbox)</div>
<div class="line">        {</div>
<div class="line"> <span class="comment">// If it is in bounding bode, draw only bounding box wireframe, nothing else</span></div>
<div class="line">            drawAgentPtr-&gt;drawBoundingBox();</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">else</span> {</div>
<div class="line"> <span class="keywordflow">if</span> (drawWireframe || overideTemplated || overrideNoShaded) </div>
<div class="line">            {</div>
<div class="line">                drawAgentPtr-&gt;drawWireframe();</div>
<div class="line">            }</div>
<div class="line"> <span class="keywordflow">if</span> (!overideTemplated &amp;&amp; !overrideNoShaded  &amp;&amp; drawShaded)</div>
<div class="line">            {</div>
<div class="line">                drawAgentPtr-&gt;drawShaded();</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        drawAgentPtr-&gt;endDraw();</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">//================================================</span></div>
<div class="line"> <span class="comment">// End the draw work</span></div>
<div class="line"> <span class="comment">//================================================</span></div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> ( passShaderOverride ) {</div>
<div class="line">        theRenderer-&gt;<a name="a255"></a><a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#a4603e18a1b89b798a2e4a4f36d9b5125">getShaderManager</a>()-&gt;<a name="a256"></a><a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a0c7deb55edc231cbb2365b271ecd55f8">releaseShader</a>( passShaderOverride );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">//================================================</span></div>
<div class="line"> <span class="comment">// Restore old blend state and old raster state</span></div>
<div class="line"> <span class="comment">//================================================</span></div>
<div class="line"> <span class="keywordflow">if</span>(stateMgr &amp;&amp; (displayStyle &amp; MHWRender::MFrameContext::kGouraudShaded  ||</div>
<div class="line">                    displayStyle &amp; MHWRender::MFrameContext::kFlatShaded))</div>
<div class="line">    {</div>
<div class="line"> <span class="keywordflow">if</span> (stateMgr &amp;&amp; pOldBlendState)</div>
<div class="line">        {</div>
<div class="line">            stateMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_state_manager.html#a27dbc083002d85108ed30ee1131f68c1">setBlendState</a>(pOldBlendState);</div>
<div class="line">            stateMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_state_manager.html#a544e5c653741b90e7c65d2b34e8ebe60">releaseBlendState</a>(pOldBlendState);</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">if</span> (pOldRasterState)</div>
<div class="line">        {</div>
<div class="line">            stateMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_state_manager.html#a7dfb1c4f28575ed6581aa40a7b64f22a">setRasterizerState</a>(pOldRasterState);</div>
<div class="line">            stateMgr-&gt;<a name="a257"></a><a class="code" href="./class_m_h_w_render_1_1_m_state_manager.html#a5c1115e1c741c78d1c19909c7b4d8db9">releaseRasterizerState</a>(pOldRasterState);</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">if</span> (rasterState)</div>
<div class="line">        {</div>
<div class="line">            stateMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_state_manager.html#a5c1115e1c741c78d1c19909c7b4d8db9">releaseRasterizerState</a>(rasterState);</div>
<div class="line">            rasterState = NULL;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> RawFootPrintDrawAgentCoreProfile::initShadersCoreProfile()</div>
<div class="line">{</div>
<div class="line"> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* vertexShaderText = </div>
<div class="line"> <span class="stringliteral">"#version 330  \n"</span></div>
<div class="line"> <span class="stringliteral">"in vec3 Pm;  \n"</span></div>
<div class="line"> <span class="stringliteral">"uniform mat4 MVP;  \n"</span></div>
<div class="line"> <span class="stringliteral">"void main() {  \n"</span></div>
<div class="line"> <span class="stringliteral">"   gl_Position = MVP * vec4(Pm,1.0);  \n"</span></div>
<div class="line"> <span class="stringliteral">"}"</span>;</div>
<div class="line">    GLuint vertexShaderID = GLCP::CreateShader(GL_VERTEX_SHADER);</div>
<div class="line">    GLCP::ShaderSource(vertexShaderID, 1, &amp;vertexShaderText , NULL);</div>
<div class="line">    GLCP::CompileShader(vertexShaderID);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Check for errors:</span></div>
<div class="line">    GLint result;</div>
<div class="line">    GLCP::GetShaderiv(vertexShaderID, GL_COMPILE_STATUS, &amp;result);</div>
<div class="line"> <span class="keywordflow">if</span>(result==GL_FALSE){</div>
<div class="line">        GLint errLength;</div>
<div class="line">        GLCP::GetShaderiv(vertexShaderID, GL_INFO_LOG_LENGTH, &amp;errLength);</div>
<div class="line"> <span class="keywordtype">char</span>* errorMessage = (<span class="keywordtype">char</span>*)malloc(errLength+1);</div>
<div class="line">        GLCP::GetShaderInfoLog(vertexShaderID, errLength, NULL, &amp;errorMessage[0]);</div>
<div class="line">        fprintf(stdout, <span class="stringliteral">"Compilation of vertex shader failed:\n%s\n"</span>, &amp;errorMessage[0]);</div>
<div class="line">        free(errorMessage);</div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* fragmentShaderText = </div>
<div class="line"> <span class="stringliteral">"#version 330  \n"</span></div>
<div class="line"> <span class="stringliteral">"uniform vec4 color = vec4( 1.0f, 1.0f, 1.0f, 1.0f );  \n"</span></div>
<div class="line"> <span class="stringliteral">"out vec4 colorOut; \n"</span></div>
<div class="line"> <span class="stringliteral">"void main() {  \n"</span></div>
<div class="line"> <span class="stringliteral">"   colorOut = color;  \n"</span></div>
<div class="line"> <span class="stringliteral">"}"</span>;</div>
<div class="line"></div>
<div class="line">    GLuint fragmentShaderID = GLCP::CreateShader(GL_FRAGMENT_SHADER);</div>
<div class="line">    GLCP::ShaderSource(fragmentShaderID, 1, &amp;fragmentShaderText , NULL);</div>
<div class="line">    GLCP::CompileShader(fragmentShaderID);</div>
<div class="line"></div>
<div class="line">    GLCP::GetShaderiv(fragmentShaderID, GL_COMPILE_STATUS, &amp;result);</div>
<div class="line"> <span class="keywordflow">if</span>(result==GL_FALSE){</div>
<div class="line">        GLint errLength;</div>
<div class="line">        GLCP::GetShaderiv(fragmentShaderID, GL_INFO_LOG_LENGTH, &amp;errLength);</div>
<div class="line"> <span class="keywordtype">char</span>* errorMessage = (<span class="keywordtype">char</span>*)malloc(errLength+1);</div>
<div class="line">        GLCP::GetShaderInfoLog(fragmentShaderID, errLength, NULL, &amp;errorMessage[0]);</div>
<div class="line">        fprintf(stdout, <span class="stringliteral">"Compilation of fragment shader failed:\n%s\n"</span>, &amp;errorMessage[0]);</div>
<div class="line">        free(errorMessage);</div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    mShaderProgram = GLCP::CreateProgram();</div>
<div class="line">    GLCP::AttachShader(mShaderProgram, vertexShaderID);</div>
<div class="line">    GLCP::AttachShader(mShaderProgram, fragmentShaderID);</div>
<div class="line">    GLCP::LinkProgram(mShaderProgram);</div>
<div class="line"></div>
<div class="line">    GLCP::GetProgramiv(mShaderProgram, GL_LINK_STATUS, &amp;result);</div>
<div class="line"> <span class="keywordflow">if</span>(result==GL_FALSE){</div>
<div class="line">        GLint errLength;</div>
<div class="line">        GLCP::GetProgramiv(mShaderProgram, GL_INFO_LOG_LENGTH, &amp;errLength);</div>
<div class="line"> <span class="keywordtype">char</span>* errorMessage = (<span class="keywordtype">char</span>*)malloc(errLength+1);</div>
<div class="line">        GLCP::GetProgramInfoLog(mShaderProgram, errLength, NULL, &amp;errorMessage[0]);</div>
<div class="line">        fprintf(stdout, <span class="stringliteral">"Linking of shader program failed:\n%s\n"</span>, &amp;errorMessage[0]);</div>
<div class="line">        free(errorMessage);</div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    mWVPIndex = GLCP::GetUniformLocation(mShaderProgram, <span class="stringliteral">"MVP"</span>);</div>
<div class="line">    mColorIndex = GLCP::GetUniformLocation(mShaderProgram, <span class="stringliteral">"color"</span>);</div>
<div class="line">    mVtxAttrib = GLCP::GetAttribLocation( mShaderProgram, <span class="stringliteral">"Pm"</span> );</div>
<div class="line"></div>
<div class="line">    GLCP::DeleteShader(vertexShaderID);</div>
<div class="line">    GLCP::DeleteShader(fragmentShaderID);</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> RawFootPrintDrawAgentCoreProfile::initBuffersCoreProfile()</div>
<div class="line">{</div>
<div class="line">    GLCP::GenVertexArrays(1, &amp;mBBoxVAO);</div>
<div class="line">    GLCP::BindVertexArray(mBBoxVAO);</div>
<div class="line"></div>
<div class="line">    GLCP::GenBuffers(1, &amp;mBoundingboxVertexBuffer);</div>
<div class="line">    GLCP::BindBuffer(GL_ARRAY_BUFFER, mBoundingboxVertexBuffer);</div>
<div class="line">    GLCP::BufferData(GL_ARRAY_BUFFER, <span class="keyword">sizeof</span>(bbData), (<span class="keywordtype">void</span>*)bbData, GL_STATIC_DRAW);</div>
<div class="line"></div>
<div class="line">    GLCP::GenBuffers(1, &amp;mBoundingboxVertexBuffer);</div>
<div class="line">    GLCP::BindBuffer(GL_ELEMENT_ARRAY_BUFFER, mBoundingboxVertexBuffer);</div>
<div class="line">    GLCP::BufferData(GL_ELEMENT_ARRAY_BUFFER, <span class="keyword">sizeof</span>(bbWireIndices), (<span class="keywordtype">void</span>*)bbWireIndices, GL_STATIC_DRAW);</div>
<div class="line"></div>
<div class="line">    GLCP::EnableVertexAttribArray(mVtxAttrib);</div>
<div class="line">    GLCP::VertexAttribPointer(mVtxAttrib, 3, GL_FLOAT, GL_FALSE, 0, 0);</div>
<div class="line">    GLCP::BindVertexArray(0);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    GLCP::GenBuffers(1, &amp;mSoleVertexBuffer);</div>
<div class="line">    GLCP::BindBuffer(GL_ARRAY_BUFFER, mSoleVertexBuffer);</div>
<div class="line">    GLCP::BufferData(GL_ARRAY_BUFFER, <span class="keyword">sizeof</span>(sole), (<span class="keywordtype">void</span>*)sole, GL_STATIC_DRAW);</div>
<div class="line"></div>
<div class="line">    GLCP::GenBuffers(1, &amp;mHeelVertexBuffer);</div>
<div class="line">    GLCP::BindBuffer(GL_ARRAY_BUFFER, mHeelVertexBuffer);</div>
<div class="line">    GLCP::BufferData(GL_ARRAY_BUFFER, <span class="keyword">sizeof</span>(heel), (<span class="keywordtype">void</span>*)heel, GL_STATIC_DRAW);</div>
<div class="line"></div>
<div class="line">    GLCP::GenBuffers(1, &amp;mSoleWireIndexBuffer);</div>
<div class="line">    GLCP::BindBuffer(GL_ELEMENT_ARRAY_BUFFER, mSoleWireIndexBuffer);</div>
<div class="line">    GLCP::BufferData(GL_ELEMENT_ARRAY_BUFFER, <span class="keyword">sizeof</span>(soleWireIndices), (<span class="keywordtype">void</span>*)soleWireIndices, GL_STATIC_DRAW);</div>
<div class="line"></div>
<div class="line">    GLCP::GenBuffers(1, &amp;mHeelWireIndexBuffer);</div>
<div class="line">    GLCP::BindBuffer(GL_ELEMENT_ARRAY_BUFFER, mHeelWireIndexBuffer);</div>
<div class="line">    GLCP::BufferData(GL_ELEMENT_ARRAY_BUFFER, <span class="keyword">sizeof</span>(heelWireIndices), (<span class="keywordtype">void</span>*)heelWireIndices, GL_STATIC_DRAW);</div>
<div class="line"></div>
<div class="line">    GLCP::GenBuffers(1, &amp;mSoleShadedIndexBuffer);</div>
<div class="line">    GLCP::BindBuffer(GL_ELEMENT_ARRAY_BUFFER, mSoleShadedIndexBuffer);</div>
<div class="line">    GLCP::BufferData(GL_ELEMENT_ARRAY_BUFFER, <span class="keyword">sizeof</span>(soleShadedIndices), (<span class="keywordtype">void</span>*)soleShadedIndices, GL_STATIC_DRAW);</div>
<div class="line"></div>
<div class="line">    GLCP::GenBuffers(1, &amp;mHeelShadedIndexBuffer);</div>
<div class="line">    GLCP::BindBuffer(GL_ELEMENT_ARRAY_BUFFER, mHeelShadedIndexBuffer);</div>
<div class="line">    GLCP::BufferData(GL_ELEMENT_ARRAY_BUFFER, <span class="keyword">sizeof</span>(heelShadedIndices), (<span class="keywordtype">void</span>*)heelShadedIndices, GL_STATIC_DRAW);</div>
<div class="line"></div>
<div class="line">    GLCP::UseProgram(mShaderProgram);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Setup ALL VAO Combinations here for further usage:</span></div>
<div class="line">    GLCP::GenVertexArrays(1, &amp;mSoleWireframeVAO);</div>
<div class="line">    GLCP::BindVertexArray(mSoleWireframeVAO);</div>
<div class="line">    GLCP::BindBuffer(GL_ARRAY_BUFFER, mSoleVertexBuffer);</div>
<div class="line">    GLCP::BindBuffer(GL_ELEMENT_ARRAY_BUFFER, mSoleWireIndexBuffer);</div>
<div class="line">    GLCP::EnableVertexAttribArray(mVtxAttrib);</div>
<div class="line">    GLCP::VertexAttribPointer(mVtxAttrib, 3, GL_FLOAT, GL_FALSE, 0, 0);</div>
<div class="line">    GLCP::BindVertexArray(0);</div>
<div class="line"></div>
<div class="line">    GLCP::GenVertexArrays(1, &amp;mHeelWireframeVAO);</div>
<div class="line">    GLCP::BindVertexArray(mHeelWireframeVAO);</div>
<div class="line">    GLCP::BindBuffer(GL_ARRAY_BUFFER, mHeelVertexBuffer);</div>
<div class="line">    GLCP::BindBuffer(GL_ELEMENT_ARRAY_BUFFER, mHeelWireIndexBuffer);</div>
<div class="line">    GLCP::EnableVertexAttribArray(mVtxAttrib);</div>
<div class="line">    GLCP::VertexAttribPointer(mVtxAttrib, 3, GL_FLOAT, GL_FALSE, 0, 0);</div>
<div class="line">    GLCP::BindVertexArray(0);</div>
<div class="line"></div>
<div class="line">    GLCP::GenVertexArrays(1, &amp;mSoleShadedVAO);</div>
<div class="line">    GLCP::BindVertexArray(mSoleShadedVAO);</div>
<div class="line">    GLCP::BindBuffer(GL_ARRAY_BUFFER, mSoleVertexBuffer);</div>
<div class="line">    GLCP::BindBuffer(GL_ELEMENT_ARRAY_BUFFER, mSoleShadedIndexBuffer);</div>
<div class="line">    GLCP::EnableVertexAttribArray(mVtxAttrib);</div>
<div class="line">    GLCP::VertexAttribPointer(mVtxAttrib, 3, GL_FLOAT, GL_FALSE, 0, 0);</div>
<div class="line">    GLCP::BindVertexArray(0);</div>
<div class="line"></div>
<div class="line">    GLCP::GenVertexArrays(1, &amp;mHeelShadedVAO);</div>
<div class="line">    GLCP::BindVertexArray(mHeelShadedVAO);</div>
<div class="line">    GLCP::BindBuffer(GL_ARRAY_BUFFER, mHeelVertexBuffer);</div>
<div class="line">    GLCP::BindBuffer(GL_ELEMENT_ARRAY_BUFFER, mHeelShadedIndexBuffer);</div>
<div class="line">    GLCP::EnableVertexAttribArray(mVtxAttrib);</div>
<div class="line">    GLCP::VertexAttribPointer(mVtxAttrib, 3, GL_FLOAT, GL_FALSE, 0, 0);</div>
<div class="line">    GLCP::BindVertexArray(0);</div>
<div class="line"></div>
<div class="line">    GLCP::UseProgram(0);</div>
<div class="line">    GLCP::BindBuffer(GL_ARRAY_BUFFER, 0);</div>
<div class="line">    GLCP::BindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> RawFootPrintDrawAgentCoreProfile::releaseCoreProfileResources()</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">if</span> (mShaderProgram)</div>
<div class="line">    {</div>
<div class="line">        GLCP::DeleteProgram(mShaderProgram);</div>
<div class="line">        mShaderProgram = 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (mBBoxVAO)</div>
<div class="line">    {</div>
<div class="line">        GLCP::DeleteVertexArrays(1, &amp;mBBoxVAO);</div>
<div class="line">        mBBoxVAO = 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (mSoleWireframeVAO)</div>
<div class="line">    {</div>
<div class="line">        GLCP::DeleteVertexArrays(1, &amp;mSoleWireframeVAO);</div>
<div class="line">        mSoleWireframeVAO = 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (mHeelWireframeVAO)</div>
<div class="line">    {</div>
<div class="line">        GLCP::DeleteVertexArrays(1, &amp;mHeelWireframeVAO);</div>
<div class="line">        mHeelWireframeVAO = 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (mSoleShadedVAO)</div>
<div class="line">    {</div>
<div class="line">        GLCP::DeleteVertexArrays(1, &amp;mSoleShadedVAO);</div>
<div class="line">        mSoleShadedVAO = 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (mHeelShadedVAO)</div>
<div class="line">    {</div>
<div class="line">        GLCP::DeleteVertexArrays(1, &amp;mHeelShadedVAO);</div>
<div class="line">        mHeelShadedVAO = 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (mBoundingboxVertexBuffer)</div>
<div class="line">    {</div>
<div class="line">        GLCP::DeleteBuffers(1, &amp;mBoundingboxVertexBuffer);</div>
<div class="line">        mBoundingboxVertexBuffer = 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (mBoundingboxIndexBuffer)</div>
<div class="line">    {</div>
<div class="line">        GLCP::DeleteBuffers(1, &amp;mBoundingboxIndexBuffer);</div>
<div class="line">        mBoundingboxIndexBuffer = 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (mSoleVertexBuffer)</div>
<div class="line">    {</div>
<div class="line">        GLCP::DeleteBuffers(1, &amp;mSoleVertexBuffer);</div>
<div class="line">        mSoleVertexBuffer = 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (mHeelVertexBuffer)</div>
<div class="line">    {</div>
<div class="line">        GLCP::DeleteBuffers(1, &amp;mHeelVertexBuffer);</div>
<div class="line">        mHeelVertexBuffer = 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (mSoleWireIndexBuffer)</div>
<div class="line">    {</div>
<div class="line">        GLCP::DeleteBuffers(1, &amp;mSoleWireIndexBuffer);</div>
<div class="line">        mSoleWireIndexBuffer = 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (mSoleShadedIndexBuffer)</div>
<div class="line">    {</div>
<div class="line">        GLCP::DeleteBuffers(1, &amp;mSoleShadedIndexBuffer);</div>
<div class="line">        mSoleShadedIndexBuffer = 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (mHeelWireIndexBuffer)</div>
<div class="line">    {</div>
<div class="line">        GLCP::DeleteBuffers(1, &amp;mHeelWireIndexBuffer);</div>
<div class="line">        mHeelWireIndexBuffer = 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (mHeelShadedIndexBuffer)</div>
<div class="line">    {</div>
<div class="line">        GLCP::DeleteBuffers(1, &amp;mHeelShadedIndexBuffer);</div>
<div class="line">        mHeelShadedIndexBuffer = 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">// DX stuff</span></div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> RawFootPrintDrawAgentDX::initShadersDX()</div>
<div class="line">{</div>
<div class="line">    assert( mDevicePtr );</div>
<div class="line"> <span class="keywordflow">if</span> ( !mDevicePtr )</div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">    HRESULT hr;</div>
<div class="line">    DWORD dwShaderFlags = D3DCOMPILE_ENABLE_STRICTNESS;</div>
<div class="line">    ID3DBlob* vsBlob = NULL;</div>
<div class="line">    ID3DBlob* psBlob = NULL;</div>
<div class="line">    ID3DBlob* pErrorBlob;</div>
<div class="line"> </div>
<div class="line"></div>
<div class="line"> <span class="comment">// VS</span></div>
<div class="line"> <span class="keywordflow">if</span> (!mVertexShaderPtr)</div>
<div class="line">    {</div>
<div class="line"><span class="preprocessor">#if _MSC_VER &lt; 1700</span></div>
<div class="line">        hr = D3DX11CompileFromFile(</div>
<div class="line">            mEffectLocation.asChar(),</div>
<div class="line">            NULL,</div>
<div class="line">            NULL,</div>
<div class="line"> <span class="stringliteral">"mainVS"</span>,</div>
<div class="line"> <span class="stringliteral">"vs_5_0"</span>,</div>
<div class="line">            dwShaderFlags,</div>
<div class="line">            0,</div>
<div class="line">            NULL,</div>
<div class="line">            &amp;vsBlob,</div>
<div class="line">            &amp;pErrorBlob,</div>
<div class="line">            NULL);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">        hr = D3DCompileFromFile(</div>
<div class="line">            mEffectLocation.asWChar(),</div>
<div class="line">            NULL,</div>
<div class="line">            NULL,</div>
<div class="line"> <span class="stringliteral">"mainVS"</span>,</div>
<div class="line"> <span class="stringliteral">"vs_5_0"</span>,</div>
<div class="line">            dwShaderFlags,</div>
<div class="line">            0,</div>
<div class="line">            &amp;vsBlob,</div>
<div class="line">            &amp;pErrorBlob);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> <span class="keywordflow">if</span> (FAILED(hr))</div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">"Failed to compile vertex shader\n"</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (pErrorBlob) pErrorBlob-&gt;Release();</div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">if</span> (pErrorBlob) pErrorBlob-&gt;Release();</div>
<div class="line">        hr = mDevicePtr-&gt;CreateVertexShader(</div>
<div class="line">            vsBlob-&gt;GetBufferPointer(), vsBlob-&gt;GetBufferSize(), NULL, &amp;mVertexShaderPtr);</div>
<div class="line"> <span class="keywordflow">if</span> (FAILED(hr))</div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">"Failed to create vertex shader\n"</span>);</div>
<div class="line">            vsBlob-&gt;Release();</div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Layout</span></div>
<div class="line"> <span class="keywordflow">if</span> (!mVertexLayoutPtr)</div>
<div class="line">    {</div>
<div class="line">        D3D11_INPUT_ELEMENT_DESC layout[] =</div>
<div class="line">        {</div>
<div class="line">            { <span class="stringliteral">"POSITION"</span>, 0, DXGI_FORMAT_R32G32B32_FLOAT, 0, 0, D3D11_INPUT_PER_VERTEX_DATA, 0 },</div>
<div class="line">            { <span class="stringliteral">"NORMAL"</span>, 0, DXGI_FORMAT_R32G32B32_FLOAT, 1, 0, D3D11_INPUT_PER_VERTEX_DATA, 0 },</div>
<div class="line">        };</div>
<div class="line"> <span class="keywordtype">int</span> numLayoutElements = <span class="keyword">sizeof</span> layout/<span class="keyword">sizeof</span> layout[0];</div>
<div class="line">        hr = mDevicePtr-&gt;CreateInputLayout(</div>
<div class="line">            layout, numLayoutElements, vsBlob-&gt;GetBufferPointer(), vsBlob-&gt;GetBufferSize(), &amp;mVertexLayoutPtr);</div>
<div class="line">        vsBlob-&gt;Release();</div>
<div class="line"> <span class="keywordflow">if</span> (FAILED(hr))</div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">"Failed to create input layout\n"</span>);</div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// PS</span></div>
<div class="line"> <span class="keywordflow">if</span> (!mPixelShaderPtr)</div>
<div class="line">    {</div>
<div class="line"><span class="preprocessor">#if _MSC_VER &lt; 1700</span></div>
<div class="line">        hr = D3DX11CompileFromFile(</div>
<div class="line">            mEffectLocation.asChar(),</div>
<div class="line">            NULL,</div>
<div class="line">            NULL,</div>
<div class="line"> <span class="stringliteral">"mainPS"</span>,</div>
<div class="line"> <span class="stringliteral">"ps_5_0"</span>,</div>
<div class="line">            dwShaderFlags,</div>
<div class="line">            0,</div>
<div class="line">            NULL,</div>
<div class="line">            &amp;psBlob,</div>
<div class="line">            &amp;pErrorBlob,</div>
<div class="line">            NULL);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">        hr = D3DCompileFromFile(</div>
<div class="line">            mEffectLocation.asWChar(),</div>
<div class="line">            NULL,</div>
<div class="line">            NULL,</div>
<div class="line"> <span class="stringliteral">"mainPS"</span>,</div>
<div class="line"> <span class="stringliteral">"ps_5_0"</span>,</div>
<div class="line">            dwShaderFlags,</div>
<div class="line">            0,</div>
<div class="line">            &amp;psBlob,</div>
<div class="line">            &amp;pErrorBlob);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> <span class="keywordflow">if</span> (FAILED(hr))</div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">"Failed to compile vertex shader\n"</span>);</div>
<div class="line">            mVertexShaderPtr-&gt;Release();</div>
<div class="line">            mVertexLayoutPtr-&gt;Release();</div>
<div class="line"> <span class="keywordflow">if</span> (pErrorBlob) pErrorBlob-&gt;Release();</div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">if</span> (pErrorBlob) pErrorBlob-&gt;Release();</div>
<div class="line">        hr = mDevicePtr-&gt;CreatePixelShader(</div>
<div class="line">            psBlob-&gt;GetBufferPointer(), psBlob-&gt;GetBufferSize(), NULL, &amp;mPixelShaderPtr);</div>
<div class="line">        psBlob-&gt;Release();</div>
<div class="line"> <span class="keywordflow">if</span> (FAILED(hr))</div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">"Failed to create pixel shader\n"</span>);</div>
<div class="line">            mVertexShaderPtr-&gt;Release();</div>
<div class="line">            mVertexLayoutPtr-&gt;Release();</div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> RawFootPrintDrawAgentDX::initBuffersDX()</div>
<div class="line">{</div>
<div class="line">    assert( mDevicePtr );</div>
<div class="line"> <span class="keywordflow">if</span> ( !mDevicePtr )</div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">    HRESULT hr;</div>
<div class="line">    D3D11_BUFFER_DESC bd;</div>
<div class="line">    ZeroMemory(&amp;bd, <span class="keyword">sizeof</span>(bd));</div>
<div class="line">    D3D11_SUBRESOURCE_DATA InitData;</div>
<div class="line">    ZeroMemory(&amp;InitData, <span class="keyword">sizeof</span>(InitData));</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (!mBoundingboxVertexBufferPtr)</div>
<div class="line">    {</div>
<div class="line">        bd.Usage = D3D11_USAGE_IMMUTABLE;</div>
<div class="line">        bd.ByteWidth = <span class="keyword">sizeof</span>(float) * 3 * 8;</div>
<div class="line">        bd.BindFlags = D3D11_BIND_VERTEX_BUFFER;</div>
<div class="line">        bd.CPUAccessFlags = 0;</div>
<div class="line">        InitData.pSysMem = bbData;</div>
<div class="line">        hr = mDevicePtr-&gt;CreateBuffer(&amp;bd, &amp;InitData, &amp;mBoundingboxVertexBufferPtr);</div>
<div class="line"> <span class="keywordflow">if</span> (FAILED(hr)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span>( !mBoundingboxIndexBufferPtr ){</div>
<div class="line">        bd.Usage = D3D11_USAGE_IMMUTABLE;</div>
<div class="line">        bd.ByteWidth = <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> short) * 2 * 12;</div>
<div class="line">        bd.BindFlags = D3D11_BIND_INDEX_BUFFER;</div>
<div class="line">        bd.CPUAccessFlags = 0;</div>
<div class="line">        InitData.pSysMem = bbWireIndices;</div>
<div class="line">        hr = mDevicePtr-&gt;CreateBuffer(&amp;bd, &amp;InitData, &amp;mBoundingboxIndexBufferPtr);</div>
<div class="line"> <span class="keywordflow">if</span> (FAILED(hr)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Sole positions</span></div>
<div class="line"> <span class="keywordflow">if</span> (!mSoleVertexBufferPtr[0])</div>
<div class="line">    {</div>
<div class="line">        bd.Usage = D3D11_USAGE_IMMUTABLE;</div>
<div class="line">        bd.ByteWidth = <span class="keyword">sizeof</span>(float) * 3 * soleCount;</div>
<div class="line">        bd.BindFlags = D3D11_BIND_VERTEX_BUFFER;</div>
<div class="line">        bd.CPUAccessFlags = 0;</div>
<div class="line">        InitData.pSysMem = sole;</div>
<div class="line">        hr = mDevicePtr-&gt;CreateBuffer(&amp;bd, &amp;InitData, &amp;mSoleVertexBufferPtr[0]);</div>
<div class="line"> <span class="keywordflow">if</span> (FAILED(hr)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> <span class="comment">// Sole normals</span></div>
<div class="line"> <span class="keywordflow">if</span> (!mSoleVertexBufferPtr[1])</div>
<div class="line">    {</div>
<div class="line">        bd.Usage = D3D11_USAGE_IMMUTABLE;</div>
<div class="line">        bd.ByteWidth = <span class="keyword">sizeof</span>(float) * 3 * soleCount;</div>
<div class="line">        bd.BindFlags = D3D11_BIND_VERTEX_BUFFER;</div>
<div class="line">        bd.CPUAccessFlags = 0;</div>
<div class="line">        InitData.pSysMem = soleNorm;</div>
<div class="line">        hr = mDevicePtr-&gt;CreateBuffer(&amp;bd, &amp;InitData, &amp;mSoleVertexBufferPtr[1]);</div>
<div class="line"> <span class="keywordflow">if</span> (FAILED(hr)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> <span class="comment">// Heal positions</span></div>
<div class="line"> <span class="keywordflow">if</span> (!mHeelVertexBufferPtr[0])</div>
<div class="line">    {</div>
<div class="line">        bd.Usage = D3D11_USAGE_IMMUTABLE;</div>
<div class="line">        bd.ByteWidth = <span class="keyword">sizeof</span>(float) * 3 * heelCount;</div>
<div class="line">        bd.BindFlags = D3D11_BIND_VERTEX_BUFFER;</div>
<div class="line">        bd.CPUAccessFlags = 0;</div>
<div class="line">        InitData.pSysMem = heel;</div>
<div class="line">        hr = mDevicePtr-&gt;CreateBuffer(&amp;bd, &amp;InitData, &amp;mHeelVertexBufferPtr[0]);</div>
<div class="line"> <span class="keywordflow">if</span> (FAILED(hr)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> <span class="comment">// Heal normals</span></div>
<div class="line"> <span class="keywordflow">if</span> (!mHeelVertexBufferPtr[1])</div>
<div class="line">    {</div>
<div class="line">        bd.Usage = D3D11_USAGE_IMMUTABLE;</div>
<div class="line">        bd.ByteWidth = <span class="keyword">sizeof</span>(float) * 3 * heelCount;</div>
<div class="line">        bd.BindFlags = D3D11_BIND_VERTEX_BUFFER;</div>
<div class="line">        bd.CPUAccessFlags = 0;</div>
<div class="line">        InitData.pSysMem = heelNorm;</div>
<div class="line">        hr = mDevicePtr-&gt;CreateBuffer(&amp;bd, &amp;InitData, &amp;mHeelVertexBufferPtr[1]);</div>
<div class="line"> <span class="keywordflow">if</span> (FAILED(hr)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (!mSoleWireIndexBufferPtr)</div>
<div class="line">    {</div>
<div class="line">        bd.Usage = D3D11_USAGE_IMMUTABLE;</div>
<div class="line">        bd.ByteWidth = <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> short) * 2 * (soleCount-1);</div>
<div class="line">        bd.BindFlags = D3D11_BIND_INDEX_BUFFER;</div>
<div class="line">        bd.CPUAccessFlags = 0;</div>
<div class="line">        InitData.pSysMem = soleWireIndices;</div>
<div class="line">        hr = mDevicePtr-&gt;CreateBuffer(&amp;bd, &amp;InitData, &amp;mSoleWireIndexBufferPtr);</div>
<div class="line"> <span class="keywordflow">if</span> (FAILED(hr)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (!mHeelWireIndexBufferPtr)</div>
<div class="line">    {</div>
<div class="line">        bd.Usage = D3D11_USAGE_IMMUTABLE;</div>
<div class="line">        bd.ByteWidth = <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> short) * 2 * (heelCount-1);</div>
<div class="line">        bd.BindFlags = D3D11_BIND_INDEX_BUFFER;</div>
<div class="line">        bd.CPUAccessFlags = 0;</div>
<div class="line">        InitData.pSysMem = heelWireIndices;</div>
<div class="line">        hr = mDevicePtr-&gt;CreateBuffer(&amp;bd, &amp;InitData, &amp;mHeelWireIndexBufferPtr);</div>
<div class="line"> <span class="keywordflow">if</span> (FAILED(hr)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (!mSoleShadedIndexBufferPtr)</div>
<div class="line">    {</div>
<div class="line">        bd.Usage = D3D11_USAGE_IMMUTABLE;</div>
<div class="line">        bd.ByteWidth = <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> short) * 3 * (soleCount-2);</div>
<div class="line">        bd.BindFlags = D3D11_BIND_INDEX_BUFFER;</div>
<div class="line">        bd.CPUAccessFlags = 0;</div>
<div class="line">        InitData.pSysMem = soleShadedIndices;</div>
<div class="line">        hr = mDevicePtr-&gt;CreateBuffer(&amp;bd, &amp;InitData, &amp;mSoleShadedIndexBufferPtr);</div>
<div class="line"> <span class="keywordflow">if</span> (FAILED(hr)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (!mHeelShadedIndexBufferPtr)</div>
<div class="line">    {</div>
<div class="line">        bd.Usage = D3D11_USAGE_IMMUTABLE;</div>
<div class="line">        bd.ByteWidth = <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> short) * 3 * (heelCount-2);</div>
<div class="line">        bd.BindFlags = D3D11_BIND_INDEX_BUFFER;</div>
<div class="line">        bd.CPUAccessFlags = 0;</div>
<div class="line">        InitData.pSysMem = heelShadedIndices;</div>
<div class="line">        hr = mDevicePtr-&gt;CreateBuffer(&amp;bd, &amp;InitData, &amp;mHeelShadedIndexBufferPtr);</div>
<div class="line"> <span class="keywordflow">if</span> (FAILED(hr)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (!mConstantBufferPtr)</div>
<div class="line">    {</div>
<div class="line">        bd.Usage = D3D11_USAGE_DEFAULT;</div>
<div class="line">        bd.ByteWidth = <span class="keyword">sizeof</span>(ConstantBufferDef);</div>
<div class="line">        bd.BindFlags = D3D11_BIND_CONSTANT_BUFFER;</div>
<div class="line">        bd.CPUAccessFlags = 0;</div>
<div class="line">        hr = mDevicePtr-&gt;CreateBuffer(&amp;bd, NULL, &amp;mConstantBufferPtr);</div>
<div class="line"> <span class="keywordflow">if</span> (FAILED(hr)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> RawFootPrintDrawAgentDX::releaseDXResources()</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">if</span> (mBoundingboxVertexBufferPtr)</div>
<div class="line">    {</div>
<div class="line">        mBoundingboxVertexBufferPtr-&gt;Release();</div>
<div class="line">        mBoundingboxVertexBufferPtr = NULL;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (mBoundingboxIndexBufferPtr)</div>
<div class="line">    {</div>
<div class="line">        mBoundingboxIndexBufferPtr-&gt;Release();</div>
<div class="line">        mBoundingboxIndexBufferPtr = NULL;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (mSoleVertexBufferPtr[0])</div>
<div class="line">    {</div>
<div class="line">        mSoleVertexBufferPtr[0]-&gt;Release();</div>
<div class="line">        mSoleVertexBufferPtr[0] = NULL;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (mSoleVertexBufferPtr[1])</div>
<div class="line">    {</div>
<div class="line">        mSoleVertexBufferPtr[1]-&gt;Release();</div>
<div class="line">        mSoleVertexBufferPtr[1] = NULL;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (mHeelVertexBufferPtr[0])</div>
<div class="line">    {</div>
<div class="line">        mHeelVertexBufferPtr[0]-&gt;Release();</div>
<div class="line">        mHeelVertexBufferPtr[0] = NULL;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (mHeelVertexBufferPtr[1])</div>
<div class="line">    {</div>
<div class="line">        mHeelVertexBufferPtr[1]-&gt;Release();</div>
<div class="line">        mHeelVertexBufferPtr[1] = NULL;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (mSoleWireIndexBufferPtr)</div>
<div class="line">    {</div>
<div class="line">        mSoleWireIndexBufferPtr-&gt;Release();</div>
<div class="line">        mSoleWireIndexBufferPtr = NULL;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (mSoleShadedIndexBufferPtr)</div>
<div class="line">    {</div>
<div class="line">        mSoleShadedIndexBufferPtr-&gt;Release();</div>
<div class="line">        mSoleShadedIndexBufferPtr = NULL;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (mHeelWireIndexBufferPtr)</div>
<div class="line">    {</div>
<div class="line">        mHeelWireIndexBufferPtr-&gt;Release();</div>
<div class="line">        mHeelWireIndexBufferPtr = NULL;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (mHeelShadedIndexBufferPtr)</div>
<div class="line">    {</div>
<div class="line">        mHeelShadedIndexBufferPtr-&gt;Release();</div>
<div class="line">        mHeelShadedIndexBufferPtr = NULL;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (mVertexShaderPtr)</div>
<div class="line">    {</div>
<div class="line">        mVertexShaderPtr-&gt;Release();</div>
<div class="line">        mVertexShaderPtr = NULL;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (mPixelShaderPtr)</div>
<div class="line">    {</div>
<div class="line">        mPixelShaderPtr-&gt;Release();</div>
<div class="line">        mPixelShaderPtr = NULL;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (mVertexLayoutPtr)</div>
<div class="line">    {</div>
<div class="line">        mVertexLayoutPtr-&gt;Release();</div>
<div class="line">        mVertexLayoutPtr = NULL;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (mConstantBufferPtr)</div>
<div class="line">    {</div>
<div class="line">        mConstantBufferPtr-&gt;Release();</div>
<div class="line">        mConstantBufferPtr = NULL;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#endif // _WIN32</span></div>
<div class="line"></div>
<div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Plugin Registration</span></div>
<div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="./class_m_status.html">MStatus</a> rawfootPrint::initialize()</div>
<div class="line">{</div>
<div class="line"> <a name="_a258"></a><a class="code" href="./class_m_fn_unit_attribute.html">MFnUnitAttribute</a> unitFn;</div>
<div class="line"> <a name="_a259"></a><a class="code" href="./class_m_fn_numeric_attribute.html">MFnNumericAttribute</a> numberFn;</div>
<div class="line"> </div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a>          stat;</div>
<div class="line"></div>
<div class="line">    size = unitFn.<a name="a260"></a><a class="code" href="./class_m_fn_unit_attribute.html#a31f804de81a968aa11b510a6231e7874">create</a>( <span class="stringliteral">"size"</span>, <span class="stringliteral">"sz"</span>, <a name="a261"></a><a class="code" href="./class_m_fn_unit_attribute.html#a1d1cfd8ffb84e947f82999c682b666a7a1925172d8d6f77cdb98f7f486f706024">MFnUnitAttribute::kDistance</a> );</div>
<div class="line">    unitFn.<a name="a262"></a><a class="code" href="./class_m_fn_unit_attribute.html#a02a46e1b4ae48c38d85678a8611e3e77">setDefault</a>( 1.0 );</div>
<div class="line"></div>
<div class="line">    stat = addAttribute( size );</div>
<div class="line"> <span class="keywordflow">if</span> (!stat) {</div>
<div class="line">        stat.<a name="a263"></a><a class="code" href="./class_m_status.html#a1f01a4748fea4d8bcced082df83f804d">perror</a>(<span class="stringliteral">"addAttribute"</span>);</div>
<div class="line"> <span class="keywordflow">return</span> stat;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    transparencySort = numberFn.<a name="a264"></a><a class="code" href="./class_m_fn_numeric_attribute.html#a5c08a5ce5e7123cc444c95a0e4a50f29">create</a>( <span class="stringliteral">"transparencySort"</span>, <span class="stringliteral">"ts"</span>, <a name="a265"></a><a class="code" href="./class_m_fn_numeric_data.html#a1d1cfd8ffb84e947f82999c682b666a7a8cfc0ab572a96edfc9db7c02f0d025d7">MFnNumericData::kBoolean</a> );</div>
<div class="line">    numberFn.<a name="a266"></a><a class="code" href="./class_m_fn_numeric_attribute.html#aae3f2fbbbce06e006f1838a1fb6fdcdd">setDefault</a>( <span class="keyword">false</span> );</div>
<div class="line"> </div>
<div class="line">    stat = addAttribute( transparencySort );</div>
<div class="line"> <span class="keywordflow">if</span> (!stat) {</div>
<div class="line">        stat.<a class="code" href="./class_m_status.html#a1f01a4748fea4d8bcced082df83f804d">perror</a>(<span class="stringliteral">"addAttribute"</span>);</div>
<div class="line"> <span class="keywordflow">return</span> stat;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    transparency = numberFn.<a class="code" href="./class_m_fn_numeric_attribute.html#a5c08a5ce5e7123cc444c95a0e4a50f29">create</a>( <span class="stringliteral">"transparency"</span>, <span class="stringliteral">"t"</span>, <a name="a267"></a><a class="code" href="./class_m_fn_numeric_data.html#a1d1cfd8ffb84e947f82999c682b666a7a5686197bafb177bdc82550848416a1ad">MFnNumericData::kFloat</a> );</div>
<div class="line">    numberFn.<a class="code" href="./class_m_fn_numeric_attribute.html#aae3f2fbbbce06e006f1838a1fb6fdcdd">setDefault</a>( 1.0 );</div>
<div class="line">    numberFn.<a name="a268"></a><a class="code" href="./class_m_fn_numeric_attribute.html#adab95fd85497b1dad3a4ba7a842ce9d8">setMax</a>( 1.0 );</div>
<div class="line">    numberFn.<a name="a269"></a><a class="code" href="./class_m_fn_numeric_attribute.html#aba21b33176bb831de026b78605c1dcf3">setMin</a>( 0.0 );</div>
<div class="line"> </div>
<div class="line">    stat = addAttribute( transparency );</div>
<div class="line"> <span class="keywordflow">if</span> (!stat) {</div>
<div class="line">        stat.<a class="code" href="./class_m_status.html#a1f01a4748fea4d8bcced082df83f804d">perror</a>(<span class="stringliteral">"addAttribute"</span>);</div>
<div class="line"> <span class="keywordflow">return</span> stat;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Add dependency on the localScale attribute, so that when size is modified RawFootPrintDrawOverride::transform will get called</span></div>
<div class="line">    attributeAffects( rawfootPrint::size, <a name="a270"></a><a class="code" href="./class_m_px_locator_node.html#aec8212a7775d67dbea1c6207a80d3cf3">MPxLocatorNode::localScale</a> );</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> MS::kSuccess;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="./class_m_status.html">MStatus</a> initializePlugin( <a class="code" href="./class_m_object.html">MObject</a> obj )</div>
<div class="line">{</div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a>   status;</div>
<div class="line"> <a name="_a271"></a><a class="code" href="./class_m_fn_plugin.html">MFnPlugin</a> plugin( obj, PLUGIN_COMPANY, <span class="stringliteral">"3.0"</span>, <span class="stringliteral">"Any"</span>);</div>
<div class="line"></div>
<div class="line">    status = plugin.registerNode(</div>
<div class="line"> <span class="stringliteral">"rawfootPrint"</span>,</div>
<div class="line">                rawfootPrint::id,</div>
<div class="line">                &amp;rawfootPrint::creator,</div>
<div class="line">                &amp;rawfootPrint::initialize,</div>
<div class="line"> <a name="a272"></a><a class="code" href="./class_m_px_node.html#a1d1cfd8ffb84e947f82999c682b666a7aee1b06f2f9885d7d4fd4fda48926f94b">MPxNode::kLocatorNode</a>,</div>
<div class="line">                &amp;rawfootPrint::drawDbClassification);</div>
<div class="line"> <span class="keywordflow">if</span> (!status) {</div>
<div class="line">        status.<a class="code" href="./class_m_status.html#a1f01a4748fea4d8bcced082df83f804d">perror</a>(<span class="stringliteral">"registerNode"</span>);</div>
<div class="line"> <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    status = <a name="a273"></a><a class="code" href="./class_m_h_w_render_1_1_m_draw_registry.html#aad1598f978d33d3e5101ae28f9f07b6f">MHWRender::MDrawRegistry::registerDrawOverrideCreator</a>(</div>
<div class="line">        rawfootPrint::drawDbClassification,</div>
<div class="line">        rawfootPrint::drawRegistrantId,</div>
<div class="line">        RawFootPrintDrawOverride::Creator);</div>
<div class="line"> <span class="keywordflow">if</span> (!status) {</div>
<div class="line">        status.<a class="code" href="./class_m_status.html#a1f01a4748fea4d8bcced082df83f804d">perror</a>(<span class="stringliteral">"registerDrawOverrideCreator"</span>);</div>
<div class="line"> <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="./class_m_status.html">MStatus</a> uninitializePlugin( <a class="code" href="./class_m_object.html">MObject</a> obj)</div>
<div class="line">{</div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a>   status;</div>
<div class="line"> <a class="code" href="./class_m_fn_plugin.html">MFnPlugin</a> plugin( obj );</div>
<div class="line"></div>
<div class="line">    status = <a name="a274"></a><a class="code" href="./class_m_h_w_render_1_1_m_draw_registry.html#ae87be399ce4204dbe8b565c4ff76c0fa">MHWRender::MDrawRegistry::deregisterDrawOverrideCreator</a>(</div>
<div class="line">        rawfootPrint::drawDbClassification,</div>
<div class="line">        rawfootPrint::drawRegistrantId);</div>
<div class="line"> <span class="keywordflow">if</span> (!status) {</div>
<div class="line">        status.<a class="code" href="./class_m_status.html#a1f01a4748fea4d8bcced082df83f804d">perror</a>(<span class="stringliteral">"deregisterDrawOverrideCreator"</span>);</div>
<div class="line"> <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    status = plugin.deregisterNode( rawfootPrint::id );</div>
<div class="line"> <span class="keywordflow">if</span> (!status) {</div>
<div class="line">        status.<a class="code" href="./class_m_status.html#a1f01a4748fea4d8bcced082df83f804d">perror</a>(<span class="stringliteral">"deregisterNode"</span>);</div>
<div class="line"> <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Release DX resources</span></div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line">    {</div>
<div class="line">        RawFootPrintDrawAgentDX&amp; drawAgentRef = RawFootPrintDrawAgentDX::getDrawAgent();</div>
<div class="line">        drawAgentRef.releaseDXResources();</div>
<div class="line">    }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> <span class="comment">// Release GL Core resources</span></div>
<div class="line">    {</div>
<div class="line">        RawFootPrintDrawAgentCoreProfile&amp; drawAgentRef = RawFootPrintDrawAgentCoreProfile::getDrawAgent();</div>
<div class="line">        drawAgentRef.releaseCoreProfileResources();</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<div class="footer-block"><a class="comments-anchor" href="../html/ac.cmtdialog.htm" target="_blank"><span class="comments-link">Please send us your comment about this page</span></a></div></div>
</div></body>
</html>
