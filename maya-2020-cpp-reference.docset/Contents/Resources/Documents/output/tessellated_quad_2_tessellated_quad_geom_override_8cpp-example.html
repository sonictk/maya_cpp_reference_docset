<!-- saved from url=(0024)http://docs.autodesk.com -->
<html>
<head><script src="../scripts/yepnope.1.5.4-min.js" type="text/javascript"></script><script src="../scripts/lib/jquery-1.11.1.min.js" type="text/javascript"></script>
<title>C++ API Reference: tessellatedQuad/TessellatedQuadGeomOverride.cpp</title>
</head>
<body height="100%"><div class="body_content" id="body-content"><link href="cpp_ref/navtree.css" rel="stylesheet" type="text/css"/><link href="cpp_ref/doxygen.css" rel="stylesheet" type="text/css"/><link href="cpp_ref/tabs.css" rel="stylesheet" type="text/css"/><link href="style/adsk.cpm.css" rel="stylesheet" type="text/css"/><script type="text/javascript">
var tocSystemNeedsToBeLoaded = typeof(cpp_ref_adsk_ref_toc) == 'undefined';
var weAreIn21 = $('div#main.view-active').length;
var tocPrefix = '';
if (weAreIn21)
{ tocPrefix = 'cpp_ref/'; }
function cpp_ref_initializeToc(forceTrigger) {
    cpp_ref_adsk_ref_toc.initResizable();
    cpp_ref_adsk_ref_toc.initNavTree('tessellated_quad_2_tessellated_quad_geom_override_8cpp-example.html', tocPrefix);
    dQuery(document).trigger('toc_initialized');
}
if (tocSystemNeedsToBeLoaded)
{
	yepnope([{
	load:[tocPrefix + 'json3.min.js', tocPrefix + 'jquery.js', tocPrefix + 'ref-toc-controller.js', tocPrefix + 'dynsections.js'],
	complete: function() {
	  if (typeof(dQuery) == 'undefined')
	  {
	    dQuery = jQuery.noConflict(true);
	  }
	  else { jQuery.noConflict(true); }
	  $(document).ready(cpp_ref_initializeToc);
	}
 	}])
}
if (!weAreIn21) { // if in AKN...
$(window).load( function() {
    setTimeout( function() {
        var content = $('body > div').not('#body-content');     // take any divs under body that are not id=body-content
        content.each( function() { 
            $(this).css( { 'padding-left': $(this).css('margin-left') } );       // and if they have any padding-left already, move it to margin-left.
        } );
        var width = cpp_ref_adsk_ref_toc.readFromStorage('width');
        content.css({marginLeft:parseInt(width)+6+"px"});
    }, 100);
} ); 
}
</script><script>
 if (!tocSystemNeedsToBeLoaded) { cpp_ref_initializeToc(); }
 </script>
<div>
<div class="head">
<h1>C++ API Reference: tessellatedQuad/TessellatedQuadGeomOverride.cpp</h1>
</div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<div class="tabs" id="navrow1">
<ul class="tablist">
<li><a href="./index.html"><span>Main Page</span></a></li>
<li><a href="./pages.html"><span>Related Pages</span></a></li>
<li><a href="./modules.html"><span>Modules</span></a></li>
<li><a href="./namespaces.html"><span>Namespaces</span></a></li>
<li><a href="./annotated.html"><span>Classes</span></a></li>
<li><a href="./examples.html"><span>Examples</span></a></li>
<li>
<div class="MSearchBoxInactive" id="MSearchBox">
<span class="left">
<img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="cpp_ref/search/mag_sel.png"/>
<input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search"/>
</span><span class="right">
<a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="cpp_ref/search/close.png"/></a>
</span>
</div>
</li>
</ul>
</div>
</div><!-- top -->
<div class="ui-resizable side-nav-resizable" id="side-nav">
<div id="nav-tree">
<div id="nav-tree-contents">
<div class="sync" id="nav-sync"></div>
</div>
</div>
<div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;">
</div>
</div>
<div id="doc-content">
<!-- window showing the filter options -->
<!-- iframe showing the search results (closed by default) -->
<div class="header">
<div class="headertitle">
<div class="title">tessellatedQuad/TessellatedQuadGeomOverride.cpp</div> </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">//-</span></div>
<div class="line"><span class="comment">// ==========================================================================</span></div>
<div class="line"><span class="comment">// Copyright 2018 Autodesk, Inc.  All rights reserved.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Use of this software is subject to the terms of the Autodesk</span></div>
<div class="line"><span class="comment">// license agreement provided at the time of installation or download,</span></div>
<div class="line"><span class="comment">// or which otherwise accompanies this software in either electronic</span></div>
<div class="line"><span class="comment">// or hard copy form.</span></div>
<div class="line"><span class="comment">// ==========================================================================</span></div>
<div class="line"><span class="comment">//+</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include "TessellatedQuadGeomOverride.h"</span></div>
<div class="line"><span class="preprocessor">#include "CrackFreePrimitiveGenerator.h"</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MViewport2Renderer.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MHWGeometryUtilities.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MFragmentManager.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MShaderManager.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MTextureManager.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MUintArray.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MSelectionMask.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MGlobal.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">namespace</span></div>
<div class="line">{</div>
<div class="line"> <span class="keyword">const</span> <a name="_a0"></a><a class="code" href="./class_m_string.html">MString</a> kWireframeItemName(<span class="stringliteral">"tessellatedQuadWireframe"</span>);</div>
<div class="line"></div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_string.html">MString</a> kTessellatedItemName(<span class="stringliteral">"tessellatedQuadTessellated"</span>);</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_string.html">MString</a> kTessellatedSelectorItemName(<span class="stringliteral">"tessellatedQuadTessellatedSelector"</span>);</div>
<div class="line"></div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_string.html">MString</a> kTessellatedWireframeItemName(<span class="stringliteral">"tessellatedQuadTessellatedWireframe"</span>);</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_string.html">MString</a> kTessellatedWireframeSelectorItemName(<span class="stringliteral">"tessellatedQuadTessellatedWireframeSelector"</span>);</div>
<div class="line"></div>
<div class="line"> <span class="comment">/*</span></div>
<div class="line"><span class="comment">            3----2 (1,1)</span></div>
<div class="line"><span class="comment">            |   /</span></div>
<div class="line"><span class="comment">            | 0/</span></div>
<div class="line"><span class="comment">            | /  2</span></div>
<div class="line"><span class="comment">            |/  /|</span></div>
<div class="line"><span class="comment">            0  / |</span></div>
<div class="line"><span class="comment">              /1 |</span></div>
<div class="line"><span class="comment">             /   |</span></div>
<div class="line"><span class="comment">    (-1,-1) 0----1</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> kNumPoints = 4;</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> kNumTris = 2;</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">float</span> kPlanePnts[kNumPoints][3] = {</div>
<div class="line">        {-1.0, 0.0, -1.0},</div>
<div class="line">        {1.0, 0.0, -1.0},</div>
<div class="line">        {1.0, 0.0, 1.0},</div>
<div class="line">        {-1.0, 0.0, 1.0}</div>
<div class="line">    };</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> kPlaneTriVertIndexes[kNumTris][3] = {</div>
<div class="line">        {0, 1, 2},</div>
<div class="line">        {2, 3, 0}</div>
<div class="line">    };</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">float</span> kPlaneUVs[kNumPoints][2] = {</div>
<div class="line">        {0.0, 1.0},</div>
<div class="line">        {1.0, 1.0},</div>
<div class="line">        {1.0, 0.0},</div>
<div class="line">        {0.0, 0.0}</div>
<div class="line">    };</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> kPlaneWireVertIndexes[kNumPoints][2] = {</div>
<div class="line">        {0, 1},</div>
<div class="line">        {1, 2},</div>
<div class="line">        {2, 3},</div>
<div class="line">        {3, 0}</div>
<div class="line">    };</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> TessellatedQuadGeomOverride::updateRenderItems(</div>
<div class="line"> <span class="keyword">const</span> <a name="_a1"></a><a class="code" href="./class_m_dag_path.html">MDagPath</a> &amp;path,</div>
<div class="line"> <a name="_a2"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item_list.html">MHWRender::MRenderItemList</a>&amp; list)</div>
<div class="line">{</div>
<div class="line"> <span class="keyword">const</span> <a name="_a3"></a><a class="code" href="./class_m_h_w_render_1_1_m_renderer.html">MHWRender::MRenderer</a>* renderer = <a name="a4"></a><a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#a4678a72ac6959ed21d422d27928d0343">MHWRender::MRenderer::theRenderer</a>();</div>
<div class="line"> <span class="keywordflow">if</span> (!renderer) <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">const</span> <a name="_a5"></a><a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html">MHWRender::MShaderManager</a> *shaderMgr = renderer-&gt;<a name="a6"></a><a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#a4603e18a1b89b798a2e4a4f36d9b5125">getShaderManager</a>();</div>
<div class="line"> <a name="_a7"></a><a class="code" href="./class_m_h_w_render_1_1_m_texture_manager.html">MHWRender::MTextureManager</a>* textureMgr = renderer-&gt;<a name="a8"></a><a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#aa3f2ec2984800e2cd8ea09b4ad9f072e">getTextureManager</a>();</div>
<div class="line"> <span class="keywordflow">if</span> (!shaderMgr || !textureMgr) <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line"> <a name="_a9"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item.html">MHWRender::MRenderItem</a> *wireframeItem = <span class="keyword">nullptr</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">int</span> idx = list.<a name="a10"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item_list.html#a4cfe9fc51a24bca06d2619a55542f689">indexOf</a>(kWireframeItemName);</div>
<div class="line"> <span class="keywordflow">if</span> (idx &gt;= 0)</div>
<div class="line">    {</div>
<div class="line">        wireframeItem = list.<a name="a11"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item_list.html#a82ed5d7ae96a2890f5f54f697bb0bab0">itemAt</a>(idx);</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        wireframeItem = <a name="a12"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#ac74a014f3346d8ddac693b7f034fa228">MHWRender::MRenderItem::Create</a>(kWireframeItemName,</div>
<div class="line">            MHWRender::MRenderItem::NonMaterialSceneItem,</div>
<div class="line">            MHWRender::MGeometry::kLines,</div>
<div class="line">            1);</div>
<div class="line"></div>
<div class="line">        wireframeItem-&gt;<a name="a13"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#a8e28487092f00765128c2ffdd43d0fe4">setDrawMode</a>(MHWRender::MGeometry::kAll);</div>
<div class="line"></div>
<div class="line">        list.<a name="a14"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item_list.html#a238f55e85f694b4f74535aaedc6ebe01">append</a>(wireframeItem);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (wireframeItem)</div>
<div class="line">    {</div>
<div class="line"> <a name="_a15"></a><a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html">MHWRender::MShaderInstance</a> *shader = shaderMgr-&gt;<a name="a16"></a><a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a8e4ad27d691969622af2b05d8c6213d9">getStockShader</a>(</div>
<div class="line">            MHWRender::MShaderManager::MStockShader::k3dThickLineShader);</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (shader)</div>
<div class="line">        {</div>
<div class="line"> <a name="_a17"></a><a class="code" href="./class_m_color.html">MColor</a> wireColor = <a name="a18"></a><a class="code" href="./class_m_h_w_render_1_1_m_geometry_utilities.html#a6221bc7407b14246b14f79a751496276">MHWRender::MGeometryUtilities::wireframeColor</a>(path);</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">float</span> color[4] = { wireColor.<a name="a19"></a><a class="code" href="./class_m_color.html#a4788d82c901b9367dd5c0daff8a7616b">r</a>, wireColor.<a name="a20"></a><a class="code" href="./class_m_color.html#a8cf17d727651616de6f2b79ef32170cd">g</a>, wireColor.<a name="a21"></a><a class="code" href="./class_m_color.html#a83fc1af92e29717b4513d121b0c72c7d">b</a>, 1.0f };</div>
<div class="line">            shader-&gt;<a name="a22"></a><a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html#aa17e2c9a17b86064950103066fa307ef">setParameter</a>( <span class="stringliteral">"solidColor"</span>, color);</div>
<div class="line"></div>
<div class="line">            wireframeItem-&gt;<a name="a23"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#ad283b157fa4f6c40bceb9d398c53a72a">setShader</a>(shader);</div>
<div class="line">            shaderMgr-&gt;<a name="a24"></a><a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a0c7deb55edc231cbb2365b271ecd55f8">releaseShader</a>(shader);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        wireframeItem-&gt;<a name="a25"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#a6e865e2cf5c9d818b1cbb99af2360c47">depthPriority</a>(</div>
<div class="line"> <a name="a26"></a><a class="code" href="./class_m_h_w_render_1_1_m_geometry_utilities.html#aa2838b92c9f7db4a810690a986199134">MHWRender::MGeometryUtilities::displayStatus</a>(path) == MHWRender::kDormant ?</div>
<div class="line"> <a name="a27"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#a6915079c9389d5b9354d5b40fb8112ca">MHWRender::MRenderItem::sDormantWireDepthPriority</a> :</div>
<div class="line"> <a name="a28"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#adb484c507442ebce56eac38bd07cac07">MHWRender::MRenderItem::sActiveWireDepthPriority</a>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> triStride = CrackFreePrimitiveGenerator::computeTriangleSize(</div>
<div class="line"> <span class="keyword">true</span> <span class="comment">/*bAddAdjacentEdges*/</span>, <span class="keyword">true</span> <span class="comment">/*bAddDominantEdges*/</span>, <span class="keyword">true</span> <span class="comment">/*bAddDominantPosition*/</span>);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// The plugin assumes that the devkit location follows "Setting up your build</span></div>
<div class="line"> <span class="comment">// environment" at Maya Developer Help; otherwise, shaders/textures cannot be</span></div>
<div class="line"> <span class="comment">// located. In this case create a mod (module description file) as below in a</span></div>
<div class="line"> <span class="comment">// suitable modules folder (getenv "MAYA_MODULE_PATH") and restart Maya.</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="comment">//   + devkit 1.0 &lt;local devkit path&gt;</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> devkitLocation;</div>
<div class="line"> <span class="keywordflow">if</span> (!<a name="a29"></a><a class="code" href="./class_m_global.html#a09e405631e7cf680f8ac9d934ad73434">MGlobal::executeCommand</a>(<a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"getModulePath -moduleName \"devkit\""</span>), devkitLocation))</div>
<div class="line">    {</div>
<div class="line">        devkitLocation = <a class="code" href="./class_m_string.html">MString</a>(getenv(<span class="stringliteral">"MAYA_LOCATION"</span>)) + <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"/devkit"</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> shaderLocation = devkitLocation +</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a>(renderer-&gt;<a name="a30"></a><a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#ae2d5ce57991bca16f525728e8d9d399e">drawAPI</a>() == MHWRender::kDirectX11 ? </div>
<div class="line"> <span class="stringliteral">"/plug-ins/tessellatedQuad/TessellationExample.fx"</span> :</div>
<div class="line"> <span class="stringliteral">"/plug-ins/tessellatedQuad/TessellationExample.ogsfx"</span>);</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> textureLocation = devkitLocation +</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a>(<span class="stringliteral">"/plug-ins/tessellatedQuad/moonHeightMapSharp.jpg"</span>);</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (list.<a class="code" href="./class_m_h_w_render_1_1_m_render_item_list.html#a4cfe9fc51a24bca06d2619a55542f689">indexOf</a>(kTessellatedItemName) &lt; 0)</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_render_item.html">MHWRender::MRenderItem</a> *shadedItem = <a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#ac74a014f3346d8ddac693b7f034fa228">MHWRender::MRenderItem::Create</a>(kTessellatedItemName,</div>
<div class="line">            MHWRender::MRenderItem::MaterialSceneItem,</div>
<div class="line">            MHWRender::MGeometry::kPatch,</div>
<div class="line">            triStride);</div>
<div class="line"></div>
<div class="line">        shadedItem-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#a8e28487092f00765128c2ffdd43d0fe4">setDrawMode</a>(MHWRender::MGeometry::DrawMode(</div>
<div class="line">            MHWRender::MGeometry::kShaded | MHWRender::MGeometry::kTextured));</div>
<div class="line"></div>
<div class="line"> <span class="comment">// do not allow selection on this render item</span></div>
<div class="line"> <a name="_a31"></a><a class="code" href="./class_m_selection_mask.html">MSelectionMask</a> nullMask;</div>
<div class="line">        shadedItem-&gt;<a name="a32"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#a793ce3d41d7f13aea020b811379a3ef3">setSelectionMask</a>(nullMask);</div>
<div class="line"></div>
<div class="line">        shadedItem-&gt;<a name="a33"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#a634faadbe865d745bc8ed447efe671da">setExcludedFromPostEffects</a>(<span class="keyword">false</span>);</div>
<div class="line">        shadedItem-&gt;<a name="a34"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#a4679f5dfcf97d7470561e4adc1cbe21c">castsShadows</a>(<span class="keyword">true</span>);</div>
<div class="line">        shadedItem-&gt;<a name="a35"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#a84fc76ef02716b725765f6de1ff3a8c6">receivesShadows</a>(<span class="keyword">true</span>);</div>
<div class="line"></div>
<div class="line">        list.<a class="code" href="./class_m_h_w_render_1_1_m_render_item_list.html#a238f55e85f694b4f74535aaedc6ebe01">append</a>(shadedItem);</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html">MHWRender::MShaderInstance</a>* tessellationShader =</div>
<div class="line">            shaderMgr-&gt;<a name="a36"></a><a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a581c659670f0e3168750382c61a91a25">getEffectsFileShader</a>(shaderLocation, <span class="stringliteral">"Main"</span>);</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (tessellationShader)</div>
<div class="line">        {</div>
<div class="line"> <a name="_a37"></a><a class="code" href="./class_m_h_w_render_1_1_m_texture.html">MHWRender::MTexture</a>* texture = textureMgr-&gt;<a name="a38"></a><a class="code" href="./class_m_h_w_render_1_1_m_texture_manager.html#a04aa3cfef217948abc8edd0f19565f95">acquireTexture</a>(textureLocation, <span class="stringliteral">""</span>);</div>
<div class="line"></div>
<div class="line">            MTextureAssignment assignment;</div>
<div class="line">            assignment.texture = texture;</div>
<div class="line">            tessellationShader-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html#aa17e2c9a17b86064950103066fa307ef">setParameter</a>(<span class="stringliteral">"gHeightMap"</span>, assignment);</div>
<div class="line"></div>
<div class="line">            shadedItem-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#ad283b157fa4f6c40bceb9d398c53a72a">setShader</a>(tessellationShader);</div>
<div class="line"></div>
<div class="line">            textureMgr-&gt;<a name="a39"></a><a class="code" href="./class_m_h_w_render_1_1_m_texture_manager.html#a82d198d9b895a67d774077d67073d22a">releaseTexture</a>(texture);</div>
<div class="line">            shaderMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a0c7deb55edc231cbb2365b271ecd55f8">releaseShader</a>(tessellationShader);</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> er = shaderMgr-&gt;<a name="a40"></a><a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a32aa7a2b395ae162d8fc66abf5f5a14a">getLastError</a>();</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> erSrc = shaderMgr-&gt;<a name="a41"></a><a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a45e7598b79e4e7202aa4082baec16231">getLastErrorSource</a>(<span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">"Error when loading: "</span> &lt;&lt; er &lt;&lt; std::endl;</div>
<div class="line">            std::cerr &lt;&lt; erSrc &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// set up selection item for Viewport 2.0 selection</span></div>
<div class="line"> <span class="keywordflow">if</span> (list.<a class="code" href="./class_m_h_w_render_1_1_m_render_item_list.html#a4cfe9fc51a24bca06d2619a55542f689">indexOf</a>(kTessellatedSelectorItemName) &lt; 0)</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_render_item.html">MHWRender::MRenderItem</a>* selectionItem = <a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#ac74a014f3346d8ddac693b7f034fa228">MHWRender::MRenderItem::Create</a>(kTessellatedSelectorItemName,</div>
<div class="line">            MHWRender::MRenderItem::MaterialSceneItem,</div>
<div class="line">            MHWRender::MGeometry::kPatch,</div>
<div class="line">            triStride);</div>
<div class="line"></div>
<div class="line">        selectionItem-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#a8e28487092f00765128c2ffdd43d0fe4">setDrawMode</a>(MHWRender::MGeometry::DrawMode(</div>
<div class="line">            MHWRender::MGeometry::kShaded |</div>
<div class="line">            MHWRender::MGeometry::kTextured |</div>
<div class="line">            MHWRender::MGeometry::kSelectionOnly));</div>
<div class="line"></div>
<div class="line">        list.<a class="code" href="./class_m_h_w_render_1_1_m_render_item_list.html#a238f55e85f694b4f74535aaedc6ebe01">append</a>(selectionItem);</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html">MHWRender::MShaderInstance</a>* selectionShader =</div>
<div class="line">            shaderMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a581c659670f0e3168750382c61a91a25">getEffectsFileShader</a>(shaderLocation, <span class="stringliteral">"Main_Selection"</span>);</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (selectionShader)</div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_texture.html">MHWRender::MTexture</a>* texture = textureMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_texture_manager.html#a04aa3cfef217948abc8edd0f19565f95">acquireTexture</a>(textureLocation, <span class="stringliteral">""</span>);</div>
<div class="line"></div>
<div class="line">            MTextureAssignment assignment;</div>
<div class="line">            assignment.texture = texture;</div>
<div class="line">            selectionShader-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html#aa17e2c9a17b86064950103066fa307ef">setParameter</a>(<span class="stringliteral">"gHeightMap"</span>, assignment);</div>
<div class="line"></div>
<div class="line">            selectionItem-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#ad283b157fa4f6c40bceb9d398c53a72a">setShader</a>(selectionShader);</div>
<div class="line"></div>
<div class="line">            textureMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_texture_manager.html#a82d198d9b895a67d774077d67073d22a">releaseTexture</a>(texture);</div>
<div class="line">            shaderMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a0c7deb55edc231cbb2365b271ecd55f8">releaseShader</a>(selectionShader);</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> er = shaderMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a32aa7a2b395ae162d8fc66abf5f5a14a">getLastError</a>();</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> erSrc = shaderMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a45e7598b79e4e7202aa4082baec16231">getLastErrorSource</a>(<span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">"Error when loading: "</span> &lt;&lt; er &lt;&lt; std::endl;</div>
<div class="line">            std::cerr &lt;&lt; erSrc &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (list.<a class="code" href="./class_m_h_w_render_1_1_m_render_item_list.html#a4cfe9fc51a24bca06d2619a55542f689">indexOf</a>(kTessellatedWireframeItemName) &lt; 0)</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_render_item.html">MHWRender::MRenderItem</a> *shadedItem = <a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#ac74a014f3346d8ddac693b7f034fa228">MHWRender::MRenderItem::Create</a>(</div>
<div class="line">            kTessellatedWireframeItemName,</div>
<div class="line">            MHWRender::MRenderItem::MaterialSceneItem,</div>
<div class="line">            MHWRender::MGeometry::kPatch,</div>
<div class="line">            triStride);</div>
<div class="line"></div>
<div class="line">        shadedItem-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#a8e28487092f00765128c2ffdd43d0fe4">setDrawMode</a>(MHWRender::MGeometry::kWireframe);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// do not allow selection on this render item</span></div>
<div class="line"> <a class="code" href="./class_m_selection_mask.html">MSelectionMask</a> nullMask;</div>
<div class="line">        shadedItem-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#a793ce3d41d7f13aea020b811379a3ef3">setSelectionMask</a>(nullMask);</div>
<div class="line"></div>
<div class="line">        shadedItem-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#a634faadbe865d745bc8ed447efe671da">setExcludedFromPostEffects</a>(<span class="keyword">false</span>);</div>
<div class="line">        shadedItem-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#a4679f5dfcf97d7470561e4adc1cbe21c">castsShadows</a>(<span class="keyword">true</span>);</div>
<div class="line">        shadedItem-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#a84fc76ef02716b725765f6de1ff3a8c6">receivesShadows</a>(<span class="keyword">true</span>);</div>
<div class="line"></div>
<div class="line">        list.<a class="code" href="./class_m_h_w_render_1_1_m_render_item_list.html#a238f55e85f694b4f74535aaedc6ebe01">append</a>(shadedItem);</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html">MHWRender::MShaderInstance</a>* tessellationShader =</div>
<div class="line">            shaderMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a581c659670f0e3168750382c61a91a25">getEffectsFileShader</a>(shaderLocation, <span class="stringliteral">"Wireframe"</span>);</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (tessellationShader)</div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_texture.html">MHWRender::MTexture</a>* texture = textureMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_texture_manager.html#a04aa3cfef217948abc8edd0f19565f95">acquireTexture</a>(textureLocation, <span class="stringliteral">""</span>);</div>
<div class="line"></div>
<div class="line">            MTextureAssignment assignment;</div>
<div class="line">            assignment.texture = texture;</div>
<div class="line">            tessellationShader-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html#aa17e2c9a17b86064950103066fa307ef">setParameter</a>(<span class="stringliteral">"gHeightMap"</span>, assignment);</div>
<div class="line"></div>
<div class="line">            shadedItem-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#ad283b157fa4f6c40bceb9d398c53a72a">setShader</a>(tessellationShader);</div>
<div class="line"></div>
<div class="line">            textureMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_texture_manager.html#a82d198d9b895a67d774077d67073d22a">releaseTexture</a>(texture);</div>
<div class="line">            shaderMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a0c7deb55edc231cbb2365b271ecd55f8">releaseShader</a>(tessellationShader);</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> er = shaderMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a32aa7a2b395ae162d8fc66abf5f5a14a">getLastError</a>();</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> erSrc = shaderMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a45e7598b79e4e7202aa4082baec16231">getLastErrorSource</a>(<span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">"Error when loading: "</span> &lt;&lt; er &lt;&lt; std::endl;</div>
<div class="line">            std::cerr &lt;&lt; erSrc &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// set up selection item for Viewport 2.0 selection</span></div>
<div class="line"> <span class="keywordflow">if</span> (list.<a class="code" href="./class_m_h_w_render_1_1_m_render_item_list.html#a4cfe9fc51a24bca06d2619a55542f689">indexOf</a>(kTessellatedWireframeSelectorItemName) &lt; 0)</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_render_item.html">MHWRender::MRenderItem</a>* selectionItem = <a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#ac74a014f3346d8ddac693b7f034fa228">MHWRender::MRenderItem::Create</a>(kTessellatedWireframeSelectorItemName,</div>
<div class="line">            MHWRender::MRenderItem::MaterialSceneItem,</div>
<div class="line">            MHWRender::MGeometry::kPatch,</div>
<div class="line">            triStride);</div>
<div class="line"></div>
<div class="line">        selectionItem-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#a8e28487092f00765128c2ffdd43d0fe4">setDrawMode</a>(MHWRender::MGeometry::DrawMode(</div>
<div class="line">            MHWRender::MGeometry::kWireframe |</div>
<div class="line">            MHWRender::MGeometry::kSelectionOnly));</div>
<div class="line"></div>
<div class="line">        list.<a class="code" href="./class_m_h_w_render_1_1_m_render_item_list.html#a238f55e85f694b4f74535aaedc6ebe01">append</a>(selectionItem);</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html">MHWRender::MShaderInstance</a>* selectionShader =</div>
<div class="line">            shaderMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a581c659670f0e3168750382c61a91a25">getEffectsFileShader</a>(shaderLocation, <span class="stringliteral">"Wireframe_Selection"</span>);</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (selectionShader)</div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_texture.html">MHWRender::MTexture</a>* texture = textureMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_texture_manager.html#a04aa3cfef217948abc8edd0f19565f95">acquireTexture</a>(textureLocation, <span class="stringliteral">""</span>);</div>
<div class="line"></div>
<div class="line">            MTextureAssignment assignment;</div>
<div class="line">            assignment.texture = texture;</div>
<div class="line">            selectionShader-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_instance.html#aa17e2c9a17b86064950103066fa307ef">setParameter</a>(<span class="stringliteral">"gHeightMap"</span>, assignment);</div>
<div class="line"></div>
<div class="line">            selectionItem-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#ad283b157fa4f6c40bceb9d398c53a72a">setShader</a>(selectionShader);</div>
<div class="line"></div>
<div class="line">            textureMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_texture_manager.html#a82d198d9b895a67d774077d67073d22a">releaseTexture</a>(texture);</div>
<div class="line">            shaderMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a0c7deb55edc231cbb2365b271ecd55f8">releaseShader</a>(selectionShader);</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> er = shaderMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a32aa7a2b395ae162d8fc66abf5f5a14a">getLastError</a>();</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> erSrc = shaderMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_shader_manager.html#a45e7598b79e4e7202aa4082baec16231">getLastErrorSource</a>(<span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">"Error when loading: "</span> &lt;&lt; er &lt;&lt; std::endl;</div>
<div class="line">            std::cerr &lt;&lt; erSrc &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> TessellatedQuadGeomOverride::populateGeometry(</div>
<div class="line"> <span class="keyword">const</span> <a name="_a42"></a><a class="code" href="./class_m_h_w_render_1_1_m_geometry_requirements.html">MHWRender::MGeometryRequirements</a> &amp;requirements,</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_render_item_list.html">MHWRender::MRenderItemList</a> &amp;renderItems,</div>
<div class="line"> <a name="_a43"></a><a class="code" href="./class_m_h_w_render_1_1_m_geometry.html">MHWRender::MGeometry</a> &amp;data)</div>
<div class="line">{</div>
<div class="line"> <a name="_a44"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer.html">MHWRender::MVertexBuffer</a> *positionBuffer = NULL;</div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer.html">MHWRender::MVertexBuffer</a> *uvBuffer = NULL;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">const</span> <a name="_a45"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer_descriptor_list.html">MHWRender::MVertexBufferDescriptorList</a> &amp;vbDescriptors = requirements.<a name="a46"></a><a class="code" href="./class_m_h_w_render_1_1_m_geometry_requirements.html#a960f411f65fde2d97da465a6b276d774">vertexRequirements</a>();</div>
<div class="line"> <a name="_a47"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer_descriptor.html">MHWRender::MVertexBufferDescriptor</a> vbDescriptor;</div>
<div class="line"> <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> ri = 0; ri &lt; vbDescriptors.<a name="a48"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer_descriptor_list.html#a57b988236ee6a3a5e572d126d3fbccc1">length</a>(); ++ri )</div>
<div class="line">    {</div>
<div class="line"> <span class="keywordflow">if</span> ( !vbDescriptors.<a name="a49"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer_descriptor_list.html#ab5970217cd80acac6aa900cc1daec6b8">getDescriptor</a>( ri, vbDescriptor ) )</div>
<div class="line"> <span class="keywordflow">continue</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">switch</span> ( vbDescriptor.<a name="a50"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer_descriptor.html#abc8db8e8585a67a40d57c26811aaf8e2">semantic</a>() )</div>
<div class="line">        {</div>
<div class="line"> <span class="keywordflow">case</span> MHWRender::MGeometry::kPosition:</div>
<div class="line">            {</div>
<div class="line">                positionBuffer = data.<a name="a51"></a><a class="code" href="./class_m_h_w_render_1_1_m_geometry.html#acf6369e390e9831c0e180cc60c7db618">createVertexBuffer</a>(vbDescriptor);</div>
<div class="line"> <span class="keywordflow">if</span> (positionBuffer)</div>
<div class="line">                {</div>
<div class="line"> <span class="keywordtype">float</span> *verts = (<span class="keywordtype">float</span> *) positionBuffer-&gt;<a name="a52"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer.html#aff9e3c2ed40ad0c0f0fe55668670d071">acquire</a>(kNumPoints, <span class="keyword">false</span>);</div>
<div class="line">                    memcpy(verts, kPlanePnts, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * kNumPoints * 3);</div>
<div class="line">                    positionBuffer-&gt;<a name="a53"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer.html#aafb3736206f8a73c0fc74757919cfb83">commit</a>(verts);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> <span class="keywordflow">break</span>;</div>
<div class="line"> <span class="keywordflow">case</span> MHWRender::MGeometry::kNormal:</div>
<div class="line">            {</div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer.html">MHWRender::MVertexBuffer</a> *vb = data.<a class="code" href="./class_m_h_w_render_1_1_m_geometry.html#acf6369e390e9831c0e180cc60c7db618">createVertexBuffer</a>(vbDescriptor);</div>
<div class="line"> <span class="keywordflow">if</span> (vb)</div>
<div class="line">                {</div>
<div class="line"> <span class="keywordtype">float</span> *normals= (<span class="keywordtype">float</span> *) vb-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer.html#aff9e3c2ed40ad0c0f0fe55668670d071">acquire</a>(kNumPoints, <span class="keyword">true</span>);</div>
<div class="line"> <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ni=0; ni&lt;kNumPoints; ++ni )</div>
<div class="line">                    {</div>
<div class="line">                        normals[ni*3 + 0] = 0.0f;</div>
<div class="line">                        normals[ni*3 + 1] = 1.0f;</div>
<div class="line">                        normals[ni*3 + 2] = 0.0f;</div>
<div class="line">                    }</div>
<div class="line">                    vb-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer.html#aafb3736206f8a73c0fc74757919cfb83">commit</a>(normals);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> <span class="keywordflow">break</span>;</div>
<div class="line"> <span class="keywordflow">case</span> MHWRender::MGeometry::kTexture:</div>
<div class="line">            {</div>
<div class="line">                uvBuffer = data.<a class="code" href="./class_m_h_w_render_1_1_m_geometry.html#acf6369e390e9831c0e180cc60c7db618">createVertexBuffer</a>(vbDescriptor);</div>
<div class="line"> <span class="keywordflow">if</span> (uvBuffer)</div>
<div class="line">                {</div>
<div class="line"> <span class="keywordtype">float</span> *uvs = (<span class="keywordtype">float</span> *) uvBuffer-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer.html#aff9e3c2ed40ad0c0f0fe55668670d071">acquire</a>(kNumPoints, <span class="keyword">false</span>);</div>
<div class="line">                    memcpy(uvs, kPlaneUVs, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * kNumPoints * 2);</div>
<div class="line">                    uvBuffer-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer.html#aafb3736206f8a73c0fc74757919cfb83">commit</a>(uvs);</div>
<div class="line">                }       </div>
<div class="line">            }</div>
<div class="line"> <span class="keywordflow">break</span>;</div>
<div class="line"> <span class="keywordflow">default</span>:</div>
<div class="line"> <span class="comment">// ignore unknown semantics!</span></div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">"Unexpected vb descriptor: "</span> &lt;&lt; vbDescriptor.<a name="a54"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer_descriptor.html#aec39ee3496166457d1ccdf73c8d1a3b2">semanticName</a>() &lt;&lt; std::endl;</div>
<div class="line"> <span class="keywordflow">break</span>;</div>
<div class="line">        };</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="comment">// For our index buffer, we need to generate connectivity information. The</span></div>
<div class="line"> <span class="comment">// calculation can be expensive so we share the index buffer among render</span></div>
<div class="line"> <span class="comment">// items if possible to avoid repetitive calculation.</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <a name="_a55"></a><a class="code" href="./class_m_h_w_render_1_1_m_index_buffer.html">MHWRender::MIndexBuffer</a> *patchIB = <span class="keyword">nullptr</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> triStride = CrackFreePrimitiveGenerator::computeTriangleSize(</div>
<div class="line"> <span class="keyword">true</span> <span class="comment">/*bAddAdjacentEdges*/</span>, <span class="keyword">true</span> <span class="comment">/*bAddDominantEdges*/</span>, <span class="keyword">true</span> <span class="comment">/*bAddDominantPosition*/</span>);</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> ri = 0; ri &lt; renderItems.<a name="a56"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item_list.html#a57b988236ee6a3a5e572d126d3fbccc1">length</a>(); ++ri )</div>
<div class="line">    {</div>
<div class="line"> <span class="keyword">const</span> <a class="code" href="./class_m_h_w_render_1_1_m_render_item.html">MHWRender::MRenderItem</a>* item = renderItems.<a class="code" href="./class_m_h_w_render_1_1_m_render_item_list.html#a82ed5d7ae96a2890f5f54f697bb0bab0">itemAt</a>(ri);</div>
<div class="line"> <span class="keywordflow">if</span> ( !item )</div>
<div class="line"> <span class="keywordflow">continue</span>;</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> itemName = item-&gt;<a name="a57"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#aca2cba4630391c78dcf1a828986160da">name</a>();</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> ( itemName == kWireframeItemName )</div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_index_buffer.html">MHWRender::MIndexBuffer</a> *ib = data.<a name="a58"></a><a class="code" href="./class_m_h_w_render_1_1_m_geometry.html#a649d0f008cdfbd368a4157dcd47ede67">createIndexBuffer</a>(MHWRender::MGeometry::kUnsignedInt32);</div>
<div class="line"> <span class="keywordflow">if</span> (ib)</div>
<div class="line">            {</div>
<div class="line"> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>* indexes = (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *) ib-&gt;<a name="a59"></a><a class="code" href="./class_m_h_w_render_1_1_m_index_buffer.html#aff9e3c2ed40ad0c0f0fe55668670d071">acquire</a>(kNumPoints * 2);</div>
<div class="line">                memcpy(indexes, kPlaneWireVertIndexes, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) * kNumPoints * 2);</div>
<div class="line">                ib-&gt;<a name="a60"></a><a class="code" href="./class_m_h_w_render_1_1_m_index_buffer.html#aafb3736206f8a73c0fc74757919cfb83">commit</a>(indexes);</div>
<div class="line">                item-&gt;<a name="a61"></a><a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#a7d0f067f76206a54f4f716f63bcb6b19">associateWithIndexBuffer</a>(ib);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line">            itemName == kTessellatedItemName ||</div>
<div class="line">            itemName == kTessellatedSelectorItemName ||</div>
<div class="line">            itemName == kTessellatedWireframeItemName ||</div>
<div class="line">            itemName == kTessellatedWireframeSelectorItemName )</div>
<div class="line">        {</div>
<div class="line"> <span class="keywordflow">if</span> (!patchIB)</div>
<div class="line">            {</div>
<div class="line">                patchIB = data.<a class="code" href="./class_m_h_w_render_1_1_m_geometry.html#a649d0f008cdfbd368a4157dcd47ede67">createIndexBuffer</a>(MHWRender::MGeometry::kUnsignedInt32);</div>
<div class="line"> <span class="keywordflow">if</span> (patchIB)</div>
<div class="line">                {</div>
<div class="line"> <a name="_a62"></a><a class="code" href="./class_m_uint_array.html">MUintArray</a> triIndices(kPlaneTriVertIndexes[0], kNumTris * 3);</div>
<div class="line"> <span class="keywordtype">float</span> * positionBufferFloat = (<span class="keywordtype">float</span> *)positionBuffer-&gt;<a name="a63"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer.html#abc9e783c4d7826700a6a6824451f8230">map</a>();</div>
<div class="line"> <span class="keywordtype">float</span> * uvBufferFloat = NULL;</div>
<div class="line"> <span class="keywordflow">if</span> (uvBuffer) uvBufferFloat = (<span class="keywordtype">float</span> *)uvBuffer-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer.html#abc9e783c4d7826700a6a6824451f8230">map</a>();</div>
<div class="line"></div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bufferSize = kNumTris * triStride;</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>* indexes = (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>*)patchIB-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_index_buffer.html#aff9e3c2ed40ad0c0f0fe55668670d071">acquire</a>(bufferSize, <span class="keyword">true</span> <span class="comment">/*writeOnly - we don't need the current buffer values*/</span>);</div>
<div class="line"></div>
<div class="line">                    CrackFreePrimitiveGenerator::mutateIndexBuffer(triIndices,</div>
<div class="line">                        positionBufferFloat,</div>
<div class="line">                        uvBufferFloat,</div>
<div class="line"> <span class="keyword">true</span> <span class="comment">/*add adjacent edges*/</span>,</div>
<div class="line"> <span class="keyword">true</span> <span class="comment">/*add dominant edges*/</span>,</div>
<div class="line"> <span class="keyword">true</span> <span class="comment">/*add dominant position*/</span>,</div>
<div class="line">                        patchIB-&gt;<a name="a64"></a><a class="code" href="./class_m_h_w_render_1_1_m_index_buffer.html#abc7588a483f61d3d4a1e8204ca14d6f6">dataType</a>(),</div>
<div class="line">                        indexes);</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (positionBuffer) positionBuffer-&gt;<a name="a65"></a><a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer.html#a1ffeb3b5abb3d61f62b58a391816201c">unmap</a>();</div>
<div class="line"> <span class="keywordflow">if</span> (uvBuffer) uvBuffer-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_vertex_buffer.html#a1ffeb3b5abb3d61f62b58a391816201c">unmap</a>();</div>
<div class="line"></div>
<div class="line">                    patchIB-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_index_buffer.html#aafb3736206f8a73c0fc74757919cfb83">commit</a>(indexes);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (patchIB)</div>
<div class="line">            {</div>
<div class="line">                item-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_render_item.html#a7d0f067f76206a54f4f716f63bcb6b19">associateWithIndexBuffer</a>(patchIB);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div class="footer-block"><a class="comments-anchor" href="../html/ac.cmtdialog.htm" target="_blank"><span class="comments-link">Please send us your comment about this page</span></a></div></div>
</div></body>
</html>
